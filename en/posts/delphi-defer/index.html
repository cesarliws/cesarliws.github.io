<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Cesar Romero">
    <meta name="description" content="">
    <meta name="generator" content="Hugo 0.19" />

    
    <title>Delphi Defer &middot; @cesarliws’s cook bytes</title>

    <link rel="stylesheet" href="https://cesarliws.github.io/css/weblog.css" media="screen" charset="utf-8" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/1.2.14/css/lightgallery.min.css" type="text/css" />
    


    
	<link href="https://cesarliws.github.io/index.xml" rel="alternate" type="application/rss+xml" title="cook bytes" />
	
  </head>
  <body class="site">

<header>
  <nav>
    <h1><a href="/">@cesarliws</a>’s cook bytes.</h1>
    <div class="menu">
      
      <ul>
        
            <li>
              <a href="/">Home</a>
              
                <a href="/index.xml"><img src="/img/rss.svg" class="rss-icon" /></a>
              
            </li>
        
            <li>
              <a href="/posts/">Posts</a>
              
                <a href="/posts/index.xml"><img src="/img/rss.svg" class="rss-icon" /></a>
              
            </li>
        
            <li>
              <a href="/en/">English</a>
              
                <a href="/en/index.xml"><img src="/img/rss.svg" class="rss-icon" /></a>
              
            </li>
        
        
      </ul>
    </div>
  </nav>
</header>


  <main class="content">

    <article class="post">
      
        <h2><a rel="full-article" href="https://cesarliws.github.io/en/posts/delphi-defer/">Delphi Defer</a></h2>
      

      <div class="postmeta">Posted on <time datetime="2017-04-05 17:02:27 -0300 BRT" pubdate="">April 5, 2017</time> in
        <span class="categories">
          
        </span>
      </div>

      <p>
        <p>IDeferrer define o padrão &ldquo;defer execute procedure&rdquo;, que deve agendar a
procedure TProc para ser executada imediatamente após o fim do método que
fez a chamada ao Defer(Proc).</p>

<p>Adiar a execução de procedures tem algumas vantagens:</p>

<ul>
<li><p>Garante que você não vai esquecer de finalizar/fechar um recurso,
um erro bem comum quando é feito a manutenção do código e novas condições
são adicionadas, criando um novo caminho para o fluxo da procedure;</p></li>

<li><p>O código de finalização fica junto ao de inicialização, que é
mais legível do que colocar no fim do método;</p></li>

<li><p>Dispensa a necessidade de blocos try/finally para garantir que um
recurso seja finalizado.</p></li>

<li><p>Mesmo que ocorra uma Exception, todos os métodos agendados no defer
serão executados.</p></li>
</ul>

<p>Exemplos da sua utilização são desbloquear um CriticalSection, fechar um
arquivo ou fechar uma conexão com o banco de dados.</p>

<p>Evite usar defer dentro de loops, isso pode causar um aumento excessivo
de memória se muitos objetos forem alocados, podendo ocasionar o erro
&ldquo;Out of memory&rdquo;.</p>

<p>Ao usar com métodos anonimos tenha em mente que o estado é capturado,
qualquer variável utilizada, terá o valor capturado no momento em que
o defer for declarado e não o valor alterado durante o fluxo da
procedure.</p>

<p>Esta padrão é baseado na function Defer em #Golang e não tem relação
aos padrões &ldquo;Deferred/Promise&rdquo; e &ldquo;Deferred Choice&rdquo;.</p>

<p>{{ partial &ldquo;disqus.html&rdquo; . }}</p>

      </p>
    </article>


  </main>

<footer>
  <div class="footer_text">
      <div>
        <h3>Olá, <a href="">Eu sou Cesar</a></h3>
        <p>
          Arquiteto de software na <a href="www.triersistemas.com.br">Trier Sistemas</a>, e
<br /> <a href="https://www.embarcadero.com/embarcadero-mvp-program">Embarcadero MVP</a>.
<br /> Palestrante Regular em conferências de software. 
<br /> [desktop, cloud e mobile na maioria em <a href="https://www.embarcadero.com/products/delphi">Delphi</a> e <a href="https://golang.org/">Golang</a>]

        </p>
      </div>
  </div>

  
    <div class="footer_copyright">
      &copy; 2017 <a href="">Cesar Romero</a>
       - Made in Tubarão - SC, Brazil
    </div>
  
</footer>

    <script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/2.2.0/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/1.2.14/js/lightgallery-all.min.js" charset="utf-8"></script>
    <script src="/js/weblog.js" charset="utf-8"></script>
    

    
    
  </body>
</html>


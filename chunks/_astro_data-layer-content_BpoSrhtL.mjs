const _astro_dataLayerContent = [["Map",1,2,9,10],"meta::meta",["Map",3,4,5,6,7,8],"astro-version","5.16.6","content-config-digest","1412cb4b0ef060ca","astro-config-digest","{\"root\":{},\"srcDir\":{},\"publicDir\":{},\"outDir\":{},\"cacheDir\":{},\"site\":\"https://www.cesarromero.com.br\",\"compressHTML\":true,\"base\":\"/\",\"trailingSlash\":\"ignore\",\"output\":\"static\",\"scopedStyleStrategy\":\"where\",\"build\":{\"format\":\"directory\",\"client\":{},\"server\":{},\"assets\":\"_astro\",\"serverEntry\":\"entry.mjs\",\"redirects\":true,\"inlineStylesheets\":\"auto\",\"concurrency\":1},\"server\":{\"open\":false,\"host\":false,\"port\":4321,\"streaming\":true,\"allowedHosts\":[]},\"redirects\":{\"/blog/[...slug]\":\"/articles/[...slug]\",\"/en/blog/[...slug]\":\"/en/articles/[...slug]\",\"/es/blog/[...slug]\":\"/es/articles/[...slug]\"},\"image\":{\"endpoint\":{\"route\":\"/_image\"},\"service\":{\"entrypoint\":\"astro/assets/services/sharp\",\"config\":{}},\"domains\":[],\"remotePatterns\":[],\"responsiveStyles\":false},\"devToolbar\":{\"enabled\":true},\"markdown\":{\"syntaxHighlight\":false,\"shikiConfig\":{\"langs\":[],\"langAlias\":{},\"theme\":\"github-dark\",\"themes\":{},\"wrap\":false,\"transformers\":[]},\"remarkPlugins\":[null,null,null],\"rehypePlugins\":[[null,{\"experimentalHeadingIdCompat\":false}],null,[null,{\"themes\":[\"dracula\"],\"defaultLocale\":\"pt-BR\",\"cascadeLayer\":\"starlight.components\",\"styleOverrides\":{\"borderRadius\":\"0px\",\"borderWidth\":\"1px\",\"codePaddingBlock\":\"0.75rem\",\"codePaddingInline\":\"1rem\",\"codeFontFamily\":\"var(--__sl-font-mono)\",\"codeFontSize\":\"var(--sl-text-code)\",\"codeLineHeight\":\"var(--sl-line-height)\",\"uiFontFamily\":\"var(--__sl-font)\",\"textMarkers\":{\"lineDiffIndicatorMarginLeft\":\"0.25rem\",\"defaultChroma\":\"45\",\"backgroundOpacity\":\"60%\"}},\"plugins\":[{\"name\":\"Starlight Plugin\",\"hooks\":{}},{\"name\":\"astro-expressive-code\",\"hooks\":{}}]}]],\"remarkRehype\":{},\"gfm\":true,\"smartypants\":true},\"security\":{\"checkOrigin\":true,\"allowedDomains\":[]},\"env\":{\"schema\":{},\"validateSecrets\":false},\"experimental\":{\"clientPrerender\":false,\"contentIntellisense\":false,\"headingIdCompat\":false,\"preserveScriptOrder\":false,\"liveContentCollections\":false,\"csp\":false,\"staticImportMetaEnv\":false,\"chromeDevtoolsWorkspace\":false,\"failOnPrerenderConflict\":false,\"svgo\":false},\"legacy\":{\"collections\":false},\"prefetch\":{\"prefetchAll\":true},\"i18n\":{\"defaultLocale\":\"pt-BR\",\"locales\":[{\"codes\":[\"pt-BR\"],\"path\":\"pt-BR\"},{\"codes\":[\"en\"],\"path\":\"en\"},{\"codes\":[\"es\"],\"path\":\"es\"}],\"routing\":{\"prefixDefaultLocale\":false,\"redirectToDefaultLocale\":false,\"fallbackType\":\"redirect\"}}}","docs",["Map",11,12,44,45,100,101,111,112,136,137,161,162,172,173,183,184,209,210,252,253,290,291,329,330,364,365,408,409,432,433,476,477],"start-starlight",{id:11,data:13,body:39,filePath:40,assetImports:41,digest:43,deferredRender:16},{title:14,description:15,editUrl:16,head:17,template:18,hero:19,sidebar:36,pagefind:16,draft:37},"Cesar Romero","Entusiasta Delphi, MVP e Arquiteto de Software.",true,[],"splash",{tagline:15,image:20,actions:23},{alt:21,file:22},"","__ASTRO_IMAGE_../../assets/blog-placeholder-about.jpg",[24,31],{text:25,link:26,variant:27,icon:28},"Meus Livros","/books/","primary",{type:29,name:30},"icon","open-book",{text:32,link:33,variant:27,icon:34},"Conhe√ßa o Dext","/projects/dext/",{type:29,name:35},"rocket",{hidden:37,attrs:38},false,{},"import { Card, CardGrid } from '@astrojs/starlight/components';\r\n\r\n## Destaques\r\n\r\n<CardGrid stagger>\r\n  <Card title=\"Expert Delphi\" icon=\"star\">\r\n    Autor dos livros best-sellers sobre **Delphi**, **Threads** e **Programa√ß√£o Reativa**.\r\n    \r\n    [Ver Livros](/books/)\r\n  </Card>\r\n  <Card title=\"Dext Framework\" icon=\"rocket\">\r\n    O framework Fullstack para Delphi inspirado no ASP.NET Core. Moderno, R√°pido e Escal√°vel.\r\n    \r\n    [Documenta√ß√£o](/projects/dext/)\r\n  </Card>\r\n</CardGrid>\r\n\r\n## Timeline\r\n\r\n<div class=\"timeline-feed\">\r\n  <p><em>üöß Em constru√ß√£o... Aqui voc√™ ver√° meus √∫ltimos artigos e eventos.</em></p>\r\n  <ul>\r\n    <li>\r\n        <strong>üìù Artigo:</strong> Enterprise Patterns com Dext\r\n        <br/><small>22 Dez 2024</small>\r\n    </li>\r\n    <li>\r\n         <strong>üìÖ Evento:</strong> Embarcadero Conference 2024\r\n         <br/><small>22 Out 2024</small>\r\n    </li>\r\n  </ul>\r\n</div>","src/content/docs/start-starlight.mdx",[42],"../../assets/blog-placeholder-about.jpg","c6d1afbc5f3cf3dd","articles/dext-story",{id:44,data:46,body:53,filePath:54,assetImports:55,digest:60,rendered:61},{title:47,description:48,editUrl:16,head:49,template:50,sidebar:51,pagefind:16,draft:37},"A Evolu√ß√£o do Dext: Da Funda√ß√£o √† Maturidade do Desenvolvimento Moderno em Delphi","A hist√≥ria de como transformamos uma vis√£o em realidade, aplicando engenharia de software moderna ao Object Pascal.",[],"doc",{hidden:37,attrs:52},{},"![Dext Framework Evolution](../../../assets/delphi-dext.png)\r\n\r\n> *\"Simplicity is Complicated.\" ‚Äî Rob Pike*\r\n\r\nPor muito tempo, o ecossistema Delphi viveu uma dicotomia. De um lado, t√≠nhamos a linguagem poderosa, o compilador r√°pido e a estabilidade lend√°ria. Do outro, olh√°vamos para o horizonte do .NET Core, Spring Boot e Node.js, vendo arquiteturas limpas, inje√ß√£o de depend√™ncia robusta e testes fluentes, sentindo que algo faltava.\r\n\r\nN√£o faltava capacidade √† linguagem. Faltava uma funda√ß√£o.\r\n\r\nO **Dext Framework** nasceu dessa inquietude: a exaust√£o de integrar bibliotecas desconexas, com padr√µes conflitantes e reposit√≥rios muitas vezes abandonados. O objetivo n√£o era apenas criar 'mais um servidor HTTP', mas erguer uma catedral arquitetural unificada. Constru√≠mos um ecossistema Full-Stack organicamente integrado, onde Inje√ß√£o de Depend√™ncia, ORM Moderno, Framework Web e Testes n√£o s√£o pe√ßas soltas for√ßadas a conviver, mas uma sinfonia coesa que fala a mesma l√≠ngua e compartilha o mesmo DNA desde a primeira linha de c√≥digo.\r\n\r\nEsta √© a hist√≥ria de como transformamos essa vis√£o em realidade, aplicando ao Object Pascal a engenharia de software moderna e os padr√µes arquiteturais mais bem estabelecidos da ind√∫stria.\r\n\r\n---\r\n\r\n## A Funda√ß√£o e o Protocolo (O In√≠cio)\r\n\r\nTudo come√ßou no sil√™ncio de um reposit√≥rio vazio. O primeiro commit, \"Dext is born\", foi mais do que c√≥digo; foi uma declara√ß√£o de inten√ß√µes. Mas um framework n√£o nasce pronto; ele precisa de um sistema nervoso central.\r\n\r\nNos primeiros dias, rejeitamos o acoplamento tradicional. Antes de servirmos a primeira p√°gina HTML, constru√≠mos o **Container de Inje√ß√£o de Depend√™ncia**. Quer√≠amos que servi√ßos como `Scoped`, `Singleton` e `Transient` fossem naturais, permitindo que a aplica√ß√£o respirasse e crescesse sem se tornar um espaguete de c√≥digo.\r\n\r\nCom o cora√ß√£o pulsando, demos vida √† camada HTTP.\r\nN√£o nos contentamos com o b√°sico. Implementamos **Minimal APIs** para a agilidade de microsservi√ßos, mas fomos al√©m do roteamento simples. Quebramos a barreira entre a Rota e o Container com a **Inje√ß√£o de Depend√™ncia em Handlers**. Agora, servi√ßos podiam ser injetados diretamente na assinatura de m√©todos an√¥nimos ‚Äî voc√™ pede o servi√ßo nos par√¢metros, e o framework entrega.\r\n\r\nSimultaneamente, declaramos guerra ao *boilerplate* de parsing e mapeamento. O **Smart Model Binding** nasceu para transformar payloads JSON brutos em Records e Classes fortemente tipados, automaticamente. E para garantir a integridade logo na porta de entrada, integramos a **Model Validation**, assegurando que dados inv√°lidos sejam barrados antes mesmo de tocarem a regra de neg√≥cio.\r\n\r\nPara eliminar a √∫ltima barreira de fric√ß√£o na entrada de dados, introduzimos a classe `TMapper` que implementa o padr√£o **Auto Mapper**, permitindo que DTOs de formul√°rios fossem convertidos em Entidades de dom√≠nio sem a necessidade de escrever dezenas de linhas de atribui√ß√£o manual. Trouxemos tamb√©m os **Controllers**, para quem exige a organiza√ß√£o cl√°ssica MVC.\r\n\r\nMas a excel√™ncia exige precis√£o absoluta. N√£o bastava receber requisi√ß√µes; precis√°vamos trat√°-las com eleg√¢ncia.\r\nCriamos um **Pipeline de Middlewares** modular. Logo, a seguran√ßa entrou em cena n√£o como um \"add-on\", mas como parte do fluxo: **JWT (JSON Web Tokens)** para autentica√ß√£o stateless, **Rate Limiting** para prote√ß√£o contra abusos e **CORS** para a conviv√™ncia pac√≠fica na web moderna.\r\n\r\nE para amarrar tudo, introduzimos o padr√£o **Options Pattern** e o suporte a **Configuration** (JSON, YAML e Vari√°veis de Ambiente). Agora, configura√ß√µes n√£o eram mais constantes espalhadas, mas objetos tipados e injet√°veis.\r\n\r\n> *A cena era de constru√ß√£o de alicerces: cada pe√ßa (DI, Config, Logging) encaixando-se perfeitamente antes mesmo da primeira regra de neg√≥cio ser escrita.*\r\n\r\n---\r\n\r\n## A Revolu√ß√£o dos Dados (O ORM)\r\n\r\nCom a web funcionando, enfrentamos o \"Chef√£o\" do desenvolvimento Delphi: o banco de dados. A comunidade estava cansada de manipular SQL Strings e componentes visuais acoplados. O **Dext.Entity** nasceu para mudar isso.\r\n\r\nA primeira batalha foi contra o SQL manual. Criamos a **Fluent Query API**.\r\nImagine escrever c√≥digo sem nunca tocar em uma string SQL. Implementamos proje√ß√µes (`Select`), pagina√ß√£o (`Skip`/`Take`) e agrupamentos (`GroupBy`) que o compilador traduz para a linguagem do banco.\r\n\r\n**Mas a verdadeira eleg√¢ncia arquitetural veio com a integra√ß√£o nativa do Specification Pattern, inspirada nos ensinamentos de Steve \"Ardalis\" Smith**. Constru√≠mos essa camada lado a lado com a API fluente para encapsular regras de neg√≥cio complexas em classes reutiliz√°veis. Isso foi o movimento decisivo para desacoplar a aplica√ß√£o da comunica√ß√£o direta com o banco, permitindo finalmente a cria√ß√£o de Controllers e Reposit√≥rios verdadeiramente limpos, onde a inten√ß√£o do c√≥digo prevalece sobre a implementa√ß√£o.\r\n\r\nMas o mundo n√£o √© apenas um banco de dados. Para sermos verdadeiramente universais, implementamos uma camada de abstra√ß√£o que fala fluentemente **SQLite, PostgreSQL, Firebird, SQL Server, Oracle e MySQL**.\r\n\r\nSab√≠amos que performance √© inegoci√°vel. Por isso, n√£o paramos no b√°sico. Implementamos **Connection Pooling** para suportar alta concorr√™ncia e **Bulk Operations**, permitindo que milhares de registros sejam inseridos ou atualizados em milissegundos, ignorando a lentid√£o do processamento linha a linha.\r\n\r\nPara fechar este ciclo, demos aos desenvolvedores o controle sobre o carregamento de dados com **Eager Loading** (`Include`) e **Explicit Loading**, eliminando o temido problema de \"N+1 queries\" que assombra ORMs mal projetados.\r\n\r\n---\r\n\r\n## A Era da Produtividade (Tooling)\r\n\r\nUm framework poderoso sem ferramentas √© como um carro de F√≥rmula 1 sem volante. Precis√°vamos de controle.\r\n\r\nNesta fase, a linha de comando **Dext CLI** ganhou vida.\r\nCom ela, o pesadelo de versionar banco de dados acabou. As **Migrations** tornaram-se cidad√£s de primeira classe: `dext migrate:up`, `migrate:down`. Mas fomos al√©m: criamos o **Scaffolding** (Database First), capaz de ler um banco legado e gerar todas as entidades Delphi automaticamente.\r\n\r\n**Mas n√£o paramos no terminal. Entendemos que a complexidade moderna exige visibilidade. Por isso, come√ßamos a transformar a CLI em um verdadeiro cockpit visual com o Dext Dashboard (`dext ui`). O que era apenas linha de comando agora evolui para uma interface gr√°fica de monitoramento, onde configura√ß√µes, testes e a sa√∫de do projeto podem ser gerenciados visualmente, tirando o desenvolvedor do escuro.**\r\n\r\nEnquanto isso, nos bastidores, a aplica√ß√£o precisava fazer mais do que responder HTTP. Implementamos a **Async Task API**. Trouxemos primitivas modernas de concorr√™ncia, permitindo encadeamento de tarefas (`.ThenBy`), cancelamento via `CancellationToken` e execu√ß√£o n√£o bloqueante.\r\n\r\n**Para provar que toda essa orquestra funcionava em harmonia, n√£o nos contentamos com um \"Hello World\". Constru√≠mos um arsenal de exemplos pr√°ticos.**\r\n\r\nO **Dext Starter Admin** surgiu como nosso \"cart√£o de visitas\" visual ‚Äî uma aplica√ß√£o *Real World* completa com Dashboard, HTMX e Autentica√ß√£o. Mas ele √© apenas um fragmento da nossa valida√ß√£o. Ao lado dele, desenvolvemos cen√°rios complexos demonstrando desde **APIs de Alta Performance** at√© **Modelagens ORM Avan√ßadas**. N√£o foi apenas teoria; o framework foi forjado no fogo de casos de uso reais.\r\n\r\n---\r\n\r\n## A Precis√£o Cir√∫rgica (Tipagem e Performance)\r\n\r\nAqui, a engenharia atingiu um n√≠vel de sofistica√ß√£o raro. Decidimos eliminar a fragilidade das \"Magic Strings\" nas queries.\r\n\r\n![Smart Properties](../../../assets/smartprops.png)\r\n\r\nIntroduzimos as **Smart Properties (`Prop<T>`)**.\r\nEssa foi a virada de chave. Agora, o desenvolvedor escreve `Where(u.Age > 18)` e o compilador valida a exist√™ncia da propriedade e o tipo de dado. Se o c√≥digo compila, a query funciona.\r\n\r\nMas a modernidade exigia mais. O mundo fala JSON e UUIDs.\r\nImplementamos conversores de tipos avan√ßados para suportar nativamente colunas **JSON/JSONB** e **Arrays** do PostgreSQL. E para resolver o eterno problema de chaves prim√°rias distribu√≠das, implementamos o **UUID v7** (ordenado por tempo) como um tipo de primeira classe, garantindo performance de inser√ß√£o em bancos indexados.\r\n\r\nParalelamente, iniciamos a cruzada pelo **Zero-Allocation**. Reescrevemos o parser JSON e o manuseio de HTTP Context para minimizar a press√£o no Memory Manager e overhead do ARC nas interfaces, preparando o terreno para uma performance de \"metal puro\".\r\n\r\n---\r\n\r\n## O Padr√£o Enterprise\r\n\r\nA reta final para o Beta foi dedicada a funcionalidades que separam \"projetos de fim de semana\" de \"sistemas corporativos globais\".\r\n\r\nA primeira delas foi o **Multi-Tenancy**.\r\nO Dext agora suporta nativamente aplica√ß√µes SaaS, isolando dados por Coluna, por Schema ou at√© por Banco de Dados diferente para cada cliente, tudo transparente para o desenvolvedor de neg√≥cio.\r\n\r\nTrouxemos a complexidade da Orienta√ß√£o a Objetos para o banco com o mapeamento de heran√ßa **Table-Per-Hierarchy (TPH)**. Agora, uma classe `TPessoa` pode ser salva na mesma tabela que `TFuncionario` e `TCliente`, e o ORM sabe exatamente qual subclasse instanciar ao ler os dados.\r\n\r\nE para aqueles que precisam de velocidade de desenvolvimento insana, criamos o **Database as API**.\r\nCom uma √∫nica linha de c√≥digo ‚Äî `TDataApiHandler<T>.Map` ‚Äî o framework exp√µe uma API REST completa (CRUD, Filtros, Pagina√ß√£o e Seguran√ßa) para qualquer entidade. √â o \"Low-Code\" dentro do \"Pro-Code\".\r\n\r\n---\r\n\r\n## A Garantia da Qualidade (Testing Ecosystem)\r\n\r\nUm gigante n√£o pode ter p√©s de barro. Para a vers√£o 1.0, criamos um ecossistema de testes que rivaliza com qualquer plataforma.\r\n\r\nNasceu o **Dext.Testing**.\r\nInspirado na fluidez do *NUnit*, *Moq* e *FluentAssertions*, ele trouxe:\r\n\r\n* **Mocks Poderosos:** `Mock<T>` para interfaces e classes.\r\n* **Asser√ß√µes Fluentes:** Uma sintaxe humana `Should(Valor).Be(...)`.\r\n* **Snapshot Testing:** Para garantir que contratos de API e objetos complexos n√£o mudem inesperadamente.\r\n* **Soft Asserts:** `Assert.Multiple` para validar v√°rios pontos sem abortar o teste na primeira falha.\r\n\r\nE para tornar a qualidade vis√≠vel, integramos tudo isso a um **Live Dashboard** na CLI e suporte a **Code Coverage** com Quality Gates, impedindo que c√≥digo sem testes chegue a produ√ß√£o.\r\n\r\n![Quality Dashboard](../../../assets/quality-dashboard.png)\r\n\r\n---\r\n\r\n## O Dext em N√∫meros: A Escala da Ambi√ß√£o\r\n\r\n![Dext Statistics](../../../assets/statistics.png)\r\n\r\nPalavras podem descrever a vis√£o, mas os n√∫meros revelam o esfor√ßo. O Dext n√£o apenas nasceu; ele se tornou um gigante. A robustez da v1.0 n√£o √© uma promessa, √© uma realidade mensur√°vel em mais de meio milh√£o de linhas de c√≥digo focadas em qualidade e valida√ß√£o:\r\n\r\n* **Framework Core:** 86.537 linhas de pura engenharia.\r\n* **Blindagem de Testes:** 273.969 linhas dedicadas exclusivamente a garantir que nada quebre (*177k de Testes do Framework + 96k do Dext.Testing*).\r\n* **Valida√ß√£o Real:** 212.914 linhas de c√≥digos de exemplo, provando cada feature em cen√°rios de uso.\r\n\r\n**Total: 573.420 linhas de c√≥digo.**\r\n\r\nEste volume de trabalho n√£o √© acidental. √â o resultado de uma obsess√£o em entregar n√£o apenas um componente, mas um framework completo e bem testado para a comunidade Delphi.\r\n\r\n---\r\n\r\n## Conclus√£o: O Estado da Arte em Delphi\r\n\r\nO lan√ßamento do **Dext Framework v1.0** n√£o √© apenas uma atualiza√ß√£o de software; √© um marco. Sa√≠mos do zero para entregar uma experi√™ncia de desenvolvimento mais moderna e integrada do ecossistema Delphi.\r\n\r\nN√≥s provamos que o Delphi n√£o precisa viver no passado. Com a arquitetura certa, ele pode oferecer a mesma eleg√¢ncia, testabilidade e produtividade das stacks mais modernas do mercado, mantendo a performance nativa que √© sua marca registrada.\r\n\r\nO Dext √© o convite para voc√™ construir o pr√≥ximo grande sistema Enterprise, microsservi√ßo ou SaaS, sem abrir m√£o da linguagem que voc√™ domina, mas com as ferramentas que voc√™ sempre sonhou.\r\n\r\n**O futuro do desenvolvimento Delphi come√ßou. E ele √© Open Source.**\r\n\r\nhttps://github.com/cesarliws/dext","src/content/docs/articles/dext-story.md",[56,57,58,59],"../../../assets/delphi-dext.png","../../../assets/smartprops.png","../../../assets/quality-dashboard.png","../../../assets/statistics.png","b9e8d5db83610979",{html:62,metadata:63},"<p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;../../../assets/delphi-dext.png&#x22;,&#x22;alt&#x22;:&#x22;Dext Framework Evolution&#x22;,&#x22;index&#x22;:0}\"></p>\n<blockquote>\n<p><em>‚ÄúSimplicity is Complicated.‚Äù ‚Äî Rob Pike</em></p>\n</blockquote>\n<p>Por muito tempo, o ecossistema Delphi viveu uma dicotomia. De um lado, t√≠nhamos a linguagem poderosa, o compilador r√°pido e a estabilidade lend√°ria. Do outro, olh√°vamos para o horizonte do .NET Core, Spring Boot e Node.js, vendo arquiteturas limpas, inje√ß√£o de depend√™ncia robusta e testes fluentes, sentindo que algo faltava.</p>\n<p>N√£o faltava capacidade √† linguagem. Faltava uma funda√ß√£o.</p>\n<p>O <strong>Dext Framework</strong> nasceu dessa inquietude: a exaust√£o de integrar bibliotecas desconexas, com padr√µes conflitantes e reposit√≥rios muitas vezes abandonados. O objetivo n√£o era apenas criar ‚Äòmais um servidor HTTP‚Äô, mas erguer uma catedral arquitetural unificada. Constru√≠mos um ecossistema Full-Stack organicamente integrado, onde Inje√ß√£o de Depend√™ncia, ORM Moderno, Framework Web e Testes n√£o s√£o pe√ßas soltas for√ßadas a conviver, mas uma sinfonia coesa que fala a mesma l√≠ngua e compartilha o mesmo DNA desde a primeira linha de c√≥digo.</p>\n<p>Esta √© a hist√≥ria de como transformamos essa vis√£o em realidade, aplicando ao Object Pascal a engenharia de software moderna e os padr√µes arquiteturais mais bem estabelecidos da ind√∫stria.</p>\n<hr>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"a-funda√ß√£o-e-o-protocolo-o-in√≠cio\">A Funda√ß√£o e o Protocolo (O In√≠cio)</h2><a class=\"sl-anchor-link\" href=\"#a-funda√ß√£o-e-o-protocolo-o-in√≠cio\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúA Funda√ß√£o e o Protocolo (O In√≠cio)‚Äù</span></a></div>\n<p>Tudo come√ßou no sil√™ncio de um reposit√≥rio vazio. O primeiro commit, ‚ÄúDext is born‚Äù, foi mais do que c√≥digo; foi uma declara√ß√£o de inten√ß√µes. Mas um framework n√£o nasce pronto; ele precisa de um sistema nervoso central.</p>\n<p>Nos primeiros dias, rejeitamos o acoplamento tradicional. Antes de servirmos a primeira p√°gina HTML, constru√≠mos o <strong>Container de Inje√ß√£o de Depend√™ncia</strong>. Quer√≠amos que servi√ßos como <code dir=\"auto\">Scoped</code>, <code dir=\"auto\">Singleton</code> e <code dir=\"auto\">Transient</code> fossem naturais, permitindo que a aplica√ß√£o respirasse e crescesse sem se tornar um espaguete de c√≥digo.</p>\n<p>Com o cora√ß√£o pulsando, demos vida √† camada HTTP.\r\nN√£o nos contentamos com o b√°sico. Implementamos <strong>Minimal APIs</strong> para a agilidade de microsservi√ßos, mas fomos al√©m do roteamento simples. Quebramos a barreira entre a Rota e o Container com a <strong>Inje√ß√£o de Depend√™ncia em Handlers</strong>. Agora, servi√ßos podiam ser injetados diretamente na assinatura de m√©todos an√¥nimos ‚Äî voc√™ pede o servi√ßo nos par√¢metros, e o framework entrega.</p>\n<p>Simultaneamente, declaramos guerra ao <em>boilerplate</em> de parsing e mapeamento. O <strong>Smart Model Binding</strong> nasceu para transformar payloads JSON brutos em Records e Classes fortemente tipados, automaticamente. E para garantir a integridade logo na porta de entrada, integramos a <strong>Model Validation</strong>, assegurando que dados inv√°lidos sejam barrados antes mesmo de tocarem a regra de neg√≥cio.</p>\n<p>Para eliminar a √∫ltima barreira de fric√ß√£o na entrada de dados, introduzimos a classe <code dir=\"auto\">TMapper</code> que implementa o padr√£o <strong>Auto Mapper</strong>, permitindo que DTOs de formul√°rios fossem convertidos em Entidades de dom√≠nio sem a necessidade de escrever dezenas de linhas de atribui√ß√£o manual. Trouxemos tamb√©m os <strong>Controllers</strong>, para quem exige a organiza√ß√£o cl√°ssica MVC.</p>\n<p>Mas a excel√™ncia exige precis√£o absoluta. N√£o bastava receber requisi√ß√µes; precis√°vamos trat√°-las com eleg√¢ncia.\r\nCriamos um <strong>Pipeline de Middlewares</strong> modular. Logo, a seguran√ßa entrou em cena n√£o como um ‚Äúadd-on‚Äù, mas como parte do fluxo: <strong>JWT (JSON Web Tokens)</strong> para autentica√ß√£o stateless, <strong>Rate Limiting</strong> para prote√ß√£o contra abusos e <strong>CORS</strong> para a conviv√™ncia pac√≠fica na web moderna.</p>\n<p>E para amarrar tudo, introduzimos o padr√£o <strong>Options Pattern</strong> e o suporte a <strong>Configuration</strong> (JSON, YAML e Vari√°veis de Ambiente). Agora, configura√ß√µes n√£o eram mais constantes espalhadas, mas objetos tipados e injet√°veis.</p>\n<blockquote>\n<p><em>A cena era de constru√ß√£o de alicerces: cada pe√ßa (DI, Config, Logging) encaixando-se perfeitamente antes mesmo da primeira regra de neg√≥cio ser escrita.</em></p>\n</blockquote>\n<hr>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"a-revolu√ß√£o-dos-dados-o-orm\">A Revolu√ß√£o dos Dados (O ORM)</h2><a class=\"sl-anchor-link\" href=\"#a-revolu√ß√£o-dos-dados-o-orm\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúA Revolu√ß√£o dos Dados (O ORM)‚Äù</span></a></div>\n<p>Com a web funcionando, enfrentamos o ‚ÄúChef√£o‚Äù do desenvolvimento Delphi: o banco de dados. A comunidade estava cansada de manipular SQL Strings e componentes visuais acoplados. O <strong>Dext.Entity</strong> nasceu para mudar isso.</p>\n<p>A primeira batalha foi contra o SQL manual. Criamos a <strong>Fluent Query API</strong>.\r\nImagine escrever c√≥digo sem nunca tocar em uma string SQL. Implementamos proje√ß√µes (<code dir=\"auto\">Select</code>), pagina√ß√£o (<code dir=\"auto\">Skip</code>/<code dir=\"auto\">Take</code>) e agrupamentos (<code dir=\"auto\">GroupBy</code>) que o compilador traduz para a linguagem do banco.</p>\n<p><strong>Mas a verdadeira eleg√¢ncia arquitetural veio com a integra√ß√£o nativa do Specification Pattern, inspirada nos ensinamentos de Steve ‚ÄúArdalis‚Äù Smith</strong>. Constru√≠mos essa camada lado a lado com a API fluente para encapsular regras de neg√≥cio complexas em classes reutiliz√°veis. Isso foi o movimento decisivo para desacoplar a aplica√ß√£o da comunica√ß√£o direta com o banco, permitindo finalmente a cria√ß√£o de Controllers e Reposit√≥rios verdadeiramente limpos, onde a inten√ß√£o do c√≥digo prevalece sobre a implementa√ß√£o.</p>\n<p>Mas o mundo n√£o √© apenas um banco de dados. Para sermos verdadeiramente universais, implementamos uma camada de abstra√ß√£o que fala fluentemente <strong>SQLite, PostgreSQL, Firebird, SQL Server, Oracle e MySQL</strong>.</p>\n<p>Sab√≠amos que performance √© inegoci√°vel. Por isso, n√£o paramos no b√°sico. Implementamos <strong>Connection Pooling</strong> para suportar alta concorr√™ncia e <strong>Bulk Operations</strong>, permitindo que milhares de registros sejam inseridos ou atualizados em milissegundos, ignorando a lentid√£o do processamento linha a linha.</p>\n<p>Para fechar este ciclo, demos aos desenvolvedores o controle sobre o carregamento de dados com <strong>Eager Loading</strong> (<code dir=\"auto\">Include</code>) e <strong>Explicit Loading</strong>, eliminando o temido problema de ‚ÄúN+1 queries‚Äù que assombra ORMs mal projetados.</p>\n<hr>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"a-era-da-produtividade-tooling\">A Era da Produtividade (Tooling)</h2><a class=\"sl-anchor-link\" href=\"#a-era-da-produtividade-tooling\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúA Era da Produtividade (Tooling)‚Äù</span></a></div>\n<p>Um framework poderoso sem ferramentas √© como um carro de F√≥rmula 1 sem volante. Precis√°vamos de controle.</p>\n<p>Nesta fase, a linha de comando <strong>Dext CLI</strong> ganhou vida.\r\nCom ela, o pesadelo de versionar banco de dados acabou. As <strong>Migrations</strong> tornaram-se cidad√£s de primeira classe: <code dir=\"auto\">dext migrate:up</code>, <code dir=\"auto\">migrate:down</code>. Mas fomos al√©m: criamos o <strong>Scaffolding</strong> (Database First), capaz de ler um banco legado e gerar todas as entidades Delphi automaticamente.</p>\n<p><strong>Mas n√£o paramos no terminal. Entendemos que a complexidade moderna exige visibilidade. Por isso, come√ßamos a transformar a CLI em um verdadeiro cockpit visual com o Dext Dashboard (<code dir=\"auto\">dext ui</code>). O que era apenas linha de comando agora evolui para uma interface gr√°fica de monitoramento, onde configura√ß√µes, testes e a sa√∫de do projeto podem ser gerenciados visualmente, tirando o desenvolvedor do escuro.</strong></p>\n<p>Enquanto isso, nos bastidores, a aplica√ß√£o precisava fazer mais do que responder HTTP. Implementamos a <strong>Async Task API</strong>. Trouxemos primitivas modernas de concorr√™ncia, permitindo encadeamento de tarefas (<code dir=\"auto\">.ThenBy</code>), cancelamento via <code dir=\"auto\">CancellationToken</code> e execu√ß√£o n√£o bloqueante.</p>\n<p><strong>Para provar que toda essa orquestra funcionava em harmonia, n√£o nos contentamos com um ‚ÄúHello World‚Äù. Constru√≠mos um arsenal de exemplos pr√°ticos.</strong></p>\n<p>O <strong>Dext Starter Admin</strong> surgiu como nosso ‚Äúcart√£o de visitas‚Äù visual ‚Äî uma aplica√ß√£o <em>Real World</em> completa com Dashboard, HTMX e Autentica√ß√£o. Mas ele √© apenas um fragmento da nossa valida√ß√£o. Ao lado dele, desenvolvemos cen√°rios complexos demonstrando desde <strong>APIs de Alta Performance</strong> at√© <strong>Modelagens ORM Avan√ßadas</strong>. N√£o foi apenas teoria; o framework foi forjado no fogo de casos de uso reais.</p>\n<hr>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"a-precis√£o-cir√∫rgica-tipagem-e-performance\">A Precis√£o Cir√∫rgica (Tipagem e Performance)</h2><a class=\"sl-anchor-link\" href=\"#a-precis√£o-cir√∫rgica-tipagem-e-performance\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúA Precis√£o Cir√∫rgica (Tipagem e Performance)‚Äù</span></a></div>\n<p>Aqui, a engenharia atingiu um n√≠vel de sofistica√ß√£o raro. Decidimos eliminar a fragilidade das ‚ÄúMagic Strings‚Äù nas queries.</p>\n<p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;../../../assets/smartprops.png&#x22;,&#x22;alt&#x22;:&#x22;Smart Properties&#x22;,&#x22;index&#x22;:0}\"></p>\n<p>Introduzimos as <strong>Smart Properties (<code dir=\"auto\">Prop&#x3C;T></code>)</strong>.\r\nEssa foi a virada de chave. Agora, o desenvolvedor escreve <code dir=\"auto\">Where(u.Age > 18)</code> e o compilador valida a exist√™ncia da propriedade e o tipo de dado. Se o c√≥digo compila, a query funciona.</p>\n<p>Mas a modernidade exigia mais. O mundo fala JSON e UUIDs.\r\nImplementamos conversores de tipos avan√ßados para suportar nativamente colunas <strong>JSON/JSONB</strong> e <strong>Arrays</strong> do PostgreSQL. E para resolver o eterno problema de chaves prim√°rias distribu√≠das, implementamos o <strong>UUID v7</strong> (ordenado por tempo) como um tipo de primeira classe, garantindo performance de inser√ß√£o em bancos indexados.</p>\n<p>Paralelamente, iniciamos a cruzada pelo <strong>Zero-Allocation</strong>. Reescrevemos o parser JSON e o manuseio de HTTP Context para minimizar a press√£o no Memory Manager e overhead do ARC nas interfaces, preparando o terreno para uma performance de ‚Äúmetal puro‚Äù.</p>\n<hr>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"o-padr√£o-enterprise\">O Padr√£o Enterprise</h2><a class=\"sl-anchor-link\" href=\"#o-padr√£o-enterprise\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúO Padr√£o Enterprise‚Äù</span></a></div>\n<p>A reta final para o Beta foi dedicada a funcionalidades que separam ‚Äúprojetos de fim de semana‚Äù de ‚Äúsistemas corporativos globais‚Äù.</p>\n<p>A primeira delas foi o <strong>Multi-Tenancy</strong>.\r\nO Dext agora suporta nativamente aplica√ß√µes SaaS, isolando dados por Coluna, por Schema ou at√© por Banco de Dados diferente para cada cliente, tudo transparente para o desenvolvedor de neg√≥cio.</p>\n<p>Trouxemos a complexidade da Orienta√ß√£o a Objetos para o banco com o mapeamento de heran√ßa <strong>Table-Per-Hierarchy (TPH)</strong>. Agora, uma classe <code dir=\"auto\">TPessoa</code> pode ser salva na mesma tabela que <code dir=\"auto\">TFuncionario</code> e <code dir=\"auto\">TCliente</code>, e o ORM sabe exatamente qual subclasse instanciar ao ler os dados.</p>\n<p>E para aqueles que precisam de velocidade de desenvolvimento insana, criamos o <strong>Database as API</strong>.\r\nCom uma √∫nica linha de c√≥digo ‚Äî <code dir=\"auto\">TDataApiHandler&#x3C;T>.Map</code> ‚Äî o framework exp√µe uma API REST completa (CRUD, Filtros, Pagina√ß√£o e Seguran√ßa) para qualquer entidade. √â o ‚ÄúLow-Code‚Äù dentro do ‚ÄúPro-Code‚Äù.</p>\n<hr>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"a-garantia-da-qualidade-testing-ecosystem\">A Garantia da Qualidade (Testing Ecosystem)</h2><a class=\"sl-anchor-link\" href=\"#a-garantia-da-qualidade-testing-ecosystem\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúA Garantia da Qualidade (Testing Ecosystem)‚Äù</span></a></div>\n<p>Um gigante n√£o pode ter p√©s de barro. Para a vers√£o 1.0, criamos um ecossistema de testes que rivaliza com qualquer plataforma.</p>\n<p>Nasceu o <strong>Dext.Testing</strong>.\r\nInspirado na fluidez do <em>NUnit</em>, <em>Moq</em> e <em>FluentAssertions</em>, ele trouxe:</p>\n<ul>\n<li><strong>Mocks Poderosos:</strong> <code dir=\"auto\">Mock&#x3C;T></code> para interfaces e classes.</li>\n<li><strong>Asser√ß√µes Fluentes:</strong> Uma sintaxe humana <code dir=\"auto\">Should(Valor).Be(...)</code>.</li>\n<li><strong>Snapshot Testing:</strong> Para garantir que contratos de API e objetos complexos n√£o mudem inesperadamente.</li>\n<li><strong>Soft Asserts:</strong> <code dir=\"auto\">Assert.Multiple</code> para validar v√°rios pontos sem abortar o teste na primeira falha.</li>\n</ul>\n<p>E para tornar a qualidade vis√≠vel, integramos tudo isso a um <strong>Live Dashboard</strong> na CLI e suporte a <strong>Code Coverage</strong> com Quality Gates, impedindo que c√≥digo sem testes chegue a produ√ß√£o.</p>\n<p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;../../../assets/quality-dashboard.png&#x22;,&#x22;alt&#x22;:&#x22;Quality Dashboard&#x22;,&#x22;index&#x22;:0}\"></p>\n<hr>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"o-dext-em-n√∫meros-a-escala-da-ambi√ß√£o\">O Dext em N√∫meros: A Escala da Ambi√ß√£o</h2><a class=\"sl-anchor-link\" href=\"#o-dext-em-n√∫meros-a-escala-da-ambi√ß√£o\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúO Dext em N√∫meros: A Escala da Ambi√ß√£o‚Äù</span></a></div>\n<p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;../../../assets/statistics.png&#x22;,&#x22;alt&#x22;:&#x22;Dext Statistics&#x22;,&#x22;index&#x22;:0}\"></p>\n<p>Palavras podem descrever a vis√£o, mas os n√∫meros revelam o esfor√ßo. O Dext n√£o apenas nasceu; ele se tornou um gigante. A robustez da v1.0 n√£o √© uma promessa, √© uma realidade mensur√°vel em mais de meio milh√£o de linhas de c√≥digo focadas em qualidade e valida√ß√£o:</p>\n<ul>\n<li><strong>Framework Core:</strong> 86.537 linhas de pura engenharia.</li>\n<li><strong>Blindagem de Testes:</strong> 273.969 linhas dedicadas exclusivamente a garantir que nada quebre (<em>177k de Testes do Framework + 96k do Dext.Testing</em>).</li>\n<li><strong>Valida√ß√£o Real:</strong> 212.914 linhas de c√≥digos de exemplo, provando cada feature em cen√°rios de uso.</li>\n</ul>\n<p><strong>Total: 573.420 linhas de c√≥digo.</strong></p>\n<p>Este volume de trabalho n√£o √© acidental. √â o resultado de uma obsess√£o em entregar n√£o apenas um componente, mas um framework completo e bem testado para a comunidade Delphi.</p>\n<hr>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"conclus√£o-o-estado-da-arte-em-delphi\">Conclus√£o: O Estado da Arte em Delphi</h2><a class=\"sl-anchor-link\" href=\"#conclus√£o-o-estado-da-arte-em-delphi\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúConclus√£o: O Estado da Arte em Delphi‚Äù</span></a></div>\n<p>O lan√ßamento do <strong>Dext Framework v1.0</strong> n√£o √© apenas uma atualiza√ß√£o de software; √© um marco. Sa√≠mos do zero para entregar uma experi√™ncia de desenvolvimento mais moderna e integrada do ecossistema Delphi.</p>\n<p>N√≥s provamos que o Delphi n√£o precisa viver no passado. Com a arquitetura certa, ele pode oferecer a mesma eleg√¢ncia, testabilidade e produtividade das stacks mais modernas do mercado, mantendo a performance nativa que √© sua marca registrada.</p>\n<p>O Dext √© o convite para voc√™ construir o pr√≥ximo grande sistema Enterprise, microsservi√ßo ou SaaS, sem abrir m√£o da linguagem que voc√™ domina, mas com as ferramentas que voc√™ sempre sonhou.</p>\n<p><strong>O futuro do desenvolvimento Delphi come√ßou. E ele √© Open Source.</strong></p>\n<p><a href=\"https://github.com/cesarliws/dext\">https://github.com/cesarliws/dext</a></p>",{headings:64,localImagePaths:90,remoteImagePaths:91,frontmatter:92,imagePaths:99},[65,69,72,75,78,81,84,87],{depth:66,slug:67,text:68},2,"a-funda√ß√£o-e-o-protocolo-o-in√≠cio","A Funda√ß√£o e o Protocolo (O In√≠cio)",{depth:66,slug:70,text:71},"a-revolu√ß√£o-dos-dados-o-orm","A Revolu√ß√£o dos Dados (O ORM)",{depth:66,slug:73,text:74},"a-era-da-produtividade-tooling","A Era da Produtividade (Tooling)",{depth:66,slug:76,text:77},"a-precis√£o-cir√∫rgica-tipagem-e-performance","A Precis√£o Cir√∫rgica (Tipagem e Performance)",{depth:66,slug:79,text:80},"o-padr√£o-enterprise","O Padr√£o Enterprise",{depth:66,slug:82,text:83},"a-garantia-da-qualidade-testing-ecosystem","A Garantia da Qualidade (Testing Ecosystem)",{depth:66,slug:85,text:86},"o-dext-em-n√∫meros-a-escala-da-ambi√ß√£o","O Dext em N√∫meros: A Escala da Ambi√ß√£o",{depth:66,slug:88,text:89},"conclus√£o-o-estado-da-arte-em-delphi","Conclus√£o: O Estado da Arte em Delphi",[56,57,58,59],[],{title:47,description:48,date:93,tags:94},["Date","2026-01-06T00:00:00.000Z"],[95,96,97,98],"Delphi","Dext","Framework","History",[56,57,58,59],"articles/modern-delphi-concepts",{id:100,data:102,body:108,filePath:109,digest:110,deferredRender:16},{title:103,description:104,editUrl:16,head:105,template:50,sidebar:106,pagefind:16,draft:37},"Desenvolvimento Delphi Moderno: Conceitos do Dext Framework","Desmistificando o Dext Framework para o desenvolvedor tradicional: Inje√ß√£o de Depend√™ncia, API Fluente, Code-First e muito mais.",[],{hidden:37,attrs:107},{},"<div class=\"not-prose\">\r\n<script src=\"https://cdn.tailwindcss.com\"></script>\r\n<script src=\"https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js\"></script>\r\n\r\n<div class=\"text-gray-800 bg-gray-50 rounded-xl overflow-hidden shadow-sm\">\r\n<header class=\"bg-gradient-to-r from-indigo-800 to-indigo-600 text-white p-8 md:p-12 shadow-md\">\r\n<div class=\"max-w-7xl mx-auto text-center\">\r\n<h1 class=\"text-4xl md:text-5xl font-extrabold tracking-tight mb-4 text-white\">\r\nModernizando o Delphi\r\n</h1>\r\n<p class=\"text-lg md:text-xl font-light text-indigo-100 mb-8\">\r\nDesmistificando o Dext Framework para o Desenvolvedor Tradicional\r\n</p>\r\n<div class=\"grid grid-cols-1 md:grid-cols-3 gap-6 text-center mt-8\">\r\n<div class=\"bg-indigo-900 bg-opacity-30 p-4 rounded-lg backdrop-blur-sm border border-indigo-400\">\r\n<span class=\"block text-2xl font-bold text-cyan-400\">RAD</span>\r\n<span class=\"text-sm text-indigo-200\">As Ra√≠zes</span>\r\n</div>\r\n<div class=\"flex items-center justify-center text-3xl text-white opacity-50\">\r\n‚ûú\r\n</div>\r\n<div class=\"bg-indigo-900 bg-opacity-30 p-4 rounded-lg backdrop-blur-sm border border-indigo-400\">\r\n<span class=\"block text-2xl font-bold text-orange-400\">DEXT</span>\r\n<span class=\"text-sm text-indigo-200\">O Futuro</span>\r\n</div>\r\n</div>\r\n</div>\r\n</header>\r\n\r\n<section class=\"max-w-5xl mx-auto py-8 px-6\">\r\n<div class=\"bg-white rounded-xl shadow-sm p-6 border-l-8 border-indigo-600\">\r\n<h2 class=\"text-xl font-bold text-indigo-900 mb-4 mt-0\">Por que mudar o que funciona?</h2>\r\n<p class=\"text-base leading-relaxed text-gray-600\">\r\nVoc√™ construiu sistemas robustos com TForm e TDataSet por anos. Mas √† medida que os requisitos crescem (Mobile, Web, Nuvem), a \"velha maneira\" de acoplar fortemente a l√≥gica aos formul√°rios visuais torna-se um gargalo. O Dext Framework introduz padr√µes globais comprovados ao Delphi. N√£o s√£o novas linguagens ‚Äî √© apenas uma nova gram√°tica para a linguagem que voc√™ j√° ama.\r\n</p>\r\n</div>\r\n</section>\r\n\r\n<main class=\"max-w-7xl mx-auto px-6 py-4 grid grid-cols-1 gap-12\">\r\n\r\n<section class=\"grid grid-cols-1 md:grid-cols-2 gap-8 items-center bg-white rounded-2xl shadow-md overflow-hidden border border-gray-100\">\r\n<div class=\"p-6 md:p-8\">\r\n<div class=\"inline-block bg-orange-100 text-orange-600 font-bold px-3 py-1 rounded-full text-xs mb-4\">Conceito Core</div>\r\n<h3 class=\"text-2xl font-bold text-gray-900 mb-4 mt-0\">Inje√ß√£o de Depend√™ncia (DI)</h3>\r\n<h4 class=\"text-lg text-indigo-600 font-semibold mb-4\">\"A Analogia da Bateria de Carro\"</h4>\r\n<p class=\"text-gray-600 mb-6 leading-relaxed text-sm\">\r\nPense no seu c√≥digo como um carro. Antigamente (acoplamento forte), voc√™ soldava a bateria diretamente no bloco do motor. Para trocar a bateria, era preciso serrar o carro. \r\n<br/><br/>\r\n<strong>Inje√ß√£o de Depend√™ncia</strong> √© simplesmente adicionar um \"slot de bateria\" (Interface). Voc√™ pode deslizar uma **Moura**, uma **Heliar** ou uma **Bosch** (Implementa√ß√£o), desde que ela caiba no slot.\r\n</p>\r\n</div>\r\n<div class=\"bg-gray-50 p-6 flex flex-col justify-center items-center h-full border-l border-gray-100 min-h-[300px]\">\r\n<h5 class=\"text-center font-bold text-gray-700 mb-4 text-sm\">Compara√ß√£o de Modularidade do Sistema</h5>\r\n<div class=\"relative w-full h-[200px]\">\r\n<canvas id=\"diChart\"></canvas>\r\n</div>\r\n<p class=\"text-center text-xs text-gray-500 mt-4 italic\">\r\nDI reduz o \"C√≥digo Espaguete\" (Acoplamento) e aumenta a facilidade de testes.\r\n</p>\r\n</div>\r\n</section>\r\n\r\n<section class=\"grid grid-cols-1 gap-8 items-center bg-white rounded-2xl shadow-md overflow-hidden p-6 border border-gray-100\">\r\n<div class=\"text-center max-w-3xl mx-auto\">\r\n<div class=\"inline-block bg-cyan-100 text-cyan-700 font-bold px-3 py-1 rounded-full text-xs mb-4\">Arquitetura de Banco de Dados</div>\r\n<h3 class=\"text-2xl font-bold text-gray-900 mb-4 mt-0\">Desenvolvimento Code-First</h3>\r\n<p class=\"text-gray-600 mb-4 leading-relaxed text-sm\">\r\nPare de escrever scripts `CREATE TABLE` manualmente. Com Code-First, suas classes Delphi <strong>s√£o</strong> a defini√ß√£o mestre. Voc√™ define uma propriedade, e o Dext atualiza o esquema do banco de dados automaticamente. Isso mant√©m seu c√≥digo e dados perfeitamente sincronizados.\r\n</p>\r\n</div>\r\n\r\n<div class=\"flex flex-col md:flex-row justify-center items-center gap-4 w-full py-6 bg-slate-50 rounded-xl border border-slate-200 px-4\">\r\n<div class=\"bg-white p-4 rounded-lg shadow-sm border-t-4 border-indigo-500 w-full md:w-56 overflow-hidden\">\r\n<h4 class=\"font-bold text-gray-800 text-xs mb-2 text-center uppercase tracking-wider\">Classe Delphi</h4>\r\n<div class=\"bg-slate-900 rounded p-2 text-[10px] font-mono leading-tight text-indigo-300\">\r\n<span class=\"text-purple-400\">type</span> TUser = <span class=\"text-purple-400\">class</span><br/>\r\n&nbsp;&nbsp;[Column] Name: <span class=\"text-blue-300\">string</span>;<br/>\r\n<span class=\"text-purple-400\">end</span>;\r\n</div>\r\n</div>\r\n<div class=\"text-2xl text-gray-400 rotate-90 md:rotate-0\">‚ûú</div>\r\n<div class=\"bg-indigo-600 p-4 rounded-lg shadow-sm w-full md:w-56 text-center text-white\">\r\n<div class=\"text-3xl mb-2\">‚öôÔ∏è</div>\r\n<h4 class=\"font-bold text-xs uppercase tracking-wider\">Motor Dext</h4>\r\n<p class=\"text-[10px] text-indigo-200 mt-2\">\r\nMapeamento Autom√°tico<br/>\r\n& L√≥gica de Migra√ß√£o\r\n</p>\r\n</div>\r\n<div class=\"text-2xl text-gray-400 rotate-90 md:rotate-0\">‚ûú</div>\r\n<div class=\"bg-white p-4 rounded-lg shadow-sm border-t-4 border-cyan-500 w-full md:w-56 overflow-hidden\">\r\n<h4 class=\"font-bold text-gray-800 text-xs mb-2 text-center uppercase tracking-wider\">Banco SQL</h4>\r\n<div class=\"bg-slate-900 rounded p-2 text-[10px] font-mono leading-tight text-cyan-300\">\r\n<span class=\"text-purple-400\">CREATE TABLE</span> Users (<br/>\r\n&nbsp;&nbsp;Name <span class=\"text-blue-300\">VARCHAR</span>(255)<br/>\r\n);\r\n</div>\r\n</div>\r\n</div>\r\n</section>\r\n\r\n<section class=\"grid grid-cols-1 md:grid-cols-2 gap-8 items-center bg-white rounded-2xl shadow-md overflow-hidden border border-gray-100\">\r\n<div class=\"bg-gray-50 p-6 flex flex-col justify-center items-center h-full border-r border-gray-100 order-2 md:order-1 min-h-[300px]\">\r\n<h5 class=\"text-center font-bold text-gray-700 mb-4 text-sm\">Clareza e Brevidade do C√≥digo</h5>\r\n<div class=\"relative w-full h-[200px]\">\r\n<canvas id=\"fluentChart\"></canvas>\r\n</div>\r\n</div>\r\n<div class=\"p-6 md:p-8 order-1 md:order-2\">\r\n<div class=\"inline-block bg-purple-100 text-purple-600 font-bold px-3 py-1 rounded-full text-xs mb-4\">Estilo de Codifica√ß√£o</div>\r\n<h3 class=\"text-2xl font-bold text-gray-900 mb-4 mt-0\">API Fluente</h3>\r\n<h4 class=\"text-lg text-indigo-600 font-semibold mb-4\">\"C√≥digo que conta uma hist√≥ria\"</h4>\r\n<p class=\"text-gray-600 mb-6 leading-relaxed text-sm\">\r\nAPI Fluente √© apenas uma maneira de encadear chamadas para que sejam lidas como uma frase. √â um a√ß√∫car sint√°tico para tornar o c√≥digo mais leg√≠vel, assemelhando-se a uma ora√ß√£o em vez de uma s√©rie de comandos.\r\n</p>\r\n<div class=\"bg-gray-900 p-4 rounded-lg font-mono text-xs text-indigo-300 shadow-inner\">\r\n<p class=\"text-gray-500 mb-2 border-b border-gray-800 pb-1 italic text-[10px]\">// Tradicional</p>\r\n<p>Query.SQL.Text := '...';</p>\r\n<p>Query.Open;</p>\r\n<p>Query.First;</p>\r\n<p class=\"text-gray-500 my-2 border-b border-gray-800 pb-1 italic text-[10px]\">// No Dext</p>\r\n<p class=\"text-white\">Query.From('Users').Where('Id', 1).Open();</p>\r\n</div>\r\n</div>\r\n</section>\r\n\r\n<section class=\"grid grid-cols-1 md:grid-cols-2 gap-8 items-center bg-white rounded-2xl shadow-md overflow-hidden border border-gray-100\">\r\n<div class=\"p-6 md:p-8\">\r\n<div class=\"inline-block bg-green-100 text-green-600 font-bold px-3 py-1 rounded-full text-xs mb-4\">Arquitetura</div>\r\n<h3 class=\"text-2xl font-bold text-gray-900 mb-4 mt-0\">Web API</h3>\r\n<h4 class=\"text-lg text-indigo-600 font-semibold mb-4\">\"Seu EXE na Nuvem\"</h4>\r\n<p class=\"text-gray-600 mb-6 leading-relaxed text-sm\">\r\nUm app Delphi tradicional aprisiona a l√≥gica dentro de um Formul√°rio Windows. Uma <strong>Web API</strong> √© apenas uma fun√ß√£o que retorna dados (JSON) em vez de abrir uma janela.\r\n<br/><br/>\r\nAo mover a l√≥gica para uma API, seu √∫nico c√≥digo-base Delphi pode agora alimentar um site React, um app de iPhone e uma integra√ß√£o com terceiros simultaneamente.\r\n</p>\r\n</div>\r\n<div class=\"bg-gray-50 p-6 flex flex-col justify-center items-center h-full border-l border-gray-100 min-h-[300px]\">\r\n<h5 class=\"text-center font-bold text-gray-700 mb-4 text-sm\">Potencial de Alcance do Cliente</h5>\r\n<div class=\"relative w-full h-[200px]\">\r\n<canvas id=\"apiChart\"></canvas>\r\n</div>\r\n<p class=\"text-center text-xs text-gray-500 mt-4 italic\">\r\nDesbloqueie 100% do ecossistema digital, n√£o apenas o Windows Desktop.\r\n</p>\r\n</div>\r\n</section>\r\n\r\n<section class=\"grid grid-cols-1 md:grid-cols-2 gap-8 items-center bg-white rounded-2xl shadow-md overflow-hidden border border-gray-100\">\r\n<div class=\"bg-gray-50 p-6 flex flex-col justify-center items-center h-full border-r border-gray-100 order-2 md:order-1 min-h-[300px]\">\r\n<h5 class=\"text-center font-bold text-gray-700 mb-4 text-sm\">Responsividade da UI (FPS)</h5>\r\n<div class=\"relative w-full h-[200px]\">\r\n<canvas id=\"asyncChart\"></canvas>\r\n</div>\r\n</div>\r\n<div class=\"p-6 md:p-8 order-1 md:order-2\">\r\n<div class=\"inline-block bg-red-100 text-red-600 font-bold px-3 py-1 rounded-full text-xs mb-4\">Performance</div>\r\n<h3 class=\"text-2xl font-bold text-gray-900 mb-4 mt-0\">Programa√ß√£o Ass√≠ncrona</h3>\r\n<h4 class=\"text-lg text-indigo-600 font-semibold mb-4\">\"Chega de Telas Brancas\"</h4>\r\n<p class=\"text-gray-600 mb-6 leading-relaxed text-sm\">\r\nTodos n√≥s j√° vimos isso: o aplicativo fica branco e diz \"N√£o Respondendo\" enquanto executa uma consulta. Isso √© c√≥digo \"Bloqueante\".\r\n<br/><br/>\r\n<strong>Async</strong> permite que a UI continue respondendo enquanto o banco de dados trabalha em segundo plano. Parece m√°gica para o usu√°rio, mas √© apenas um agendamento eficiente de recursos.\r\n</p>\r\n</div>\r\n</section>\r\n\r\n</main>\r\n\r\n<footer class=\"bg-gray-900 text-white py-10 mt-12\">\r\n<div class=\"max-w-7xl mx-auto px-6 text-center\">\r\n<h2 class=\"text-2xl font-bold mb-4 text-white\">Pronto para Modernizar?</h2>\r\n<div class=\"flex flex-col md:flex-row justify-center items-center gap-4 mb-8\">\r\n<a href=\"https://github.com/cesarliws/dext/tree/main/Docs/Book\" class=\"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-6 rounded-full transition duration-300 no-underline text-xs\">Ler a Doc (EN)</a>\r\n<a href=\"https://github.com/cesarliws/dext/tree/main/Docs/Book.pt-br\" class=\"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-6 rounded-full transition duration-300 no-underline text-xs\">Ler a Doc (PT)</a>\r\n<a href=\"https://www.cesarromero.com.br/articles/\" class=\"border border-gray-600 hover:border-gray-400 text-gray-300 hover:text-white font-bold py-2 px-6 rounded-full transition duration-300 no-underline text-xs\">Ver Outros Artigos</a>\r\n</div>\r\n<p class=\"text-gray-500 text-[10px]\">Desenvolvido para a comunidade do Dext Framework.</p>\r\n</div>\r\n</footer>\r\n</div>\r\n\r\n<script dangerouslySetInnerHTML={{ __html: `\r\n(function() {\r\n    let attempts = 0;\r\n    function renderCharts() {\r\n        if (typeof Chart === 'undefined' || !document.getElementById('diChart')) {\r\n            if (attempts < 50) { attempts++; setTimeout(renderCharts, 200); }\r\n            return;\r\n        }\r\n        function splitLabel(s) {\r\n            if (s.length <= 16) return s;\r\n            const w = s.split(' ');\r\n            const l = []; let c = w[0];\r\n            for (let i = 1; i < w.length; i++) {\r\n                if ((c + \" \" + w[i]).length < 16) { c += \" \" + w[i]; }\r\n                else { l.push(c); c = w[i]; }\r\n            }\r\n            l.push(c); return l;\r\n        }\r\n        Chart.defaults.font.family = \"'Inter', sans-serif\";\r\n        Chart.defaults.color = '#4B5563';\r\n        Chart.defaults.responsive = true;\r\n        Chart.defaults.maintainAspectRatio = false;\r\n        new Chart(document.getElementById('diChart'), {\r\n            type: 'bar',\r\n            data: {\r\n                labels: [splitLabel('Tradicional (TForm)'), splitLabel('Moderno (Dext DI)')],\r\n                datasets: [\r\n                    { label: 'Acoplamento', data: [85, 15], backgroundColor: '#F97316', borderRadius: 4 },\r\n                    { label: 'Flexibilidade', data: [15, 85], backgroundColor: '#4F46E5', borderRadius: 4 }\r\n                ]\r\n            },\r\n            options: { plugins: { legend: { position: 'bottom' } }, scales: { x: { stacked: true }, y: { stacked: true, max: 100 } } }\r\n        });\r\n        new Chart(document.getElementById('fluentChart'), {\r\n            type: 'bar', indexAxis: 'y',\r\n            data: {\r\n                labels: [splitLabel('Tradicional'), splitLabel('Fluente')],\r\n                datasets: [{ label: 'Linhas', data: [12, 4], backgroundColor: '#06B6D4' }]\r\n            },\r\n            options: { plugins: { legend: { display: false } } }\r\n        });\r\n        new Chart(document.getElementById('apiChart'), {\r\n            type: 'doughnut',\r\n            data: {\r\n                labels: ['Windows', 'Mobile', 'Web', 'API'],\r\n                datasets: [{ data: [25, 25, 25, 25], backgroundColor: ['#4F46E5', '#06B6D4', '#F97316', '#10B981'] }]\r\n            },\r\n            options: { plugins: { legend: { position: 'right' } } }\r\n        });\r\n        new Chart(document.getElementById('asyncChart'), {\r\n            type: 'line',\r\n            data: {\r\n                labels: ['1', '2', '3', '4', '5'],\r\n                datasets: [\r\n                    { label: 'Bloqueante', data: [60, 0, 0, 0, 60], borderColor: '#EF4444', fill: false },\r\n                    { label: 'Ass√≠ncrono', data: [60, 58, 59, 60, 60], borderColor: '#10B981', fill: false }\r\n                ]\r\n            },\r\n            options: { plugins: { title: { display: true, text: 'FPS' } } }\r\n        });\r\n    }\r\n    renderCharts();\r\n    document.addEventListener('astro:page-load', renderCharts);\r\n})();\r\n` }} />\r\n</div>","src/content/docs/articles/modern-delphi-concepts.mdx","e0fbf104c1ebf3f4","books",{id:111,data:113,body:119,filePath:120,digest:121,rendered:122},{title:114,description:115,editUrl:16,head:116,template:50,sidebar:117,pagefind:16,draft:37},"Livros Publicados","Meus livros sobre Delphi e Engenharia de Software.",[],{hidden:37,attrs:118},{},"## Delphi Threads e Paralelismo\r\n\r\nExplore o mundo da programa√ß√£o ass√≠ncrona.\r\n\r\n## Design Patterns em Delphi\r\n\r\nComo aplicar padr√µes modernos na linguagem.","src/content/docs/books/index.md","334fac69cdb07743",{html:123,metadata:124},"<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"delphi-threads-e-paralelismo\">Delphi Threads e Paralelismo</h2><a class=\"sl-anchor-link\" href=\"#delphi-threads-e-paralelismo\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúDelphi Threads e Paralelismo‚Äù</span></a></div>\n<p>Explore o mundo da programa√ß√£o ass√≠ncrona.</p>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"design-patterns-em-delphi\">Design Patterns em Delphi</h2><a class=\"sl-anchor-link\" href=\"#design-patterns-em-delphi\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúDesign Patterns em Delphi‚Äù</span></a></div>\n<p>Como aplicar padr√µes modernos na linguagem.</p>",{headings:125,localImagePaths:132,remoteImagePaths:133,frontmatter:134,imagePaths:135},[126,129],{depth:66,slug:127,text:128},"delphi-threads-e-paralelismo","Delphi Threads e Paralelismo",{depth:66,slug:130,text:131},"design-patterns-em-delphi","Design Patterns em Delphi",[],[],{title:114,description:115},[],"articles",{id:136,data:138,body:144,filePath:145,digest:146,rendered:147},{title:139,description:140,editUrl:16,head:141,template:50,sidebar:142,pagefind:16,draft:37},"Artigos T√©cnicos","Explore nossa cole√ß√£o de artigos sobre Delphi, Arquitetura e Performance.",[],{hidden:37,attrs:143},{},"Bem-vindo √† se√ß√£o de artigos. Aqui voc√™ encontrar√° conte√∫do aprofundado sobre desenvolvimento de software.\r\n\r\n## Destaques\r\n\r\n- **[Desenvolvimento Delphi Moderno: Conceitos do Dext Framework](/articles/modern-delphi-concepts)** (Novo!)\r\n- [Delphi Multithreading Moderno: Escreva C√≥digo Ass√≠ncrono Limpo](/articles/delphi-async-fluent)\r\n- [Enterprise Patterns com Dext: Domain Model & CQRS](/articles/enterprise-patterns-delphi)\r\n\r\n## Todos os Artigos\r\n\r\n- [Desenvolvimento Delphi Moderno: Conceitos do Dext Framework](/articles/modern-delphi-concepts)\r\n- [A Evolu√ß√£o do Dext: Da Funda√ß√£o √† Maturidade](/articles/dext-story)\r\n- [Database as API: Zero Complexidade](/articles/database-as-api-cqrs)\r\n- [Enterprise Patterns com Dext: Domain Model & CQRS](/articles/enterprise-patterns-delphi)\r\n- [Delphi Multithreading Moderno: Escreva C√≥digo Ass√≠ncrono Limpo](/articles/delphi-async-fluent)\r\n\r\nConfira o menu lateral para navegar por todos os t√≥picos dispon√≠veis.","src/content/docs/articles/index.md","fb91f531a91a43aa",{html:148,metadata:149},"<p>Bem-vindo √† se√ß√£o de artigos. Aqui voc√™ encontrar√° conte√∫do aprofundado sobre desenvolvimento de software.</p>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"destaques\">Destaques</h2><a class=\"sl-anchor-link\" href=\"#destaques\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúDestaques‚Äù</span></a></div>\n<ul>\n<li><strong><a href=\"/articles/modern-delphi-concepts\">Desenvolvimento Delphi Moderno: Conceitos do Dext Framework</a></strong> (Novo!)</li>\n<li><a href=\"/articles/delphi-async-fluent\">Delphi Multithreading Moderno: Escreva C√≥digo Ass√≠ncrono Limpo</a></li>\n<li><a href=\"/articles/enterprise-patterns-delphi\">Enterprise Patterns com Dext: Domain Model &#x26; CQRS</a></li>\n</ul>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"todos-os-artigos\">Todos os Artigos</h2><a class=\"sl-anchor-link\" href=\"#todos-os-artigos\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúTodos os Artigos‚Äù</span></a></div>\n<ul>\n<li><a href=\"/articles/modern-delphi-concepts\">Desenvolvimento Delphi Moderno: Conceitos do Dext Framework</a></li>\n<li><a href=\"/articles/dext-story\">A Evolu√ß√£o do Dext: Da Funda√ß√£o √† Maturidade</a></li>\n<li><a href=\"/articles/database-as-api-cqrs\">Database as API: Zero Complexidade</a></li>\n<li><a href=\"/articles/enterprise-patterns-delphi\">Enterprise Patterns com Dext: Domain Model &#x26; CQRS</a></li>\n<li><a href=\"/articles/delphi-async-fluent\">Delphi Multithreading Moderno: Escreva C√≥digo Ass√≠ncrono Limpo</a></li>\n</ul>\n<p>Confira o menu lateral para navegar por todos os t√≥picos dispon√≠veis.</p>",{headings:150,localImagePaths:157,remoteImagePaths:158,frontmatter:159,imagePaths:160},[151,154],{depth:66,slug:152,text:153},"destaques","Destaques",{depth:66,slug:155,text:156},"todos-os-artigos","Todos os Artigos",[],[],{title:139,description:140},[],"en/articles/modern-delphi-concepts",{id:161,data:163,body:169,filePath:170,digest:171,deferredRender:16},{title:164,description:165,editUrl:16,head:166,template:50,sidebar:167,pagefind:16,draft:37},"Modern Delphi Development: Dext Framework Concepts","Demystifying the Dext Framework for the Traditional Developer: Dependency Injection, Fluent API, Code-First, and more.",[],{hidden:37,attrs:168},{},"<div class=\"not-prose\">\r\n<script src=\"https://cdn.tailwindcss.com\"></script>\r\n<script src=\"https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js\"></script>\r\n\r\n<div class=\"text-gray-800 bg-gray-50 rounded-xl overflow-hidden shadow-sm\">\r\n<header class=\"bg-gradient-to-r from-indigo-800 to-indigo-600 text-white p-8 md:p-12 shadow-md\">\r\n<div class=\"max-w-7xl mx-auto text-center\">\r\n<h1 class=\"text-4xl md:text-5xl font-extrabold tracking-tight mb-4 text-white\">\r\nModernizing Delphi\r\n</h1>\r\n<p class=\"text-lg md:text-xl font-light text-indigo-100 mb-8\">\r\nDemystifying the Dext Framework for the Traditional Developer\r\n</p>\r\n<div class=\"grid grid-cols-1 md:grid-cols-3 gap-6 text-center mt-8\">\r\n<div class=\"bg-indigo-900 bg-opacity-30 p-4 rounded-lg backdrop-blur-sm border border-indigo-400\">\r\n<span class=\"block text-2xl font-bold text-cyan-400\">RAD</span>\r\n<span class=\"text-sm text-indigo-200\">The Roots</span>\r\n</div>\r\n<div class=\"flex items-center justify-center text-3xl text-white opacity-50\">\r\n‚ûú\r\n</div>\r\n<div class=\"bg-indigo-900 bg-opacity-30 p-4 rounded-lg backdrop-blur-sm border border-indigo-400\">\r\n<span class=\"block text-2xl font-bold text-orange-400\">DEXT</span>\r\n<span class=\"text-sm text-indigo-200\">The Future</span>\r\n</div>\r\n</div>\r\n</div>\r\n</header>\r\n\r\n<section class=\"max-w-5xl mx-auto py-8 px-6\">\r\n<div class=\"bg-white rounded-xl shadow-sm p-6 border-l-8 border-indigo-600\">\r\n<h2 class=\"text-xl font-bold text-indigo-900 mb-4 mt-0\">Why Change What Works?</h2>\r\n<p class=\"text-base leading-relaxed text-gray-600\">\r\nYou've built robust systems with TForm and TDataSet for years. But as requirements grow (Mobile, Web, Cloud), the \"Old Way\" of tightly coupling logic to visual forms becomes a bottleneck. The Dext Framework introduces proven global patterns to Delphi. These aren't new languages‚Äîthey are just a new grammar for the language you already love.\r\n</p>\r\n</div>\r\n</section>\r\n\r\n<main class=\"max-w-7xl mx-auto px-6 py-4 grid grid-cols-1 gap-12\">\r\n\r\n<section class=\"grid grid-cols-1 md:grid-cols-2 gap-8 items-center bg-white rounded-2xl shadow-md overflow-hidden border border-gray-100\">\r\n<div class=\"p-6 md:p-8\">\r\n<div class=\"inline-block bg-orange-100 text-orange-600 font-bold px-3 py-1 rounded-full text-xs mb-4\">Core Concept</div>\r\n<h3 class=\"text-2xl font-bold text-gray-900 mb-4 mt-0\">Dependency Injection (DI)</h3>\r\n<h4 class=\"text-lg text-indigo-600 font-semibold mb-4\">\"The Car Battery Analogy\"</h4>\r\n<p class=\"text-gray-600 mb-6 leading-relaxed text-sm\">\r\nThink of your code like a car. In the old days (tight coupling), you welded the battery directly to the engine block. To change the battery, you had to cut the car open. \r\n<br/><br/>\r\n<strong>Dependency Injection</strong> is simply adding a \"battery slot\" (Interface). You can slide in a **Bosch**, a **Varta**, or an **ACDelco** (Implementation), as long as it fits the slot.\r\n</p>\r\n</div>\r\n<div class=\"bg-gray-50 p-6 flex flex-col justify-center items-center h-full border-l border-gray-100 min-h-[300px]\">\r\n<h5 class=\"text-center font-bold text-gray-700 mb-4 text-sm\">System Modularity Comparison</h5>\r\n<div class=\"relative w-full h-[200px]\">\r\n<canvas id=\"diChart\"></canvas>\r\n</div>\r\n<p class=\"text-center text-xs text-gray-500 mt-4 italic\">\r\nDI reduces \"Spaghetti Code\" (Coupling) and increases the ease of testing.\r\n</p>\r\n</div>\r\n</section>\r\n\r\n<section class=\"grid grid-cols-1 gap-8 items-center bg-white rounded-2xl shadow-md overflow-hidden p-6 border border-gray-100\">\r\n<div class=\"text-center max-w-3xl mx-auto\">\r\n<div class=\"inline-block bg-cyan-100 text-cyan-700 font-bold px-3 py-1 rounded-full text-xs mb-4\">Database Architecture</div>\r\n<h3 class=\"text-2xl font-bold text-gray-900 mb-4 mt-0\">Code-First Development</h3>\r\n<p class=\"text-gray-600 mb-4 leading-relaxed text-sm\">\r\nStop manually writing `CREATE TABLE` scripts. With Code-First, your Delphi Classes <strong>are</strong> the master definition. You define a property, and Dext updates the database schema automatically. It keeps your code and data perfectly synchronized.\r\n</p>\r\n</div>\r\n\r\n<div class=\"flex flex-col md:flex-row justify-center items-center gap-4 w-full py-6 bg-slate-50 rounded-xl border border-slate-200 px-4\">\r\n<div class=\"bg-white p-4 rounded-lg shadow-sm border-t-4 border-indigo-500 w-full md:w-56 overflow-hidden\">\r\n<h4 class=\"font-bold text-gray-800 text-xs mb-2 text-center uppercase tracking-wider\">Delphi Class</h4>\r\n<div class=\"bg-slate-900 rounded p-2 text-[10px] font-mono leading-tight text-indigo-300\">\r\n<span class=\"text-purple-400\">type</span> TUser = <span class=\"text-purple-400\">class</span><br/>\r\n&nbsp;&nbsp;[Column] Name: <span class=\"text-blue-300\">string</span>;<br/>\r\n<span class=\"text-purple-400\">end</span>;\r\n</div>\r\n</div>\r\n<div class=\"text-2xl text-gray-400 rotate-90 md:rotate-0\">‚ûú</div>\r\n<div class=\"bg-indigo-600 p-4 rounded-lg shadow-sm w-full md:w-56 text-center text-white\">\r\n<div class=\"text-3xl mb-2\">‚öôÔ∏è</div>\r\n<h4 class=\"font-bold text-xs uppercase tracking-wider\">Dext Engine</h4>\r\n<p class=\"text-[10px] text-indigo-200 mt-2\">\r\nAutomatic Mapping<br/>\r\n& Migration Logic\r\n</p>\r\n</div>\r\n<div class=\"text-2xl text-gray-400 rotate-90 md:rotate-0\">‚ûú</div>\r\n<div class=\"bg-white p-4 rounded-lg shadow-sm border-t-4 border-cyan-500 w-full md:w-56 overflow-hidden\">\r\n<h4 class=\"font-bold text-gray-800 text-xs mb-2 text-center uppercase tracking-wider\">SQL Database</h4>\r\n<div class=\"bg-slate-900 rounded p-2 text-[10px] font-mono leading-tight text-cyan-300\">\r\n<span class=\"text-purple-400\">CREATE TABLE</span> Users (<br/>\r\n&nbsp;&nbsp;Name <span class=\"text-blue-300\">VARCHAR</span>(255)<br/>\r\n);\r\n</div>\r\n</div>\r\n</div>\r\n</section>\r\n\r\n<section class=\"grid grid-cols-1 md:grid-cols-2 gap-8 items-center bg-white rounded-2xl shadow-md overflow-hidden border border-gray-100\">\r\n<div class=\"bg-gray-50 p-6 flex flex-col justify-center items-center h-full border-r border-gray-100 order-2 md:order-1 min-h-[300px]\">\r\n<h5 class=\"text-center font-bold text-gray-700 mb-4 text-sm\">Code Clarity & Brevity</h5>\r\n<div class=\"relative w-full h-[200px]\">\r\n<canvas id=\"fluentChart\"></canvas>\r\n</div>\r\n</div>\r\n<div class=\"p-6 md:p-8 order-1 md:order-2\">\r\n<div class=\"inline-block bg-purple-100 text-purple-600 font-bold px-3 py-1 rounded-full text-xs mb-4\">Coding Style</div>\r\n<h3 class=\"text-2xl font-bold text-gray-900 mb-4 mt-0\">Fluent API</h3>\r\n<h4 class=\"text-lg text-indigo-600 font-semibold mb-4\">\"Code that Tells a Story\"</h4>\r\n<p class=\"text-gray-600 mb-6 leading-relaxed text-sm\">\r\nFluent API is just a way to chain calls to read like a sentence. It is syntactic sugar to make code more readable, resembling a sentence rather than a series of commands.\r\n</p>\r\n<div class=\"bg-gray-900 p-4 rounded-lg font-mono text-xs text-indigo-300 shadow-inner\">\r\n<p class=\"text-gray-500 mb-2 border-b border-gray-800 pb-1 italic text-[10px]\">// Traditional</p>\r\n<p>Query.SQL.Text := '...';</p>\r\n<p>Query.Open;</p>\r\n<p>Query.First;</p>\r\n<p class=\"text-gray-500 my-2 border-b border-gray-800 pb-1 italic text-[10px]\">// In Dext</p>\r\n<p class=\"text-white\">Query.From('Users').Where('Id', 1).Open();</p>\r\n</div>\r\n</div>\r\n</section>\r\n\r\n<section class=\"grid grid-cols-1 md:grid-cols-2 gap-8 items-center bg-white rounded-2xl shadow-md overflow-hidden border border-gray-100\">\r\n<div class=\"p-6 md:p-8\">\r\n<div class=\"inline-block bg-green-100 text-green-600 font-bold px-3 py-1 rounded-full text-xs mb-4\">Architecture</div>\r\n<h3 class=\"text-2xl font-bold text-gray-900 mb-4 mt-0\">Web API</h3>\r\n<h4 class=\"text-lg text-indigo-600 font-semibold mb-4\">\"Your EXE in the Cloud\"</h4>\r\n<p class=\"text-gray-600 mb-6 leading-relaxed text-sm\">\r\nA traditional Delphi App traps business logic inside a Windows Form. A <strong>Web API</strong> is just a function that returns data (JSON) instead of opening a window.\r\n<br/><br/>\r\nBy moving logic to an API, your single Delphi codebase can now power a React website, an iPhone app, and a 3rd party integration simultaneously.\r\n</p>\r\n</div>\r\n<div class=\"bg-gray-50 p-6 flex flex-col justify-center items-center h-full border-l border-gray-100 min-h-[300px]\">\r\n<h5 class=\"text-center font-bold text-gray-700 mb-4 text-sm\">Client Reach Potential</h5>\r\n<div class=\"relative w-full h-[200px]\">\r\n<canvas id=\"apiChart\"></canvas>\r\n</div>\r\n<p class=\"text-center text-xs text-gray-500 mt-4 italic\">\r\nUnlock 100% of the digital ecosystem, not just Windows Desktop.\r\n</p>\r\n</div>\r\n</section>\r\n\r\n<section class=\"grid grid-cols-1 md:grid-cols-2 gap-8 items-center bg-white rounded-2xl shadow-md overflow-hidden border border-gray-100\">\r\n<div class=\"bg-gray-50 p-6 flex flex-col justify-center items-center h-full border-r border-gray-100 order-2 md:order-1 min-h-[300px]\">\r\n<h5 class=\"text-center font-bold text-gray-700 mb-4 text-sm\">UI Responsiveness (FPS)</h5>\r\n<div class=\"relative w-full h-[200px]\">\r\n<canvas id=\"asyncChart\"></canvas>\r\n</div>\r\n</div>\r\n<div class=\"p-6 md:p-8 order-1 md:order-2\">\r\n<div class=\"inline-block bg-red-100 text-red-600 font-bold px-3 py-1 rounded-full text-xs mb-4\">Performance</div>\r\n<h3 class=\"text-2xl font-bold text-gray-900 mb-4 mt-0\">Asynchronous Programming</h3>\r\n<h4 class=\"text-lg text-indigo-600 font-semibold mb-4\">\"No More White Screens\"</h4>\r\n<p class=\"text-gray-600 mb-6 leading-relaxed text-sm\">\r\nWe've all seen it: the application turns white and says \"Not Responding\" while running a query. That's \"Blocking\" code.\r\n<br/><br/>\r\n<strong>Async</strong> allows the UI to keep drawing and responding to mouse clicks while the database works in the background. It feels magical to the user, but it's just efficient resource scheduling.\r\n</p>\r\n</div>\r\n</section>\r\n\r\n</main>\r\n\r\n<footer class=\"bg-gray-900 text-white py-10 mt-12\">\r\n<div class=\"max-w-7xl mx-auto px-6 text-center\">\r\n<h2 class=\"text-2xl font-bold mb-4 text-white\">Ready to Modernize?</h2>\r\n<div class=\"flex flex-col md:flex-row justify-center items-center gap-4 mb-8\">\r\n<a href=\"https://github.com/cesarliws/dext/tree/main/Docs/Book\" class=\"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-6 rounded-full transition duration-300 no-underline text-xs\">Read The Docs (EN)</a>\r\n<a href=\"https://github.com/cesarliws/dext/tree/main/Docs/Book.pt-br\" class=\"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-6 rounded-full transition duration-300 no-underline text-xs\">Read The Docs (PT)</a>\r\n<a href=\"https://www.cesarromero.com.br/articles/\" class=\"border border-gray-600 hover:border-gray-400 text-gray-300 hover:text-white font-bold py-2 px-6 rounded-full transition duration-300 no-underline text-xs\">View Blog Articles</a>\r\n</div>\r\n<p class=\"text-gray-500 text-[10px]\">Designed for the Dext Framework Community.</p>\r\n</div>\r\n</footer>\r\n</div>\r\n\r\n<script dangerouslySetInnerHTML={{ __html: `\r\n(function() {\r\n    let attempts = 0;\r\n    function renderCharts() {\r\n        if (typeof Chart === 'undefined' || !document.getElementById('diChart')) {\r\n            if (attempts < 50) { attempts++; setTimeout(renderCharts, 200); }\r\n            return;\r\n        }\r\n        function splitLabel(s) {\r\n            if (s.length <= 16) return s;\r\n            const w = s.split(' ');\r\n            const l = []; let c = w[0];\r\n            for (let i = 1; i < w.length; i++) {\r\n                if ((c + \" \" + w[i]).length < 16) { c += \" \" + w[i]; }\r\n                else { l.push(c); c = w[i]; }\r\n            }\r\n            l.push(c); return l;\r\n        }\r\n        Chart.defaults.font.family = \"'Inter', sans-serif\";\r\n        Chart.defaults.color = '#4B5563';\r\n        Chart.defaults.responsive = true;\r\n        Chart.defaults.maintainAspectRatio = false;\r\n        new Chart(document.getElementById('diChart'), {\r\n            type: 'bar',\r\n            data: {\r\n                labels: [splitLabel('Traditional (TForm)'), splitLabel('Modern (Dext DI)')],\r\n                datasets: [\r\n                    { label: 'Coupling', data: [85, 15], backgroundColor: '#F97316', borderRadius: 4 },\r\n                    { label: 'Flexibility', data: [15, 85], backgroundColor: '#4F46E5', borderRadius: 4 }\r\n                ]\r\n            },\r\n            options: { plugins: { legend: { position: 'bottom' } }, scales: { x: { stacked: true }, y: { stacked: true, max: 100 } } }\r\n        });\r\n        new Chart(document.getElementById('fluentChart'), {\r\n            type: 'bar', indexAxis: 'y',\r\n            data: {\r\n                labels: [splitLabel('Traditional'), splitLabel('Fluent')],\r\n                datasets: [{ label: 'Lines', data: [12, 4], backgroundColor: '#06B6D4' }]\r\n            },\r\n            options: { plugins: { legend: { display: false } } }\r\n        });\r\n        new Chart(document.getElementById('apiChart'), {\r\n            type: 'doughnut',\r\n            data: {\r\n                labels: ['Windows', 'Mobile', 'Web', 'API'],\r\n                datasets: [{ data: [25, 25, 25, 25], backgroundColor: ['#4F46E5', '#06B6D4', '#F97316', '#10B981'] }]\r\n            },\r\n            options: { plugins: { legend: { position: 'right' } } }\r\n        });\r\n        new Chart(document.getElementById('asyncChart'), {\r\n            type: 'line',\r\n            data: {\r\n                labels: ['1', '2', '3', '4', '5'],\r\n                datasets: [\r\n                    { label: 'Blocking', data: [60, 0, 0, 0, 60], borderColor: '#EF4444', fill: false },\r\n                    { label: 'Asynchronous', data: [60, 58, 59, 60, 60], borderColor: '#10B981', fill: false }\r\n                ]\r\n            },\r\n            options: { plugins: { title: { display: true, text: 'FPS' } } }\r\n        });\r\n    }\r\n    renderCharts();\r\n    document.addEventListener('astro:page-load', renderCharts);\r\n})();\r\n` }} />\r\n</div>","src/content/docs/en/articles/modern-delphi-concepts.mdx","f62a782a745bf836","es/articles/modern-delphi-concepts",{id:172,data:174,body:180,filePath:181,digest:182,deferredRender:16},{title:175,description:176,editUrl:16,head:177,template:50,sidebar:178,pagefind:16,draft:37},"Desarrollo Delphi Moderno: Conceptos de Dext Framework","Desmitificando el Dext Framework para el desarrollador tradicional: Inyecci√≥n de Dependencia, API Fluida, Code-First y m√°s.",[],{hidden:37,attrs:179},{},"<div class=\"not-prose\">\r\n<script src=\"https://cdn.tailwindcss.com\"></script>\r\n<script src=\"https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js\"></script>\r\n\r\n<div class=\"text-gray-800 bg-gray-50 rounded-xl overflow-hidden shadow-sm\">\r\n<header class=\"bg-gradient-to-r from-indigo-800 to-indigo-600 text-white p-8 md:p-12 shadow-md\">\r\n<div class=\"max-w-7xl mx-auto text-center\">\r\n<h1 class=\"text-4xl md:text-5xl font-extrabold tracking-tight mb-4 text-white\">\r\nModernizando Delphi\r\n</h1>\r\n<p class=\"text-lg md:text-xl font-light text-indigo-100 mb-8\">\r\nDesmitificando el Dext Framework para el Desarrollador Tradicional\r\n</p>\r\n<div class=\"grid grid-cols-1 md:grid-cols-3 gap-6 text-center mt-8\">\r\n<div class=\"bg-indigo-900 bg-opacity-30 p-4 rounded-lg backdrop-blur-sm border border-indigo-400\">\r\n<span class=\"block text-2xl font-bold text-cyan-400\">RAD</span>\r\n<span class=\"text-sm text-indigo-200\">Las Ra√≠ces</span>\r\n</div>\r\n<div class=\"flex items-center justify-center text-3xl text-white opacity-50\">\r\n‚ûú\r\n</div>\r\n<div class=\"bg-indigo-900 bg-opacity-30 p-4 rounded-lg backdrop-blur-sm border border-indigo-400\">\r\n<span class=\"block text-2xl font-bold text-orange-400\">DEXT</span>\r\n<span class=\"text-sm text-indigo-200\">El Futuro</span>\r\n</div>\r\n</div>\r\n</div>\r\n</header>\r\n\r\n<section class=\"max-w-5xl mx-auto py-8 px-6\">\r\n<div class=\"bg-white rounded-xl shadow-sm p-6 border-l-8 border-indigo-600\">\r\n<h2 class=\"text-xl font-bold text-indigo-900 mb-4 mt-0\">¬øPor qu√© cambiar lo que funciona?</h2>\r\n<p class=\"text-base leading-relaxed text-gray-600\">\r\nUsted ha construido sistemas robustos con TForm e TDataSet por a√±os. Pero a medida que los requisitos crescen (M√≥vil, Web, Nube), la \"vieja manera\" de acoplar fuertemente la l√≥gica a los formularios visuales se convierte en um cuello de botella. El Dext Framework introduce patrones globales probados a Delphi. No son nuevos lenguajes ‚Äî es solo una nueva gram√°tica para el lenguaje que ya ama.\r\n</p>\r\n</div>\r\n</section>\r\n\r\n<main class=\"max-w-7xl mx-auto px-6 py-4 grid grid-cols-1 gap-12\">\r\n\r\n<section class=\"grid grid-cols-1 md:grid-cols-2 gap-8 items-center bg-white rounded-2xl shadow-md overflow-hidden border border-gray-100\">\r\n<div class=\"p-6 md:p-8\">\r\n<div class=\"inline-block bg-orange-100 text-orange-600 font-bold px-3 py-1 rounded-full text-xs mb-4\">Concepto Core</div>\r\n<h3 class=\"text-2xl font-bold text-gray-900 mb-4 mt-0\">Inyecci√≥n de Dependencia (DI)</h3>\r\n<h4 class=\"text-lg text-indigo-600 font-semibold mb-4\">\"La Analog√≠a de la Bater√≠a del Coche\"</h4>\r\n<p class=\"text-gray-600 mb-6 leading-relaxed text-sm\">\r\nPience en su c√≥digo como un coche. Antiguamente (acoplamiento fuerte), usted soldaba la bater√≠a directamente al bloque del motor. Para cambiar la bater√≠a, hab√≠a que cortar el coche. \r\n<br/><br/>\r\n<strong>Inyecci√≥n de Dependencia</strong> es simplemente a√±adir un \"slot de bater√≠a\" (Interface). Puede deslizar una **Bosch**, una **Varta** o una **ACDelco** (Implementaci√≥n), siempre que quepa en el slot.\r\n</p>\r\n</div>\r\n<div class=\"bg-gray-50 p-6 flex flex-col justify-center items-center h-full border-l border-gray-100 min-h-[300px]\">\r\n<h5 class=\"text-center font-bold text-gray-700 mb-4 text-sm\">Comparaci√≥n de Modularidade do Sistema</h5>\r\n<div class=\"relative w-full h-[200px]\">\r\n<canvas id=\"diChart\"></canvas>\r\n</div>\r\n<p class=\"text-center text-xs text-gray-500 mt-4 italic\">\r\nDI reduce el \"C√≥digo Espagueti\" (Acoplamiento) y aumenta la facilidad de pruebas.\r\n</p>\r\n</div>\r\n</section>\r\n\r\n<section class=\"grid grid-cols-1 gap-8 items-center bg-white rounded-2xl shadow-md overflow-hidden p-6 border border-gray-100\">\r\n<div class=\"text-center max-w-3xl mx-auto\">\r\n<div class=\"inline-block bg-cyan-100 text-cyan-700 font-bold px-3 py-1 rounded-full text-xs mb-4\">Arquitectura de Base de Datos</div>\r\n<h3 class=\"text-2xl font-bold text-gray-900 mb-4 mt-0\">Desarrollo Code-First</h3>\r\n<p class=\"text-gray-600 mb-4 leading-relaxed text-sm\">\r\nDeje de escribir scripts `CREATE TABLE` manualmente. Con Code-First, sus clases Delphi <strong>son</strong> la definici√≥n maestra. Usted define una propiedad, y Dext actualiza el esquema de la base de datos autom√°ticamente. Mantiene su c√≥digo y datos perfectamente sincronizados.\r\n</p>\r\n</div>\r\n\r\n<div class=\"flex flex-col md:flex-row justify-center items-center gap-4 w-full py-6 bg-slate-50 rounded-xl border border-slate-200 px-4\">\r\n<div class=\"bg-white p-4 rounded-lg shadow-sm border-t-4 border-indigo-500 w-full md:w-56 overflow-hidden\">\r\n<h4 class=\"font-bold text-gray-800 text-xs mb-2 text-center uppercase tracking-wider\">Clase Delphi</h4>\r\n<div class=\"bg-slate-900 rounded p-2 text-[10px] font-mono leading-tight text-indigo-300\">\r\n<span class=\"text-purple-400\">type</span> TUser = <span class=\"text-purple-400\">class</span><br/>\r\n&nbsp;&nbsp;[Column] Name: <span class=\"text-blue-300\">string</span>;<br/>\r\n<span class=\"text-purple-400\">end</span>;\r\n</div>\r\n</div>\r\n<div class=\"text-2xl text-gray-400 rotate-90 md:rotate-0\">‚ûú</div>\r\n<div class=\"bg-indigo-600 p-4 rounded-lg shadow-sm w-full md:w-56 text-center text-white\">\r\n<div class=\"text-3xl mb-2\">‚öôÔ∏è</div>\r\n<h4 class=\"font-bold text-xs uppercase tracking-wider\">Motor Dext</h4>\r\n<p class=\"text-[10px] text-indigo-200 mt-2\">\r\nMapeo Autom√°tico<br/>\r\n& L√≥gica de Migraci√≥n\r\n</p>\r\n</div>\r\n<div class=\"text-2xl text-gray-400 rotate-90 md:rotate-0\">‚ûú</div>\r\n<div class=\"bg-white p-4 rounded-lg shadow-sm border-t-4 border-cyan-500 w-full md:w-56 overflow-hidden\">\r\n<h4 class=\"font-bold text-gray-800 text-xs mb-2 text-center uppercase tracking-wider\">Base SQL</h4>\r\n<div class=\"bg-slate-900 rounded p-2 text-[10px] font-mono leading-tight text-cyan-300\">\r\n<span class=\"text-purple-400\">CREATE TABLE</span> Users (<br/>\r\n&nbsp;&nbsp;Name <span class=\"text-blue-300\">VARCHAR</span>(255)<br/>\r\n);\r\n</div>\r\n</div>\r\n</div>\r\n</section>\r\n\r\n<section class=\"grid grid-cols-1 md:grid-cols-2 gap-8 items-center bg-white rounded-2xl shadow-md overflow-hidden border border-gray-100\">\r\n<div class=\"bg-gray-50 p-6 flex flex-col justify-center items-center h-full border-r border-gray-100 order-2 md:order-1 min-h-[300px]\">\r\n<h5 class=\"text-center font-bold text-gray-700 mb-4 text-sm\">Claridad y Brevedad del C√≥digo</h5>\r\n<div class=\"relative w-full h-[200px]\">\r\n<canvas id=\"fluentChart\"></canvas>\r\n</div>\r\n</div>\r\n<div class=\"p-6 md:p-8 order-1 md:order-2\">\r\n<div class=\"inline-block bg-purple-100 text-purple-600 font-bold px-3 py-1 rounded-full text-xs mb-4\">Estilo de Codificaci√≥n</div>\r\n<h3 class=\"text-2xl font-bold text-gray-900 mb-4 mt-0\">API Fluida</h3>\r\n<h4 class=\"text-lg text-indigo-600 font-semibold mb-4\">\"C√≥digo que cuenta una historia\"</h4>\r\n<p class=\"text-gray-600 mb-6 leading-relaxed text-sm\">\r\nAPI Fluida es solo una forma de encadenar llamadas para que se lean como una frase. Es az√∫car sint√°ctico para hacer el c√≥digo m√°s legible, pareci√©ndose a una oraci√≥n en lugar de una serie de comandos.\r\n</p>\r\n<div class=\"bg-gray-900 p-4 rounded-lg font-mono text-xs text-indigo-300 shadow-inner\">\r\n<p class=\"text-gray-500 mb-2 border-b border-gray-800 pb-1 italic text-[10px]\">// Tradicional</p>\r\n<p>Query.SQL.Text := '...';</p>\r\n<p>Query.Open;</p>\r\n<p>Query.First;</p>\r\n<p class=\"text-gray-500 my-2 border-b border-gray-800 pb-1 italic text-[10px]\">// En Dext</p>\r\n<p class=\"text-white\">Query.From('Users').Where('Id', 1).Open();</p>\r\n</div>\r\n</div>\r\n</section>\r\n\r\n<section class=\"grid grid-cols-1 md:grid-cols-2 gap-8 items-center bg-white rounded-2xl shadow-md overflow-hidden border border-gray-100\">\r\n<div class=\"p-6 md:p-8\">\r\n<div class=\"inline-block bg-green-100 text-green-600 font-bold px-3 py-1 rounded-full text-xs mb-4\">Arquitectura</div>\r\n<h3 class=\"text-2xl font-bold text-gray-900 mb-4 mt-0\">Web API</h3>\r\n<h4 class=\"text-lg text-indigo-600 font-semibold mb-4\">\"Su EXE en la Nube\"</h4>\r\n<p class=\"text-gray-600 mb-6 leading-relaxed text-sm\">\r\nUn app Delphi tradicional atrapa la l√≥gica dentro de um Formulario Windows. Una <strong>Web API</strong> es solo una funci√≥n que devuelve datos (JSON) en lugar de abrir una ventana.\r\n<br/><br/>\r\nAl mover la l√≥gica a una API, su √∫nico c√≥digo base Delphi puede ahora alimentar un sitio React, una app de iPhone y una integraci√≥n con terceros simult√°neamente.\r\n</p>\r\n</div>\r\n<div class=\"bg-gray-50 p-6 flex flex-col justify-center items-center h-full border-l border-gray-100 min-h-[300px]\">\r\n<h5 class=\"text-center font-bold text-gray-700 mb-4 text-sm\">Potencial de Alcance del Cliente</h5>\r\n<div class=\"relative w-full h-[200px]\">\r\n<canvas id=\"apiChart\"></canvas>\r\n</div>\r\n<p class=\"text-center text-xs text-gray-500 mt-4 italic\">\r\nDesbloquee el 100% del ecosistema digital, no solo Windows Desktop.\r\n</p>\r\n</div>\r\n</section>\r\n\r\n<section class=\"grid grid-cols-1 md:grid-cols-2 gap-8 items-center bg-white rounded-2xl shadow-md overflow-hidden border border-gray-100\">\r\n<div class=\"bg-gray-50 p-6 flex flex-col justify-center items-center h-full border-r border-gray-100 order-2 md:order-1 min-h-[300px]\">\r\n<h5 class=\"text-center font-bold text-gray-700 mb-4 text-sm\">Responsividade da UI (FPS)</h5>\r\n<div class=\"relative w-full h-[200px]\">\r\n<canvas id=\"asyncChart\"></canvas>\r\n</div>\r\n</div>\r\n<div class=\"p-6 md:p-8 order-1 md:order-2\">\r\n<div class=\"inline-block bg-red-100 text-red-600 font-bold px-3 py-1 rounded-full text-xs mb-4\">Performance</div>\r\n<h3 class=\"text-2xl font-bold text-gray-900 mb-4 mt-0\">Programa√ß√£o Ass√≠ncrona</h3>\r\n<h4 class=\"text-lg text-indigo-600 font-semibold mb-4\">\"No m√°s pantallas blancas\"</h4>\r\n<p class=\"text-gray-600 mb-6 leading-relaxed text-sm\">\r\nTodos hemos visto esto: la aplicaci√≥n se pone blanca y dice \"No responde\" mientras ejecuta una consulta. Eso es c√≥digo \"bloqueante\".\r\n<br/><br/>\r\n<strong>Async</strong> permite que la UI contin√∫e respondiendo mientras la base de datos trabaja en segundo plano. Parece magia para o usuario, mas √© apenas um agendamento eficiente de recursos.\r\n</p>\r\n</div>\r\n</section>\r\n\r\n</main>\r\n\r\n<footer class=\"bg-gray-900 text-white py-10 mt-12\">\r\n<div class=\"max-w-7xl mx-auto px-6 text-center\">\r\n<h2 class=\"text-2xl font-bold mb-4 text-white\">¬øListo para modernizar?</h2>\r\n<div class=\"flex flex-col md:flex-row justify-center items-center gap-4 mb-8\">\r\n<a href=\"https://github.com/cesarliws/dext/tree/main/Docs/Book\" class=\"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-6 rounded-full transition duration-300 no-underline text-xs\">Leer la Doc (EN)</a>\r\n<a href=\"https://github.com/cesarliws/dext/tree/main/Docs/Book.pt-br\" class=\"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-6 rounded-full transition duration-300 no-underline text-xs\">Leer la Doc (PT)</a>\r\n<a href=\"https://www.cesarromero.com.br/articles/\" class=\"border border-gray-600 hover:border-gray-400 text-gray-300 hover:text-white font-bold py-2 px-6 rounded-full transition duration-300 no-underline text-xs\">Ver Otros Art√≠culos</a>\r\n</div>\r\n<p class=\"text-gray-500 text-[10px]\">Dise√±ado para la comunidad de Dext Framework.</p>\r\n</div>\r\n</footer>\r\n</div>\r\n\r\n<script dangerouslySetInnerHTML={{ __html: `\r\n(function() {\r\n    let attempts = 0;\r\n    function renderCharts() {\r\n        if (typeof Chart === 'undefined' || !document.getElementById('diChart')) {\r\n            if (attempts < 50) { attempts++; setTimeout(renderCharts, 200); }\r\n            return;\r\n        }\r\n        function splitLabel(s) {\r\n            if (s.length <= 16) return s;\r\n            const w = s.split(' ');\r\n            const l = []; let c = w[0];\r\n            for (let i = 1; i < w.length; i++) {\r\n                if ((c + \" \" + w[i]).length < 16) { c += \" \" + w[i]; }\r\n                else { l.push(c); c = w[i]; }\r\n            }\r\n            l.push(c); return l;\r\n        }\r\n        Chart.defaults.font.family = \"'Inter', sans-serif\";\r\n        Chart.defaults.color = '#4B5563';\r\n        Chart.defaults.responsive = true;\r\n        Chart.defaults.maintainAspectRatio = false;\r\n        new Chart(document.getElementById('diChart'), {\r\n            type: 'bar',\r\n            data: {\r\n                labels: [splitLabel('Tradicional (TForm)'), splitLabel('Moderno (Dext DI)')],\r\n                datasets: [\r\n                    { label: 'Acoplamiento', data: [85, 15], backgroundColor: '#F97316', borderRadius: 4 },\r\n                    { label: 'Flexibilidad', data: [15, 85], backgroundColor: '#4F46E5', borderRadius: 4 }\r\n                ]\r\n            },\r\n            options: { plugins: { legend: { position: 'bottom' } }, scales: { x: { stacked: true }, y: { stacked: true, max: 100 } } }\r\n        });\r\n        new Chart(document.getElementById('fluentChart'), {\r\n            type: 'bar', indexAxis: 'y',\r\n            data: {\r\n                labels: [splitLabel('Tradicional'), splitLabel('Fluido')],\r\n                datasets: [{ label: 'L√≠neas', data: [12, 4], backgroundColor: '#06B6D4' }]\r\n            },\r\n            options: { plugins: { legend: { display: false } } }\r\n        });\r\n        new Chart(document.getElementById('apiChart'), {\r\n            type: 'doughnut',\r\n            data: {\r\n                labels: ['Windows', 'Mobile', 'Web', 'API'],\r\n                datasets: [{ data: [25, 25, 25, 25], backgroundColor: ['#4F46E5', '#06B6D4', '#F97316', '#10B981'] }]\r\n            },\r\n            options: { plugins: { legend: { position: 'right' } } }\r\n        });\r\n        new Chart(document.getElementById('asyncChart'), {\r\n            type: 'line',\r\n            data: {\r\n                labels: ['1', '2', '3', '4', '5'],\r\n                datasets: [\r\n                    { label: 'Bloqueante', data: [60, 0, 0, 0, 60], borderColor: '#EF4444', fill: false },\r\n                    { label: 'As√≠ncrono', data: [60, 58, 59, 60, 60], borderColor: '#10B981', fill: false }\r\n                ]\r\n            },\r\n            options: { plugins: { title: { display: true, text: 'FPS' } } }\r\n        });\r\n    }\r\n    renderCharts();\r\n    document.addEventListener('astro:page-load', renderCharts);\r\n})();\r\n` }} />\r\n</div>","src/content/docs/es/articles/modern-delphi-concepts.mdx","9ead02420985c544","projects/dext",{id:183,data:185,body:191,filePath:192,digest:193,rendered:194},{title:186,description:187,editUrl:16,head:188,template:50,sidebar:189,pagefind:16,draft:37},"Dext Framework","Documenta√ß√£o oficial do projeto Dext.",[],{hidden:37,attrs:190},{},"## O que √© o Dext?\r\n\r\nUm framework fullstack para Delphi.\r\n\r\n### Instala√ß√£o\r\n\r\n```bash\r\nboss install dext\r\n```","src/content/docs/projects/dext.md","2abaadc013ea7747",{html:195,metadata:196},"<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"o-que-√©-o-dext\">O que √© o Dext?</h2><a class=\"sl-anchor-link\" href=\"#o-que-√©-o-dext\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúO que √© o Dext?‚Äù</span></a></div>\n<p>Um framework fullstack para Delphi.</p>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"instala√ß√£o\">Instala√ß√£o</h3><a class=\"sl-anchor-link\" href=\"#instala√ß√£o\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúInstala√ß√£o‚Äù</span></a></div>\n<div class=\"expressive-code\"><link rel=\"stylesheet\" href=\"/_astro/ec.2f3rl.css\"><script type=\"module\" src=\"/_astro/ec.0vx5m.js\"></script><figure class=\"frame is-terminal not-content\"><figcaption class=\"header\"><span class=\"title\"></span><span class=\"sr-only\">Terminal window</span></figcaption><pre data-language=\"bash\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#50FA7B\">boss</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#F1FA8C\">install</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#F1FA8C\">dext</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"boss install dext\"><div></div></button></div></figure></div>",{headings:197,localImagePaths:205,remoteImagePaths:206,frontmatter:207,imagePaths:208},[198,201],{depth:66,slug:199,text:200},"o-que-√©-o-dext","O que √© o Dext?",{depth:202,slug:203,text:204},3,"instala√ß√£o","Instala√ß√£o",[],[],{title:186,description:187},[],"articles/database-as-api-cqrs",{id:209,data:211,body:217,filePath:218,assetImports:219,digest:221,rendered:222},{title:212,description:213,editUrl:16,head:214,template:50,sidebar:215,pagefind:16,draft:37},"Como implementar CQRS e APIs de Alta Performance sem escrever Controllers","Do Banco √† API em 1 Linha: Zero Complexidade, Performance M√°xima.",[],{hidden:37,attrs:216},{},"![CQRS e APIs de Alta Performance](../../../assets/database-as-api-cover.png)\r\n\r\n### Do Banco √† API em 1 Linha: Zero Complexidade, Performance M√°xima.\r\n\r\nPor **Cesar Romero**\r\n\r\nSe voc√™ desenvolve backends corporativos hoje, provavelmente sofre da \"Fadiga do Boilerplate\". Para criar um simples CRUD de uma tabela de Clientes, a arquitetura moderna nos obriga a criar uma prociss√£o de arquivos: um Controller, um DTO, um Service, um Repository, um Validator e, finalmente, a Entidade.\r\n\r\nMultiplique isso por 50 tabelas e voc√™ tem semanas de trabalho repetitivo que n√£o agrega valor real ao neg√≥cio.\r\n\r\nE se eu te dissesse que √© poss√≠vel ter uma arquitetura limpa, segura e com performance superior √† manual, escrevendo apenas **uma linha de c√≥digo**?\r\n\r\nBem-vindo ao **Database as API** do Dext.\r\n\r\n## Zero Complexidade\r\n\r\nO Dext remove a burocracia do desenvolvimento de APIs. Ele entende que, na maioria das vezes, voc√™ s√≥ quer expor seus dados de forma segura e padronizada, sem ter que \"pedir permiss√£o\" para cinco camadas de arquitetura.\r\n\r\nVeja como definimos uma entidade no Dext. √â puro c√≥digo Delphi, limpo e tipado:\r\n\r\n```pascal\r\ntype\r\n  [Table('customers')]\r\n  TCustomer = class(TEntity)\r\n  private\r\n    FId: Integer;\r\n    FName: string;\r\n    FEmail: string;\r\n    FActive: Boolean;\r\n  public\r\n    [PK, AutoInc]\r\n    property Id: Integer read FId write FId;\r\n    \r\n    [Column('name'), Required, MaxLength(100)]\r\n    property Name: string read FName write FName;\r\n    \r\n    [Column('email'), MaxLength(255)]\r\n    property Email: string read FEmail write FEmail;\r\n    \r\n    [Column('active')]\r\n    property Active: Boolean read FActive write FActive;\r\n  end;\r\n```\r\n\r\nTradicionalmente, agora voc√™ come√ßaria a escrever o `CustomerController`. No Dext, voc√™ vai direto ao `Startup` e faz isso:\r\n\r\n```pascal\r\n// Mapeia a entidade TCustomer para uma API REST completa\r\nTDataApiHandler<TCustomer>.Map(ABuilder, '/api/customers', FDbContext);\r\n```\r\n\r\nPronto. O Dext levanta endpoints para `GET`, `POST`, `PUT` e `DELETE`, com tratamento de status HTTP, serializa√ß√£o JSON e binding de par√¢metros. Sem cerim√¥nias, sem arquivos extras.\r\n\r\n## Performance M√°xima com CQRS Impl√≠cito\r\n\r\nAqui √© onde separamos os \"geradores de c√≥digo simples\" das ferramentas de engenharia de software.\r\n\r\nMuitos frameworks tentam facilitar o CRUD usando *Reflection* pesada que instancia objetos, copia propriedades e depois serializa. Isso mata a performance. Outros fazem um dump direto do banco, expondo nomes de colunas feios ou dados sens√≠veis.\r\n\r\nO Dext adota uma abordagem de **CQRS (Command Query Responsibility Segregation) Impl√≠cito** com respeito total ao seu Mapping:\r\n\r\n1. **Read Pipeline (GET): Direct-to-JSON Streaming**\r\nQuando voc√™ chama `GET /api/customers`, o Dext cria um pipeline otimizado entre o `IDbReader` (banco) e o `Response.Body` (Network). O consumo de mem√≥ria √© pr√≥ximo de zero.\r\n2. **O Mapping √© Soberano**\r\nMesmo no modo de alta performance, o Dext **respeita seus atributos de mapeamento**.\r\n* Tem um atributo `[JsonIgnore]`? O campo n√£o vai para o JSON.\r\n* Tem uma estrat√©gia de *Naming* configurada (ex: `camelCase`)? O Dext aplica as transforma√ß√µes de chave/valor em tempo de streaming, garantindo que o contrato da sua API seja respeitado sem sacrificar a velocidade.\r\n\r\n\r\n3. **Write Pipeline (POST/PUT): Domain Safety**\r\nJ√° na escrita, a seguran√ßa √© primordial. O Dext recebe o JSON, hidrata a entidade `TCustomer`, roda as valida√ß√µes de dom√≠nio e persiste via `DbContext`.\r\n\r\nVoc√™ ganha a performance de um *Micro-ORM* na leitura e a seguran√ßa de um *Enterprise ORM* na escrita.\r\n\r\n## Uma API que Fala a L√≠ngua do Front-end\r\n\r\nOutro problema comum √© o \"Backend for Frontend\" (BFF). O Front-end pede um endpoint para filtrar por nome. Depois outro para filtrar por status. Depois outro com pagina√ß√£o.\r\n\r\nO **Database as API** entrega uma **Queryable API** nativa. Sem escrever nenhuma linha extra de c√≥digo, seu endpoint `/api/customers` j√° suporta filtros din√¢micos via query string:\r\n\r\n* **Filtros:** `/api/customers?active=true&name=John`\r\n* **Pagina√ß√£o:** `/api/customers?_limit=10&_offset=20`\r\n* **Sele√ß√£o:** O Dext traduz os par√¢metros da URL em queries SQL otimizadas automaticamente.\r\n\r\n## Mas e a Seguran√ßa?\r\n\r\n\"Expor o banco √© perigoso!\", diriam os c√©ticos. E estariam certos, se o Dext n√£o tivesse sido desenhado com **Security-First**.\r\n\r\nEmbora o exemplo b√°sico seja aberto para facilitar o aprendizado, em produ√ß√£o voc√™ blinda sua API com RBAC (Role-Based Access Control) em uma linha fluente:\r\n\r\n```pascal\r\nTDataApiHandler<TCustomer>.Map(App, '/api/customers', FDbContext,\r\n  TDataApiOptions<TCustomer>.Create\r\n    .RequireReadRole('User,Admin')   // Leitura ampla: Viewer, User ou Admin\r\n    .RequireWriteRole('Editor,Admin') // Escrita restrita: Editor ou Admin\r\n);\r\n```\r\n\r\n## Conclus√£o\r\n\r\nO Dext n√£o est√° apenas facilitando a cria√ß√£o de APIs; ele est√° devolvendo ao desenvolvedor a capacidade de focar no que importa.\r\n\r\nEle elimina a complexidade acidental (controllers repetitivos, DTOs de espelho) e mant√©m o que √© essencial: suas Regras de Neg√≥cio, seu Mapping e sua Seguran√ßa.\r\n\r\nSe voc√™ quer a performance de uma arquitetura otimizada sem a complexidade de frameworks verbosos, o Dext √© a sua nova ferramenta de trabalho.\r\n\r\n---\r\n\r\n*Gostou? Baixe o exemplo completo `DatabaseAsApi.dpr` no reposit√≥rio oficial e veja a m√°gica acontecer.*\r\n[https://github.com/cesarliws/dext](https://github.com/cesarliws/dext)","src/content/docs/articles/database-as-api-cqrs.md",[220],"../../../assets/database-as-api-cover.png","9bb4a9fc6e395044",{html:223,metadata:224},"<p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;../../../assets/database-as-api-cover.png&#x22;,&#x22;alt&#x22;:&#x22;CQRS e APIs de Alta Performance&#x22;,&#x22;index&#x22;:0}\"></p>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"do-banco-√†-api-em-1-linha-zero-complexidade-performance-m√°xima\">Do Banco √† API em 1 Linha: Zero Complexidade, Performance M√°xima.</h3><a class=\"sl-anchor-link\" href=\"#do-banco-√†-api-em-1-linha-zero-complexidade-performance-m√°xima\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúDo Banco √† API em 1 Linha: Zero Complexidade, Performance M√°xima.‚Äù</span></a></div>\n<p>Por <strong>Cesar Romero</strong></p>\n<p>Se voc√™ desenvolve backends corporativos hoje, provavelmente sofre da ‚ÄúFadiga do Boilerplate‚Äù. Para criar um simples CRUD de uma tabela de Clientes, a arquitetura moderna nos obriga a criar uma prociss√£o de arquivos: um Controller, um DTO, um Service, um Repository, um Validator e, finalmente, a Entidade.</p>\n<p>Multiplique isso por 50 tabelas e voc√™ tem semanas de trabalho repetitivo que n√£o agrega valor real ao neg√≥cio.</p>\n<p>E se eu te dissesse que √© poss√≠vel ter uma arquitetura limpa, segura e com performance superior √† manual, escrevendo apenas <strong>uma linha de c√≥digo</strong>?</p>\n<p>Bem-vindo ao <strong>Database as API</strong> do Dext.</p>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"zero-complexidade\">Zero Complexidade</h2><a class=\"sl-anchor-link\" href=\"#zero-complexidade\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúZero Complexidade‚Äù</span></a></div>\n<p>O Dext remove a burocracia do desenvolvimento de APIs. Ele entende que, na maioria das vezes, voc√™ s√≥ quer expor seus dados de forma segura e padronizada, sem ter que ‚Äúpedir permiss√£o‚Äù para cinco camadas de arquitetura.</p>\n<p>Veja como definimos uma entidade no Dext. √â puro c√≥digo Delphi, limpo e tipado:</p>\n<div class=\"expressive-code\"><link rel=\"stylesheet\" href=\"/_astro/ec.2f3rl.css\"><script type=\"module\" src=\"/_astro/ec.0vx5m.js\"></script><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">type</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">[Table(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">customers</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">)]</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">TCustomer = </span><span style=\"--0:#FF79C6\">class</span><span style=\"--0:#F8F8F2\">(TEntity)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">private</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">FId: </span><span style=\"--0:#FF79C6\">Integer</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">FName: </span><span style=\"--0:#FF79C6\">string</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">FEmail: </span><span style=\"--0:#FF79C6\">string</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">FActive: </span><span style=\"--0:#FF79C6\">Boolean</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">public</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">[PK, AutoInc]</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">property</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">Id</span><span style=\"--0:#F8F8F2\">: </span><span style=\"--0:#FF79C6\">Integer</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">read</span><span style=\"--0:#F8F8F2\"> FId </span><span style=\"--0:#FF79C6\">write</span><span style=\"--0:#F8F8F2\"> FId;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">[Column(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">name</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">), Required, MaxLength(</span><span style=\"--0:#BD93F9\">100</span><span style=\"--0:#F8F8F2\">)]</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">property</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">Name</span><span style=\"--0:#F8F8F2\">: </span><span style=\"--0:#FF79C6\">string</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">read</span><span style=\"--0:#F8F8F2\"> FName </span><span style=\"--0:#FF79C6\">write</span><span style=\"--0:#F8F8F2\"> FName;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">[Column(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">email</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">), MaxLength(</span><span style=\"--0:#BD93F9\">255</span><span style=\"--0:#F8F8F2\">)]</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">property</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">Email</span><span style=\"--0:#F8F8F2\">: </span><span style=\"--0:#FF79C6\">string</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">read</span><span style=\"--0:#F8F8F2\"> FEmail </span><span style=\"--0:#FF79C6\">write</span><span style=\"--0:#F8F8F2\"> FEmail;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">[Column(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">active</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">)]</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">property</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">Active</span><span style=\"--0:#F8F8F2\">: </span><span style=\"--0:#FF79C6\">Boolean</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">read</span><span style=\"--0:#F8F8F2\"> FActive </span><span style=\"--0:#FF79C6\">write</span><span style=\"--0:#F8F8F2\"> FActive;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"type  [Table(&#x27;customers&#x27;)]  TCustomer = class(TEntity)  private    FId: Integer;    FName: string;    FEmail: string;    FActive: Boolean;  public    [PK, AutoInc]    property Id: Integer read FId write FId;    [Column(&#x27;name&#x27;), Required, MaxLength(100)]    property Name: string read FName write FName;    [Column(&#x27;email&#x27;), MaxLength(255)]    property Email: string read FEmail write FEmail;    [Column(&#x27;active&#x27;)]    property Active: Boolean read FActive write FActive;  end;\"><div></div></button></div></figure></div>\n<p>Tradicionalmente, agora voc√™ come√ßaria a escrever o <code dir=\"auto\">CustomerController</code>. No Dext, voc√™ vai direto ao <code dir=\"auto\">Startup</code> e faz isso:</p>\n<div class=\"expressive-code\"><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#96A1C2\">// Mapeia a entidade TCustomer para uma API REST completa</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#F8F8F2\">TDataApiHandler&#x3C;TCustomer>.Map(ABuilder, </span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">/api/customers</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">, FDbContext);</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"// Mapeia a entidade TCustomer para uma API REST completaTDataApiHandler<TCustomer>.Map(ABuilder, &#x27;/api/customers&#x27;, FDbContext);\"><div></div></button></div></figure></div>\n<p>Pronto. O Dext levanta endpoints para <code dir=\"auto\">GET</code>, <code dir=\"auto\">POST</code>, <code dir=\"auto\">PUT</code> e <code dir=\"auto\">DELETE</code>, com tratamento de status HTTP, serializa√ß√£o JSON e binding de par√¢metros. Sem cerim√¥nias, sem arquivos extras.</p>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"performance-m√°xima-com-cqrs-impl√≠cito\">Performance M√°xima com CQRS Impl√≠cito</h2><a class=\"sl-anchor-link\" href=\"#performance-m√°xima-com-cqrs-impl√≠cito\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúPerformance M√°xima com CQRS Impl√≠cito‚Äù</span></a></div>\n<p>Aqui √© onde separamos os ‚Äúgeradores de c√≥digo simples‚Äù das ferramentas de engenharia de software.</p>\n<p>Muitos frameworks tentam facilitar o CRUD usando <em>Reflection</em> pesada que instancia objetos, copia propriedades e depois serializa. Isso mata a performance. Outros fazem um dump direto do banco, expondo nomes de colunas feios ou dados sens√≠veis.</p>\n<p>O Dext adota uma abordagem de <strong>CQRS (Command Query Responsibility Segregation) Impl√≠cito</strong> com respeito total ao seu Mapping:</p>\n<ol>\n<li><strong>Read Pipeline (GET): Direct-to-JSON Streaming</strong>\r\nQuando voc√™ chama <code dir=\"auto\">GET /api/customers</code>, o Dext cria um pipeline otimizado entre o <code dir=\"auto\">IDbReader</code> (banco) e o <code dir=\"auto\">Response.Body</code> (Network). O consumo de mem√≥ria √© pr√≥ximo de zero.</li>\n<li><strong>O Mapping √© Soberano</strong>\r\nMesmo no modo de alta performance, o Dext <strong>respeita seus atributos de mapeamento</strong>.</li>\n</ol>\n<ul>\n<li>Tem um atributo <code dir=\"auto\">[JsonIgnore]</code>? O campo n√£o vai para o JSON.</li>\n<li>Tem uma estrat√©gia de <em>Naming</em> configurada (ex: <code dir=\"auto\">camelCase</code>)? O Dext aplica as transforma√ß√µes de chave/valor em tempo de streaming, garantindo que o contrato da sua API seja respeitado sem sacrificar a velocidade.</li>\n</ul>\n<ol start=\"3\">\n<li><strong>Write Pipeline (POST/PUT): Domain Safety</strong>\r\nJ√° na escrita, a seguran√ßa √© primordial. O Dext recebe o JSON, hidrata a entidade <code dir=\"auto\">TCustomer</code>, roda as valida√ß√µes de dom√≠nio e persiste via <code dir=\"auto\">DbContext</code>.</li>\n</ol>\n<p>Voc√™ ganha a performance de um <em>Micro-ORM</em> na leitura e a seguran√ßa de um <em>Enterprise ORM</em> na escrita.</p>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"uma-api-que-fala-a-l√≠ngua-do-front-end\">Uma API que Fala a L√≠ngua do Front-end</h2><a class=\"sl-anchor-link\" href=\"#uma-api-que-fala-a-l√≠ngua-do-front-end\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúUma API que Fala a L√≠ngua do Front-end‚Äù</span></a></div>\n<p>Outro problema comum √© o ‚ÄúBackend for Frontend‚Äù (BFF). O Front-end pede um endpoint para filtrar por nome. Depois outro para filtrar por status. Depois outro com pagina√ß√£o.</p>\n<p>O <strong>Database as API</strong> entrega uma <strong>Queryable API</strong> nativa. Sem escrever nenhuma linha extra de c√≥digo, seu endpoint <code dir=\"auto\">/api/customers</code> j√° suporta filtros din√¢micos via query string:</p>\n<ul>\n<li><strong>Filtros:</strong> <code dir=\"auto\">/api/customers?active=true&#x26;name=John</code></li>\n<li><strong>Pagina√ß√£o:</strong> <code dir=\"auto\">/api/customers?_limit=10&#x26;_offset=20</code></li>\n<li><strong>Sele√ß√£o:</strong> O Dext traduz os par√¢metros da URL em queries SQL otimizadas automaticamente.</li>\n</ul>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"mas-e-a-seguran√ßa\">Mas e a Seguran√ßa?</h2><a class=\"sl-anchor-link\" href=\"#mas-e-a-seguran√ßa\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúMas e a Seguran√ßa?‚Äù</span></a></div>\n<p>‚ÄúExpor o banco √© perigoso!‚Äù, diriam os c√©ticos. E estariam certos, se o Dext n√£o tivesse sido desenhado com <strong>Security-First</strong>.</p>\n<p>Embora o exemplo b√°sico seja aberto para facilitar o aprendizado, em produ√ß√£o voc√™ blinda sua API com RBAC (Role-Based Access Control) em uma linha fluente:</p>\n<div class=\"expressive-code\"><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#F8F8F2\">TDataApiHandler&#x3C;TCustomer>.Map(App, </span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">/api/customers</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">, FDbContext,</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">TDataApiOptions&#x3C;TCustomer>.Create</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.RequireReadRole(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">User,Admin</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">)   </span><span style=\"--0:#96A1C2\">// Leitura ampla: Viewer, User ou Admin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.RequireWriteRole(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Editor,Admin</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">) </span><span style=\"--0:#96A1C2\">// Escrita restrita: Editor ou Admin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#F8F8F2\">);</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"TDataApiHandler<TCustomer>.Map(App, &#x27;/api/customers&#x27;, FDbContext,  TDataApiOptions<TCustomer>.Create    .RequireReadRole(&#x27;User,Admin&#x27;)   // Leitura ampla: Viewer, User ou Admin    .RequireWriteRole(&#x27;Editor,Admin&#x27;) // Escrita restrita: Editor ou Admin);\"><div></div></button></div></figure></div>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"conclus√£o\">Conclus√£o</h2><a class=\"sl-anchor-link\" href=\"#conclus√£o\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúConclus√£o‚Äù</span></a></div>\n<p>O Dext n√£o est√° apenas facilitando a cria√ß√£o de APIs; ele est√° devolvendo ao desenvolvedor a capacidade de focar no que importa.</p>\n<p>Ele elimina a complexidade acidental (controllers repetitivos, DTOs de espelho) e mant√©m o que √© essencial: suas Regras de Neg√≥cio, seu Mapping e sua Seguran√ßa.</p>\n<p>Se voc√™ quer a performance de uma arquitetura otimizada sem a complexidade de frameworks verbosos, o Dext √© a sua nova ferramenta de trabalho.</p>\n<hr>\n<p><em>Gostou? Baixe o exemplo completo <code dir=\"auto\">DatabaseAsApi.dpr</code> no reposit√≥rio oficial e veja a m√°gica acontecer.</em>\r\n<a href=\"https://github.com/cesarliws/dext\">https://github.com/cesarliws/dext</a></p>",{headings:225,localImagePaths:243,remoteImagePaths:244,frontmatter:245,imagePaths:251},[226,228,231,234,237,240],{depth:202,slug:227,text:213},"do-banco-√†-api-em-1-linha-zero-complexidade-performance-m√°xima",{depth:66,slug:229,text:230},"zero-complexidade","Zero Complexidade",{depth:66,slug:232,text:233},"performance-m√°xima-com-cqrs-impl√≠cito","Performance M√°xima com CQRS Impl√≠cito",{depth:66,slug:235,text:236},"uma-api-que-fala-a-l√≠ngua-do-front-end","Uma API que Fala a L√≠ngua do Front-end",{depth:66,slug:238,text:239},"mas-e-a-seguran√ßa","Mas e a Seguran√ßa?",{depth:66,slug:241,text:242},"conclus√£o","Conclus√£o",[220],[],{title:212,description:213,date:246,tags:247},["Date","2025-12-29T00:00:00.000Z"],[95,248,249,250,96],"API","Performance","CQRS",[220],"articles/delphi-async-fluent",{id:252,data:254,body:260,filePath:261,assetImports:262,digest:267,rendered:268},{title:255,description:256,editUrl:16,head:257,template:50,sidebar:258,pagefind:16,draft:37},"Delphi Multithreading Moderno: Escreva C√≥digo Ass√≠ncrono Limpo e sem Complica√ß√£o","Como transformei a \"Pyramid of Doom\" em uma sinfonia ass√≠ncrona com o Dext Framework",[],{hidden:37,attrs:259},{},"![Promessa Cumprida](../../../assets/hero.png)\r\n\r\nEm 2025, durante minhas palestras na **Embarcadero Conference**, **Luso Delphi** e **CodeRage**, eu terminei minha apresenta√ß√£o com alguns slides \"misteriosos\" (Slides 17 e 18).\r\n\r\nEu falei sobre a jornada do desenvolvedor: sa√≠mos da complexidade manual da `TThread`, evolu√≠mos para a efici√™ncia da **PPL (Parallel Programming Library)**, mas ainda faltava algo.\r\n\r\nQuem usa PPL intensivamente conhece o problema. Para orquestrar pipelines complexos (baixar dados -> processar -> salvar -> atualizar UI), acabamos caindo na temida **\"Pyramid of Doom\"**: aninhamento excessivo de m√©todos an√¥nimos, blocos `try..except` repetitivos e chamadas manuais de `TThread.Queue` para n√£o congelar a tela.\r\n\r\nNaquele slide, eu prometi uma vis√£o de futuro: Uma interface fluente onde o c√≥digo ass√≠ncrono pudesse ser lido como uma frase.\r\n\r\n**A espera acabou. A promessa foi cumprida.**\r\n\r\nHoje, apresento oficialmente o `Dext.Threading.Async` ‚Äî a implementa√ß√£o real daquele conceito, agora dispon√≠vel no [Dext Framework](https://github.com/cesarliws/dext).\r\n\r\n### O Problema: A \"D√≠vida\" da Complexidade\r\n\r\nNo meu livro, [\"Delphi Multithreading\"](https://www.cesarromero.com.br/), dedico cap√≠tulos inteiros ensinando como proteger suas threads, evitar *Race Conditions* e garantir que exce√ß√µes n√£o derrubem sua aplica√ß√£o silenciosamente. Essa base te√≥rica √© inegoci√°vel.\r\n\r\nPor√©m, no dia a dia, escrever toda essa infraestrutura \"na unha\" para cada bot√£o do seu sistema √© cansativo. Veja o padr√£o tradicional:\r\n\r\n```pascal\r\n// O jeito padr√£o de usar a PPL\r\nTTask.Run(procedure\r\nbegin\r\n  try\r\n    var Dados := DownloadBytes;\r\n    // Aninhamento...\r\n    TThread.Synchronize(nil, procedure\r\n    begin\r\n       AtualizaUI(Dados); // E se o Form j√° fechou? Access Violation.\r\n    end);\r\n  except\r\n    on E: Exception do HandleError(E); // Boilerplate repetitivo\r\n  end;\r\nend);\r\n```\r\n\r\n### A Solu√ß√£o: Dext Fluent Async\r\n\r\n![Comparative Concept](../../../assets/concept_compartion.png)\r\n\r\nCom o novo motor do Dext, abstra√≠mos a complexidade da `ITask`, `IFuture` e o tratamento de exce√ß√µes em uma sintaxe declarativa.\r\n\r\nVamos a um exemplo real? Imagine um Dashboard que precisa carregar 3 pain√©is pesados simultaneamente ao abrir a tela. Se fiz√©ssemos sequencial, o usu√°rio esperaria a soma dos tempos. Com o Dext, disparamos em paralelo e o c√≥digo permanece limpo:\r\n\r\n```pascal\r\nuses Dext.Threading.Async;\r\n\r\nprocedure TFormDashboard.LoadDashboard;\r\nbegin\r\n  // 1. Carrega o Perfil do Usu√°rio (I/O Bound)\r\n  // Dispara e esquece a complexidade. O Dext gerencia a thread.\r\n  var Task1 := TAsyncTask.Run<TUserProfile>(\r\n    function: TUserProfile\r\n    begin\r\n      // Executa em Background Thread Pool\r\n      Result := UserService.GetProfile(Self.UserId); \r\n    end)\r\n    .ThenBy(procedure(User: TUserProfile)\r\n    begin\r\n      // Executa processamento adicional em background se necess√°rio\r\n      LogAcesso(User);\r\n    end)\r\n    .OnComplete(procedure(User: TUserProfile)\r\n    begin\r\n      // Executa AUTOMATICAMENTE na Main Thread (seguro para VCL/FMX)\r\n      UserLabel.Caption := 'Bem vindo, ' + User.Name;\r\n      imgAvatar.Bitmap := User.Avatar;\r\n    end)\r\n    .OnException(procedure(E: Exception)\r\n    begin\r\n      // Tratamento centralizado de erro na Main Thread\r\n      ShowMessage('Erro ao carregar perfil: ' + E.Message);\r\n    end)\r\n    .Start; // Inicia a execu√ß√£o\r\n\r\n  // 2. Carrega Gr√°fico Financeiro (CPU Bound)\r\n  // Executa em PARALELO ao anterior\r\n  var Task2 := TAsyncTask.Run<TFinancialData>(\r\n    function: TFinancialData\r\n    begin\r\n      // Verifica cancelamento automaticamente antes de come√ßar\r\n      Result := FinanceService.CalculateHeavyMetrics(CurrentYear);\r\n    end)\r\n    .OnComplete(procedure(Data: TFinancialData)\r\n    begin\r\n      ChartSales.Series[0].Add(Data.Values);\r\n    end)\r\n    .Start;\r\n    \r\n  // 3. Atualiza Notifica√ß√µes\r\n  var Task3 := TAsyncTask.Run<Integer>(\r\n    function: Integer\r\n    begin\r\n      Result := NotificationService.CountUnread;\r\n    end)\r\n    .OnComplete(procedure(Count: Integer)\r\n    begin\r\n      Badge.Text := Count.ToString;\r\n      Badge.Visible := Count > 0;\r\n    end)\r\n    .Start;\r\n\r\n  // Aguarda todas as tarefas finalizarem\r\n  TAsyncTask.WaitForAll([Task1, Task2, Task3]);\r\nend;\r\n```\r\n\r\n**O que ganhamos aqui?**\r\n\r\n1. **Legibilidade:** Lemos o c√≥digo de cima para baixo, como uma hist√≥ria.\r\n2. **Seguran√ßa de Thread:** O `OnComplete` e `OnException` j√° garantem a sincroniza√ß√£o com a Main Thread ou thread chamadora. Acabou o `TThread.Queue` espalhado pelo c√≥digo.\r\n3. **Propaga√ß√£o de Exce√ß√£o:** Se o `GetProfile` falhar, o fluxo pula o `ThenBy` e cai direto no `OnException`. Sem `try..except` poluindo a regra de neg√≥cio.\r\n\r\n### A Rede de Seguran√ßa: Cancellation Tokens\r\n\r\nMas e se o usu√°rio fechar o formul√°rio enquanto essas 3 tarefas est√£o rodando? Teremos um *Access Violation* ao tentar atualizar o `UserLabel`?\r\n\r\n√â aqui que entra a teoria que ensino no Cap√≠tulo 4 do livro: **Cancelamento Cooperativo**.\r\n\r\nO Dext implementa o padr√£o `ICancellationToken` (inspirado no .NET) de forma transparente. Voc√™ pode passar um token para a tarefa, e a cadeia fluente verifica esse token antes de cada etapa.\r\n\r\n```pascal\r\n// Vincula o Token ao ciclo de vida do Form\r\nFTokenSource := TCancellationTokenSource.Create;\r\n\r\nTAsyncTask.Run(...)\r\n  .WithCancellation(FTokenSource.Token) // A m√°gica acontece aqui\r\n  .OnComplete(...) \r\n  .Start;\r\n\r\nprocedure TFormDashboard.FormDestroy(Sender: TObject);\r\nbegin\r\n  // Ao destruir o form, cancela tudo que est√° pendente.\r\n  // O Dext impede que o OnComplete (que acessa componentes visuais) seja executado.\r\n  FTokenSource.Cancel; \r\nend;\r\n```\r\n\r\nIsso resolve um dos bugs mais comuns e dif√≠ceis de rastrear em aplica√ß√µes Delphi Multithread: o *callback* que tenta acessar um objeto destru√≠do.\r\n\r\n### Teoria e Pr√°tica: O \"Power Duo\"\r\n\r\nO **Dext Framework** entrega a ferramenta pronta para produ√ß√£o. Mas para usar multithreading com maestria, voc√™ precisa entender o que realmente est√° acontecendo. Por que o Pool de Threads √© melhor que criar Threads manuais? O que √© Context Switching? Como funcionam as Primitivas de Sincroniza√ß√£o?\r\n\r\n![Delphi Multithreading Book](../../../assets/delphi_multithreading_desk.png)\r\n\r\n√â por isso que digo que o Livro e o Framework formam um par perfeito:\r\n\r\n* üìò **O Livro (Delphi Multithreading):** Ensina a base, a arquitetura e os \"porqu√™s\". O c√≥digo fonte dos exemplos do livro (incluindo a implementa√ß√£o pura do CancellationToken) est√° dispon√≠vel abertamente para estudo.\r\n* *Reposit√≥rio (PT):* [github.com/cesarliws/DelphiMultithreadingBookCode](https://github.com/cesarliws/DelphiMultithreadingBookCode)\r\n* *Reposit√≥rio (EN):* [github.com/cesarliws/DelphiMultithreadingBookCodeEnglishEdition](https://github.com/cesarliws/DelphiMultithreadingBookCodeEnglishEdition)\r\n\r\n\r\n* üöÄ **O Framework (Dext):** Entrega a implementa√ß√£o produtiva, testada e pronta para o dia a dia, aplicando os conceitos do livro em uma API moderna.\r\n\r\n### Conclus√£o\r\n\r\nCumpri minha promessa feita no CodeRage. O **Fluent Tasks** n√£o √© mais apenas um slide de PowerPoint; √© c√≥digo real que voc√™ pode usar hoje para eliminar a complexidade do seu projeto.\r\n\r\n![Delphi Multithreading Book 3D](../../../assets/delphi_multithreading_mockup_3d.png)\r\n\r\nConvido voc√™ a baixar o Dext, testar o `Dext.Threading.Async` e, se quiser dominar a engenharia por tr√°s disso, garantir sua c√≥pia do livro no meu site.\r\n\r\nDocumenta√ß√£o Async API: https://github.com/cesarliws/dext/blob/main/Docs/async-api.md\r\n\r\nBaixe o Dext: https://github.com/cesarliws/dext\r\n\r\nGaranta o Livro: https://www.cesarromero.com.br/\r\n\r\nVamos codar (em paralelo)! üöÄ\r\n\r\n#Delphi #Multithreading #DelphiMultithreadingBook #DextFramework #AsyncProgramming #CodeRage #SoftwareArchitecture #OpenSource","src/content/docs/articles/delphi-async-fluent.md",[263,264,265,266],"../../../assets/hero.png","../../../assets/concept_compartion.png","../../../assets/delphi_multithreading_desk.png","../../../assets/delphi_multithreading_mockup_3d.png","c75214d51fefde44",{html:269,metadata:270},"<p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;../../../assets/hero.png&#x22;,&#x22;alt&#x22;:&#x22;Promessa Cumprida&#x22;,&#x22;index&#x22;:0}\"></p>\n<p>Em 2025, durante minhas palestras na <strong>Embarcadero Conference</strong>, <strong>Luso Delphi</strong> e <strong>CodeRage</strong>, eu terminei minha apresenta√ß√£o com alguns slides ‚Äúmisteriosos‚Äù (Slides 17 e 18).</p>\n<p>Eu falei sobre a jornada do desenvolvedor: sa√≠mos da complexidade manual da <code dir=\"auto\">TThread</code>, evolu√≠mos para a efici√™ncia da <strong>PPL (Parallel Programming Library)</strong>, mas ainda faltava algo.</p>\n<p>Quem usa PPL intensivamente conhece o problema. Para orquestrar pipelines complexos (baixar dados -> processar -> salvar -> atualizar UI), acabamos caindo na temida <strong>‚ÄúPyramid of Doom‚Äù</strong>: aninhamento excessivo de m√©todos an√¥nimos, blocos <code dir=\"auto\">try..except</code> repetitivos e chamadas manuais de <code dir=\"auto\">TThread.Queue</code> para n√£o congelar a tela.</p>\n<p>Naquele slide, eu prometi uma vis√£o de futuro: Uma interface fluente onde o c√≥digo ass√≠ncrono pudesse ser lido como uma frase.</p>\n<p><strong>A espera acabou. A promessa foi cumprida.</strong></p>\n<p>Hoje, apresento oficialmente o <code dir=\"auto\">Dext.Threading.Async</code> ‚Äî a implementa√ß√£o real daquele conceito, agora dispon√≠vel no <a href=\"https://github.com/cesarliws/dext\">Dext Framework</a>.</p>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"o-problema-a-d√≠vida-da-complexidade\">O Problema: A ‚ÄúD√≠vida‚Äù da Complexidade</h3><a class=\"sl-anchor-link\" href=\"#o-problema-a-d√≠vida-da-complexidade\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúO Problema: A ‚ÄúD√≠vida‚Äù da Complexidade‚Äù</span></a></div>\n<p>No meu livro, <a href=\"https://www.cesarromero.com.br/\">‚ÄúDelphi Multithreading‚Äù</a>, dedico cap√≠tulos inteiros ensinando como proteger suas threads, evitar <em>Race Conditions</em> e garantir que exce√ß√µes n√£o derrubem sua aplica√ß√£o silenciosamente. Essa base te√≥rica √© inegoci√°vel.</p>\n<p>Por√©m, no dia a dia, escrever toda essa infraestrutura ‚Äúna unha‚Äù para cada bot√£o do seu sistema √© cansativo. Veja o padr√£o tradicional:</p>\n<div class=\"expressive-code\"><link rel=\"stylesheet\" href=\"/_astro/ec.2f3rl.css\"><script type=\"module\" src=\"/_astro/ec.0vx5m.js\"></script><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#96A1C2\">// O jeito padr√£o de usar a PPL</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#F8F8F2\">TTask.Run(procedure</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">try</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Dados := DownloadBytes;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#96A1C2\">// Aninhamento...</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">TThread.Synchronize(</span><span style=\"--0:#BD93F9\">nil</span><span style=\"--0:#F8F8F2\">, procedure</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">       </span></span><span style=\"--0:#F8F8F2\">AtualizaUI(Dados); </span><span style=\"--0:#96A1C2\">// E se o Form j√° fechou? Access Violation.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">except</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">on</span><span style=\"--0:#F8F8F2\"> E: Exception </span><span style=\"--0:#FF79C6\">do</span><span style=\"--0:#F8F8F2\"> HandleError(E); </span><span style=\"--0:#96A1C2\">// Boilerplate repetitivo</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">);</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"// O jeito padr√£o de usar a PPLTTask.Run(procedurebegin  try    var Dados := DownloadBytes;    // Aninhamento...    TThread.Synchronize(nil, procedure    begin       AtualizaUI(Dados); // E se o Form j√° fechou? Access Violation.    end);  except    on E: Exception do HandleError(E); // Boilerplate repetitivo  end;end);\"><div></div></button></div></figure></div>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"a-solu√ß√£o-dext-fluent-async\">A Solu√ß√£o: Dext Fluent Async</h3><a class=\"sl-anchor-link\" href=\"#a-solu√ß√£o-dext-fluent-async\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúA Solu√ß√£o: Dext Fluent Async‚Äù</span></a></div>\n<p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;../../../assets/concept_compartion.png&#x22;,&#x22;alt&#x22;:&#x22;Comparative Concept&#x22;,&#x22;index&#x22;:0}\"></p>\n<p>Com o novo motor do Dext, abstra√≠mos a complexidade da <code dir=\"auto\">ITask</code>, <code dir=\"auto\">IFuture</code> e o tratamento de exce√ß√µes em uma sintaxe declarativa.</p>\n<p>Vamos a um exemplo real? Imagine um Dashboard que precisa carregar 3 pain√©is pesados simultaneamente ao abrir a tela. Se fiz√©ssemos sequencial, o usu√°rio esperaria a soma dos tempos. Com o Dext, disparamos em paralelo e o c√≥digo permanece limpo:</p>\n<div class=\"expressive-code\"><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">uses</span><span style=\"--0:#F8F8F2\"> Dext.Threading.</span><span style=\"--0:#FF79C6\">Async</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">TFormDashboard.LoadDashboard</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// 1. Carrega o Perfil do Usu√°rio (I/O Bound)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Dispara e esquece a complexidade. O Dext gerencia a thread.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Task1 := TAsyncTask.Run&#x3C;TUserProfile>(</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">function: TUserProfile</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#96A1C2\">// Executa em Background Thread Pool</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#FF79C6\">Result</span><span style=\"--0:#F8F8F2\"> := UserService.GetProfile(Self.UserId);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.ThenBy(procedure(User: TUserProfile)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#96A1C2\">// Executa processamento adicional em background se necess√°rio</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">LogAcesso(User);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.OnComplete(procedure(User: TUserProfile)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#96A1C2\">// Executa AUTOMATICAMENTE na Main Thread (seguro para VCL/FMX)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">UserLabel.Caption := </span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Bem vindo, </span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\"> + User.</span><span style=\"--0:#FF79C6\">Name</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">imgAvatar.Bitmap := User.Avatar;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.OnException(procedure(E: Exception)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#96A1C2\">// Tratamento centralizado de erro na Main Thread</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">ShowMessage(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Erro ao carregar perfil: </span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\"> + E.</span><span style=\"--0:#FF79C6\">Message</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.Start; </span><span style=\"--0:#96A1C2\">// Inicia a execu√ß√£o</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// 2. Carrega Gr√°fico Financeiro (CPU Bound)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Executa em PARALELO ao anterior</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Task2 := TAsyncTask.Run&#x3C;TFinancialData>(</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">function: TFinancialData</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#96A1C2\">// Verifica cancelamento automaticamente antes de come√ßar</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#FF79C6\">Result</span><span style=\"--0:#F8F8F2\"> := FinanceService.CalculateHeavyMetrics(CurrentYear);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.OnComplete(procedure(Data: TFinancialData)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">ChartSales.Series[</span><span style=\"--0:#BD93F9\">0</span><span style=\"--0:#F8F8F2\">].</span><span style=\"--0:#FF79C6\">Add</span><span style=\"--0:#F8F8F2\">(Data.Values);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.Start;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// 3. Atualiza Notifica√ß√µes</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Task3 := TAsyncTask.Run&#x3C;</span><span style=\"--0:#FF79C6\">Integer</span><span style=\"--0:#F8F8F2\">>(</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">function: </span><span style=\"--0:#FF79C6\">Integer</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#FF79C6\">Result</span><span style=\"--0:#F8F8F2\"> := NotificationService.CountUnread;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.OnComplete(procedure(Count: </span><span style=\"--0:#FF79C6\">Integer</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">Badge.Text := Count.ToString;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">Badge.Visible := Count > </span><span style=\"--0:#BD93F9\">0</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.Start;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Aguarda todas as tarefas finalizarem</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">TAsyncTask.WaitForAll([Task1, Task2, Task3]);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"uses Dext.Threading.Async;procedure TFormDashboard.LoadDashboard;begin  // 1. Carrega o Perfil do Usu√°rio (I/O Bound)  // Dispara e esquece a complexidade. O Dext gerencia a thread.  var Task1 := TAsyncTask.Run<TUserProfile>(    function: TUserProfile    begin      // Executa em Background Thread Pool      Result := UserService.GetProfile(Self.UserId);    end)    .ThenBy(procedure(User: TUserProfile)    begin      // Executa processamento adicional em background se necess√°rio      LogAcesso(User);    end)    .OnComplete(procedure(User: TUserProfile)    begin      // Executa AUTOMATICAMENTE na Main Thread (seguro para VCL/FMX)      UserLabel.Caption := &#x27;Bem vindo, &#x27; + User.Name;      imgAvatar.Bitmap := User.Avatar;    end)    .OnException(procedure(E: Exception)    begin      // Tratamento centralizado de erro na Main Thread      ShowMessage(&#x27;Erro ao carregar perfil: &#x27; + E.Message);    end)    .Start; // Inicia a execu√ß√£o  // 2. Carrega Gr√°fico Financeiro (CPU Bound)  // Executa em PARALELO ao anterior  var Task2 := TAsyncTask.Run<TFinancialData>(    function: TFinancialData    begin      // Verifica cancelamento automaticamente antes de come√ßar      Result := FinanceService.CalculateHeavyMetrics(CurrentYear);    end)    .OnComplete(procedure(Data: TFinancialData)    begin      ChartSales.Series[0].Add(Data.Values);    end)    .Start;  // 3. Atualiza Notifica√ß√µes  var Task3 := TAsyncTask.Run<Integer>(    function: Integer    begin      Result := NotificationService.CountUnread;    end)    .OnComplete(procedure(Count: Integer)    begin      Badge.Text := Count.ToString;      Badge.Visible := Count > 0;    end)    .Start;  // Aguarda todas as tarefas finalizarem  TAsyncTask.WaitForAll([Task1, Task2, Task3]);end;\"><div></div></button></div></figure></div>\n<p><strong>O que ganhamos aqui?</strong></p>\n<ol>\n<li><strong>Legibilidade:</strong> Lemos o c√≥digo de cima para baixo, como uma hist√≥ria.</li>\n<li><strong>Seguran√ßa de Thread:</strong> O <code dir=\"auto\">OnComplete</code> e <code dir=\"auto\">OnException</code> j√° garantem a sincroniza√ß√£o com a Main Thread ou thread chamadora. Acabou o <code dir=\"auto\">TThread.Queue</code> espalhado pelo c√≥digo.</li>\n<li><strong>Propaga√ß√£o de Exce√ß√£o:</strong> Se o <code dir=\"auto\">GetProfile</code> falhar, o fluxo pula o <code dir=\"auto\">ThenBy</code> e cai direto no <code dir=\"auto\">OnException</code>. Sem <code dir=\"auto\">try..except</code> poluindo a regra de neg√≥cio.</li>\n</ol>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"a-rede-de-seguran√ßa-cancellation-tokens\">A Rede de Seguran√ßa: Cancellation Tokens</h3><a class=\"sl-anchor-link\" href=\"#a-rede-de-seguran√ßa-cancellation-tokens\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúA Rede de Seguran√ßa: Cancellation Tokens‚Äù</span></a></div>\n<p>Mas e se o usu√°rio fechar o formul√°rio enquanto essas 3 tarefas est√£o rodando? Teremos um <em>Access Violation</em> ao tentar atualizar o <code dir=\"auto\">UserLabel</code>?</p>\n<p>√â aqui que entra a teoria que ensino no Cap√≠tulo 4 do livro: <strong>Cancelamento Cooperativo</strong>.</p>\n<p>O Dext implementa o padr√£o <code dir=\"auto\">ICancellationToken</code> (inspirado no .NET) de forma transparente. Voc√™ pode passar um token para a tarefa, e a cadeia fluente verifica esse token antes de cada etapa.</p>\n<div class=\"expressive-code\"><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#96A1C2\">// Vincula o Token ao ciclo de vida do Form</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#F8F8F2\">FTokenSource := TCancellationTokenSource.Create;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#F8F8F2\">TAsyncTask.Run(...)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">.WithCancellation(FTokenSource.Token) </span><span style=\"--0:#96A1C2\">// A m√°gica acontece aqui</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">.OnComplete(...)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">.Start;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">TFormDashboard.FormDestroy</span><span style=\"--0:#F8F8F2\">(Sender: TObject);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Ao destruir o form, cancela tudo que est√° pendente.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// O Dext impede que o OnComplete (que acessa componentes visuais) seja executado.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">FTokenSource.Cancel;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"// Vincula o Token ao ciclo de vida do FormFTokenSource := TCancellationTokenSource.Create;TAsyncTask.Run(...)  .WithCancellation(FTokenSource.Token) // A m√°gica acontece aqui  .OnComplete(...)  .Start;procedure TFormDashboard.FormDestroy(Sender: TObject);begin  // Ao destruir o form, cancela tudo que est√° pendente.  // O Dext impede que o OnComplete (que acessa componentes visuais) seja executado.  FTokenSource.Cancel;end;\"><div></div></button></div></figure></div>\n<p>Isso resolve um dos bugs mais comuns e dif√≠ceis de rastrear em aplica√ß√µes Delphi Multithread: o <em>callback</em> que tenta acessar um objeto destru√≠do.</p>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"teoria-e-pr√°tica-o-power-duo\">Teoria e Pr√°tica: O ‚ÄúPower Duo‚Äù</h3><a class=\"sl-anchor-link\" href=\"#teoria-e-pr√°tica-o-power-duo\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúTeoria e Pr√°tica: O ‚ÄúPower Duo‚Äù‚Äù</span></a></div>\n<p>O <strong>Dext Framework</strong> entrega a ferramenta pronta para produ√ß√£o. Mas para usar multithreading com maestria, voc√™ precisa entender o que realmente est√° acontecendo. Por que o Pool de Threads √© melhor que criar Threads manuais? O que √© Context Switching? Como funcionam as Primitivas de Sincroniza√ß√£o?</p>\n<p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;../../../assets/delphi_multithreading_desk.png&#x22;,&#x22;alt&#x22;:&#x22;Delphi Multithreading Book&#x22;,&#x22;index&#x22;:0}\"></p>\n<p>√â por isso que digo que o Livro e o Framework formam um par perfeito:</p>\n<ul>\n<li>\n<p>üìò <strong>O Livro (Delphi Multithreading):</strong> Ensina a base, a arquitetura e os ‚Äúporqu√™s‚Äù. O c√≥digo fonte dos exemplos do livro (incluindo a implementa√ß√£o pura do CancellationToken) est√° dispon√≠vel abertamente para estudo.</p>\n</li>\n<li>\n<p><em>Reposit√≥rio (PT):</em> <a href=\"https://github.com/cesarliws/DelphiMultithreadingBookCode\">github.com/cesarliws/DelphiMultithreadingBookCode</a></p>\n</li>\n<li>\n<p><em>Reposit√≥rio (EN):</em> <a href=\"https://github.com/cesarliws/DelphiMultithreadingBookCodeEnglishEdition\">github.com/cesarliws/DelphiMultithreadingBookCodeEnglishEdition</a></p>\n</li>\n<li>\n<p>üöÄ <strong>O Framework (Dext):</strong> Entrega a implementa√ß√£o produtiva, testada e pronta para o dia a dia, aplicando os conceitos do livro em uma API moderna.</p>\n</li>\n</ul>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"conclus√£o\">Conclus√£o</h3><a class=\"sl-anchor-link\" href=\"#conclus√£o\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúConclus√£o‚Äù</span></a></div>\n<p>Cumpri minha promessa feita no CodeRage. O <strong>Fluent Tasks</strong> n√£o √© mais apenas um slide de PowerPoint; √© c√≥digo real que voc√™ pode usar hoje para eliminar a complexidade do seu projeto.</p>\n<p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;../../../assets/delphi_multithreading_mockup_3d.png&#x22;,&#x22;alt&#x22;:&#x22;Delphi Multithreading Book 3D&#x22;,&#x22;index&#x22;:0}\"></p>\n<p>Convido voc√™ a baixar o Dext, testar o <code dir=\"auto\">Dext.Threading.Async</code> e, se quiser dominar a engenharia por tr√°s disso, garantir sua c√≥pia do livro no meu site.</p>\n<p>Documenta√ß√£o Async API: <a href=\"https://github.com/cesarliws/dext/blob/main/Docs/async-api.md\">https://github.com/cesarliws/dext/blob/main/Docs/async-api.md</a></p>\n<p>Baixe o Dext: <a href=\"https://github.com/cesarliws/dext\">https://github.com/cesarliws/dext</a></p>\n<p>Garanta o Livro: <a href=\"https://www.cesarromero.com.br/\">https://www.cesarromero.com.br/</a></p>\n<p>Vamos codar (em paralelo)! üöÄ</p>\n<p>#Delphi #Multithreading #DelphiMultithreadingBook #DextFramework #AsyncProgramming #CodeRage #SoftwareArchitecture #OpenSource</p>",{headings:271,localImagePaths:285,remoteImagePaths:286,frontmatter:287,imagePaths:289},[272,275,278,281,284],{depth:202,slug:273,text:274},"o-problema-a-d√≠vida-da-complexidade","O Problema: A ‚ÄúD√≠vida‚Äù da Complexidade",{depth:202,slug:276,text:277},"a-solu√ß√£o-dext-fluent-async","A Solu√ß√£o: Dext Fluent Async",{depth:202,slug:279,text:280},"a-rede-de-seguran√ßa-cancellation-tokens","A Rede de Seguran√ßa: Cancellation Tokens",{depth:202,slug:282,text:283},"teoria-e-pr√°tica-o-power-duo","Teoria e Pr√°tica: O ‚ÄúPower Duo‚Äù",{depth:202,slug:241,text:242},[263,264,265,266],[],{title:255,description:256,pubDate:288,heroImage:263},"2026-01-12",[263,264,265,266],"en/articles/delphi-async-fluent",{id:290,data:292,body:298,filePath:299,assetImports:300,digest:305,rendered:306},{title:293,description:294,editUrl:16,head:295,template:50,sidebar:296,pagefind:16,draft:37},"Modern Delphi Multithreading: Write Clean and Uncomplicated Asynchronous Code","How I turned the \"Pyramid of Doom\" into an asynchronous symphony with the Dext Framework",[],{hidden:37,attrs:297},{},"![Promised Fulfilled](../../../../assets/hero.png)\r\n\r\nIn 2025, during my talks at **Embarcadero Conference**, **Luso Delphi**, and **CodeRage**, I ended my presentation with a few \"mysterious\" slides (Slides 17 and 18).\r\n\r\nI spoke about the developer's journey: we moved from the manual complexity of `TThread`, evolved to the efficiency of the **PPL (Parallel Programming Library)**, but something was still missing.\r\n\r\nThose who use PPL intensively know the problem. To orchestrate complex pipelines (download data -> process -> save -> update UI), we end up falling into the dreaded **\"Pyramid of Doom\"**: excessive nesting of anonymous methods, repetitive `try..except` blocks, and manual `TThread.Queue` calls to avoid freezing the screen.\r\n\r\nIn that slide, I promised a vision of the future: A fluent interface where asynchronous code could be read like a sentence.\r\n\r\n**The wait is over. The promise has been fulfilled.**\r\n\r\nToday, I officially present `Dext.Threading.Async` ‚Äî the real implementation of that concept, now available in the [Dext Framework](https://github.com/cesarliws/dext).\r\n\r\n### The Problem: The \"Debt\" of Complexity\r\n\r\nIn my book, [\"Delphi Multithreading\"](https://www.cesarromero.com.br/), I dedicate entire chapters to teaching how to protect your threads, avoid *Race Conditions*, and ensure that exceptions don't silently crash your application. This theoretical foundation is non-negotiable.\r\n\r\nHowever, in daily practice, writing all this infrastructure \"by hand\" for every button in your system is exhausting. Look at the traditional pattern:\r\n\r\n```pascal\r\n// The standard way of using PPL\r\nTTask.Run(procedure\r\nbegin\r\n  try\r\n    var Data := DownloadBytes;\r\n    // Nesting...\r\n    TThread.Synchronize(nil, procedure\r\n    begin\r\n       UpdateUI(Data); // What if the Form is already closed? Access Violation.\r\n    end);\r\n  except\r\n    on E: Exception do HandleError(E); // Repetitive boilerplate\r\n  end;\r\nend);\r\n```\r\n\r\n### The Solution: Dext Fluent Async\r\n\r\n![Comparative Concept](../../../../assets/concept_compartion.png)\r\n\r\nWith the new Dext engine, we abstract the complexity of `ITask`, `IFuture`, and exception handling into a declarative syntax.\r\n\r\nLet's look at a real example. Imagine a Dashboard that needs to load 3 heavy panels simultaneously when opening the screen. If we did this sequentially, the user would wait for the sum of the times. With Dext, we fire them in parallel and the code remains clean:\r\n\r\n```pascal\r\nuses Dext.Threading.Async;\r\n\r\nprocedure TFormDashboard.LoadDashboard;\r\nbegin\r\n  // 1. Load User Profile (I/O Bound)\r\n  // Fire and forget complexity. Dext manages the thread.\r\n  var Task1 := TAsyncTask.Run<TUserProfile>(\r\n    function: TUserProfile\r\n    begin\r\n      // Executes in Background Thread Pool\r\n      Result := UserService.GetProfile(Self.UserId); \r\n    end)\r\n    .ThenBy(procedure(User: TUserProfile)\r\n    begin\r\n      // Executes additional background processing if necessary\r\n      LogAccess(User);\r\n    end)\r\n    .OnComplete(procedure(User: TUserProfile)\r\n    begin\r\n      // AUTOMATICALLY executes on the Main Thread (safe for VCL/FMX)\r\n      UserLabel.Caption := 'Welcome, ' + User.Name;\r\n      imgAvatar.Bitmap := User.Avatar;\r\n    end)\r\n    .OnException(procedure(E: Exception)\r\n    begin\r\n      // Centralized error handling on Main Thread\r\n      ShowMessage('Error loading profile: ' + E.Message);\r\n    end)\r\n    .Start; // Starts execution\r\n\r\n  // 2. Load Financial Chart (CPU Bound)\r\n  // Executes in PARALLEL to the previous one\r\n  var Task2 := TAsyncTask.Run<TFinancialData>(\r\n    function: TFinancialData\r\n    begin\r\n      // Automatically checks for cancellation before starting\r\n      Result := FinanceService.CalculateHeavyMetrics(CurrentYear);\r\n    end)\r\n    .OnComplete(procedure(Data: TFinancialData)\r\n    begin\r\n      ChartSales.Series[0].Add(Data.Values);\r\n    end)\r\n    .Start;\r\n    \r\n  // 3. Update Notifications\r\n  var Task3 := TAsyncTask.Run<Integer>(\r\n    function: Integer\r\n    begin\r\n      Result := NotificationService.CountUnread;\r\n    end)\r\n    .OnComplete(procedure(Count: Integer)\r\n    begin\r\n      Badge.Text := Count.ToString;\r\n      Badge.Visible := Count > 0;\r\n    end)\r\n    .Start;\r\n\r\n  // Wait for all tasks to complete\r\n  TAsyncTask.WaitForAll([Task1, Task2, Task3]);\r\nend;\r\n```\r\n\r\n**What do we gain here?**\r\n\r\n1.  **Readability:** We read the code from top to bottom, like a story.\r\n2.  **Thread Safety:** `OnComplete` and `OnException` guarantee synchronization with the Main Thread or calling thread. No more `TThread.Queue` scattered throughout the code.\r\n3.  **Exception Propagation:** If `GetProfile` fails, the flow skips `ThenBy` and goes straight to `OnException`. No `try..except` polluting the business logic.\r\n\r\n### The Safety Net: Cancellation Tokens\r\n\r\nBut what if the user closes the form while these 3 tasks are running? Will we have an *Access Violation* when trying to update the `UserLabel`?\r\n\r\nThis is where the theory I teach in Chapter 4 of the book comes in: **Cooperative Cancellation**.\r\n\r\nDext implements the `ICancellationToken` pattern (inspired by .NET) seamlessly. You can pass a token to the task, and the fluent chain checks that token before each step.\r\n\r\n```pascal\r\n// Binds the Token to the Form's lifecycle\r\nFTokenSource := TCancellationTokenSource.Create;\r\n\r\nTAsyncTask.Run(...)\r\n  .WithCancellation(FTokenSource.Token) // The magic happens here\r\n  .OnComplete(...) \r\n  .Start;\r\n\r\nprocedure TFormDashboard.FormDestroy(Sender: TObject);\r\nbegin\r\n  // When destroying the form, cancel everything pending.\r\n  // Dext prevents OnComplete (which accesses visual components) from executing.\r\n  FTokenSource.Cancel; \r\nend;\r\n```\r\n\r\nThis solves one of the most common and hard-to-track bugs in Delphi Multithread applications: the *callback* trying to access a destroyed object.\r\n\r\n### Theory and Practice: The \"Power Duo\"\r\n\r\nThe **Dext Framework** delivers the tool ready for production. But to use multithreading masterfully, you need to understand what is really happening. Why is the Thread Pool better than creating manual Threads? What is Context Switching? How do Synchronization Primitives work?\r\n\r\n![Delphi Multithreading Book](../../../../assets/delphi_multithreading_desk.png)\r\n\r\nThat's why I say the Book and the Framework make a perfect pair:\r\n\r\n*   üìò **The Book (Delphi Multithreading):** Teaches the foundation, architecture, and \"whys\". The source code for the book's examples (including the pure implementation of CancellationToken) is openly available for study.\r\n    *   *Repository (PT):* [github.com/cesarliws/DelphiMultithreadingBookCode](https://github.com/cesarliws/DelphiMultithreadingBookCode)\r\n    *   *Repository (EN):* [github.com/cesarliws/DelphiMultithreadingBookCodeEnglishEdition](https://github.com/cesarliws/DelphiMultithreadingBookCodeEnglishEdition)\r\n\r\n*   üöÄ **The Framework (Dext):** Delivers the productive implementation, tested and ready for daily use, applying the book's concepts in a modern API.\r\n\r\n### Conclusion\r\n\r\nI fulfilled my promise made at CodeRage. **Fluent Tasks** is no longer just a PowerPoint slide; it's real code you can use today to eliminate complexity from your project.\r\n\r\n![Delphi Multithreading Book 3D](../../../../assets/delphi_multithreading_mockup_3d.png)\r\n\r\nI invite you to download Dext, test `Dext.Threading.Async`, and if you want to master the engineering behind it, secure your copy of the book on my site.\r\n\r\nAsync API Documentation: https://github.com/cesarliws/dext/blob/main/Docs/async-api.md\r\n\r\nDownload Dext: https://github.com/cesarliws/dext\r\n\r\nGet the Book: https://www.cesarromero.com.br/\r\n\r\nLet's code (in parallel)! üöÄ\r\n\r\n#Delphi #Multithreading #DelphiMultithreadingBook #DextFramework #AsyncProgramming #CodeRage #SoftwareArchitecture #OpenSource","src/content/docs/en/articles/delphi-async-fluent.md",[301,302,303,304],"../../../../assets/hero.png","../../../../assets/concept_compartion.png","../../../../assets/delphi_multithreading_desk.png","../../../../assets/delphi_multithreading_mockup_3d.png","b115c8e410bb4173",{html:307,metadata:308},"<p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;../../../../assets/hero.png&#x22;,&#x22;alt&#x22;:&#x22;Promised Fulfilled&#x22;,&#x22;index&#x22;:0}\"></p>\n<p>In 2025, during my talks at <strong>Embarcadero Conference</strong>, <strong>Luso Delphi</strong>, and <strong>CodeRage</strong>, I ended my presentation with a few ‚Äúmysterious‚Äù slides (Slides 17 and 18).</p>\n<p>I spoke about the developer‚Äôs journey: we moved from the manual complexity of <code dir=\"auto\">TThread</code>, evolved to the efficiency of the <strong>PPL (Parallel Programming Library)</strong>, but something was still missing.</p>\n<p>Those who use PPL intensively know the problem. To orchestrate complex pipelines (download data -> process -> save -> update UI), we end up falling into the dreaded <strong>‚ÄúPyramid of Doom‚Äù</strong>: excessive nesting of anonymous methods, repetitive <code dir=\"auto\">try..except</code> blocks, and manual <code dir=\"auto\">TThread.Queue</code> calls to avoid freezing the screen.</p>\n<p>In that slide, I promised a vision of the future: A fluent interface where asynchronous code could be read like a sentence.</p>\n<p><strong>The wait is over. The promise has been fulfilled.</strong></p>\n<p>Today, I officially present <code dir=\"auto\">Dext.Threading.Async</code> ‚Äî the real implementation of that concept, now available in the <a href=\"https://github.com/cesarliws/dext\">Dext Framework</a>.</p>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"the-problem-the-debt-of-complexity\">The Problem: The ‚ÄúDebt‚Äù of Complexity</h3><a class=\"sl-anchor-link\" href=\"#the-problem-the-debt-of-complexity\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Section titled ‚ÄúThe Problem: The ‚ÄúDebt‚Äù of Complexity‚Äù</span></a></div>\n<p>In my book, <a href=\"https://www.cesarromero.com.br/\">‚ÄúDelphi Multithreading‚Äù</a>, I dedicate entire chapters to teaching how to protect your threads, avoid <em>Race Conditions</em>, and ensure that exceptions don‚Äôt silently crash your application. This theoretical foundation is non-negotiable.</p>\n<p>However, in daily practice, writing all this infrastructure ‚Äúby hand‚Äù for every button in your system is exhausting. Look at the traditional pattern:</p>\n<div class=\"expressive-code\"><link rel=\"stylesheet\" href=\"/_astro/ec.2f3rl.css\"><script type=\"module\" src=\"/_astro/ec.0vx5m.js\"></script><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#96A1C2\">// The standard way of using PPL</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#F8F8F2\">TTask.Run(procedure</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">try</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Data := DownloadBytes;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#96A1C2\">// Nesting...</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">TThread.Synchronize(</span><span style=\"--0:#BD93F9\">nil</span><span style=\"--0:#F8F8F2\">, procedure</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">       </span></span><span style=\"--0:#F8F8F2\">UpdateUI(Data); </span><span style=\"--0:#96A1C2\">// What if the Form is already closed? Access Violation.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">except</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">on</span><span style=\"--0:#F8F8F2\"> E: Exception </span><span style=\"--0:#FF79C6\">do</span><span style=\"--0:#F8F8F2\"> HandleError(E); </span><span style=\"--0:#96A1C2\">// Repetitive boilerplate</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">);</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"// The standard way of using PPLTTask.Run(procedurebegin  try    var Data := DownloadBytes;    // Nesting...    TThread.Synchronize(nil, procedure    begin       UpdateUI(Data); // What if the Form is already closed? Access Violation.    end);  except    on E: Exception do HandleError(E); // Repetitive boilerplate  end;end);\"><div></div></button></div></figure></div>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"the-solution-dext-fluent-async\">The Solution: Dext Fluent Async</h3><a class=\"sl-anchor-link\" href=\"#the-solution-dext-fluent-async\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Section titled ‚ÄúThe Solution: Dext Fluent Async‚Äù</span></a></div>\n<p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;../../../../assets/concept_compartion.png&#x22;,&#x22;alt&#x22;:&#x22;Comparative Concept&#x22;,&#x22;index&#x22;:0}\"></p>\n<p>With the new Dext engine, we abstract the complexity of <code dir=\"auto\">ITask</code>, <code dir=\"auto\">IFuture</code>, and exception handling into a declarative syntax.</p>\n<p>Let‚Äôs look at a real example. Imagine a Dashboard that needs to load 3 heavy panels simultaneously when opening the screen. If we did this sequentially, the user would wait for the sum of the times. With Dext, we fire them in parallel and the code remains clean:</p>\n<div class=\"expressive-code\"><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">uses</span><span style=\"--0:#F8F8F2\"> Dext.Threading.</span><span style=\"--0:#FF79C6\">Async</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">TFormDashboard.LoadDashboard</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// 1. Load User Profile (I/O Bound)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Fire and forget complexity. Dext manages the thread.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Task1 := TAsyncTask.Run&#x3C;TUserProfile>(</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">function: TUserProfile</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#96A1C2\">// Executes in Background Thread Pool</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#FF79C6\">Result</span><span style=\"--0:#F8F8F2\"> := UserService.GetProfile(Self.UserId);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.ThenBy(procedure(User: TUserProfile)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#96A1C2\">// Executes additional background processing if necessary</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">LogAccess(User);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.OnComplete(procedure(User: TUserProfile)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#96A1C2\">// AUTOMATICALLY executes on the Main Thread (safe for VCL/FMX)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">UserLabel.Caption := </span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Welcome, </span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\"> + User.</span><span style=\"--0:#FF79C6\">Name</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">imgAvatar.Bitmap := User.Avatar;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.OnException(procedure(E: Exception)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#96A1C2\">// Centralized error handling on Main Thread</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">ShowMessage(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Error loading profile: </span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\"> + E.</span><span style=\"--0:#FF79C6\">Message</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.Start; </span><span style=\"--0:#96A1C2\">// Starts execution</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// 2. Load Financial Chart (CPU Bound)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Executes in PARALLEL to the previous one</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Task2 := TAsyncTask.Run&#x3C;TFinancialData>(</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">function: TFinancialData</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#96A1C2\">// Automatically checks for cancellation before starting</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#FF79C6\">Result</span><span style=\"--0:#F8F8F2\"> := FinanceService.CalculateHeavyMetrics(CurrentYear);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.OnComplete(procedure(Data: TFinancialData)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">ChartSales.Series[</span><span style=\"--0:#BD93F9\">0</span><span style=\"--0:#F8F8F2\">].</span><span style=\"--0:#FF79C6\">Add</span><span style=\"--0:#F8F8F2\">(Data.Values);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.Start;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// 3. Update Notifications</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Task3 := TAsyncTask.Run&#x3C;</span><span style=\"--0:#FF79C6\">Integer</span><span style=\"--0:#F8F8F2\">>(</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">function: </span><span style=\"--0:#FF79C6\">Integer</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#FF79C6\">Result</span><span style=\"--0:#F8F8F2\"> := NotificationService.CountUnread;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.OnComplete(procedure(Count: </span><span style=\"--0:#FF79C6\">Integer</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">Badge.Text := Count.ToString;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">Badge.Visible := Count > </span><span style=\"--0:#BD93F9\">0</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.Start;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Wait for all tasks to complete</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">TAsyncTask.WaitForAll([Task1, Task2, Task3]);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"uses Dext.Threading.Async;procedure TFormDashboard.LoadDashboard;begin  // 1. Load User Profile (I/O Bound)  // Fire and forget complexity. Dext manages the thread.  var Task1 := TAsyncTask.Run<TUserProfile>(    function: TUserProfile    begin      // Executes in Background Thread Pool      Result := UserService.GetProfile(Self.UserId);    end)    .ThenBy(procedure(User: TUserProfile)    begin      // Executes additional background processing if necessary      LogAccess(User);    end)    .OnComplete(procedure(User: TUserProfile)    begin      // AUTOMATICALLY executes on the Main Thread (safe for VCL/FMX)      UserLabel.Caption := &#x27;Welcome, &#x27; + User.Name;      imgAvatar.Bitmap := User.Avatar;    end)    .OnException(procedure(E: Exception)    begin      // Centralized error handling on Main Thread      ShowMessage(&#x27;Error loading profile: &#x27; + E.Message);    end)    .Start; // Starts execution  // 2. Load Financial Chart (CPU Bound)  // Executes in PARALLEL to the previous one  var Task2 := TAsyncTask.Run<TFinancialData>(    function: TFinancialData    begin      // Automatically checks for cancellation before starting      Result := FinanceService.CalculateHeavyMetrics(CurrentYear);    end)    .OnComplete(procedure(Data: TFinancialData)    begin      ChartSales.Series[0].Add(Data.Values);    end)    .Start;  // 3. Update Notifications  var Task3 := TAsyncTask.Run<Integer>(    function: Integer    begin      Result := NotificationService.CountUnread;    end)    .OnComplete(procedure(Count: Integer)    begin      Badge.Text := Count.ToString;      Badge.Visible := Count > 0;    end)    .Start;  // Wait for all tasks to complete  TAsyncTask.WaitForAll([Task1, Task2, Task3]);end;\"><div></div></button></div></figure></div>\n<p><strong>What do we gain here?</strong></p>\n<ol>\n<li><strong>Readability:</strong> We read the code from top to bottom, like a story.</li>\n<li><strong>Thread Safety:</strong> <code dir=\"auto\">OnComplete</code> and <code dir=\"auto\">OnException</code> guarantee synchronization with the Main Thread or calling thread. No more <code dir=\"auto\">TThread.Queue</code> scattered throughout the code.</li>\n<li><strong>Exception Propagation:</strong> If <code dir=\"auto\">GetProfile</code> fails, the flow skips <code dir=\"auto\">ThenBy</code> and goes straight to <code dir=\"auto\">OnException</code>. No <code dir=\"auto\">try..except</code> polluting the business logic.</li>\n</ol>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"the-safety-net-cancellation-tokens\">The Safety Net: Cancellation Tokens</h3><a class=\"sl-anchor-link\" href=\"#the-safety-net-cancellation-tokens\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Section titled ‚ÄúThe Safety Net: Cancellation Tokens‚Äù</span></a></div>\n<p>But what if the user closes the form while these 3 tasks are running? Will we have an <em>Access Violation</em> when trying to update the <code dir=\"auto\">UserLabel</code>?</p>\n<p>This is where the theory I teach in Chapter 4 of the book comes in: <strong>Cooperative Cancellation</strong>.</p>\n<p>Dext implements the <code dir=\"auto\">ICancellationToken</code> pattern (inspired by .NET) seamlessly. You can pass a token to the task, and the fluent chain checks that token before each step.</p>\n<div class=\"expressive-code\"><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#96A1C2\">// Binds the Token to the Form's lifecycle</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#F8F8F2\">FTokenSource := TCancellationTokenSource.Create;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#F8F8F2\">TAsyncTask.Run(...)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">.WithCancellation(FTokenSource.Token) </span><span style=\"--0:#96A1C2\">// The magic happens here</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">.OnComplete(...)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">.Start;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">TFormDashboard.FormDestroy</span><span style=\"--0:#F8F8F2\">(Sender: TObject);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// When destroying the form, cancel everything pending.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Dext prevents OnComplete (which accesses visual components) from executing.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">FTokenSource.Cancel;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"// Binds the Token to the Form&#x27;s lifecycleFTokenSource := TCancellationTokenSource.Create;TAsyncTask.Run(...)  .WithCancellation(FTokenSource.Token) // The magic happens here  .OnComplete(...)  .Start;procedure TFormDashboard.FormDestroy(Sender: TObject);begin  // When destroying the form, cancel everything pending.  // Dext prevents OnComplete (which accesses visual components) from executing.  FTokenSource.Cancel;end;\"><div></div></button></div></figure></div>\n<p>This solves one of the most common and hard-to-track bugs in Delphi Multithread applications: the <em>callback</em> trying to access a destroyed object.</p>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"theory-and-practice-the-power-duo\">Theory and Practice: The ‚ÄúPower Duo‚Äù</h3><a class=\"sl-anchor-link\" href=\"#theory-and-practice-the-power-duo\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Section titled ‚ÄúTheory and Practice: The ‚ÄúPower Duo‚Äù‚Äù</span></a></div>\n<p>The <strong>Dext Framework</strong> delivers the tool ready for production. But to use multithreading masterfully, you need to understand what is really happening. Why is the Thread Pool better than creating manual Threads? What is Context Switching? How do Synchronization Primitives work?</p>\n<p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;../../../../assets/delphi_multithreading_desk.png&#x22;,&#x22;alt&#x22;:&#x22;Delphi Multithreading Book&#x22;,&#x22;index&#x22;:0}\"></p>\n<p>That‚Äôs why I say the Book and the Framework make a perfect pair:</p>\n<ul>\n<li>\n<p>üìò <strong>The Book (Delphi Multithreading):</strong> Teaches the foundation, architecture, and ‚Äúwhys‚Äù. The source code for the book‚Äôs examples (including the pure implementation of CancellationToken) is openly available for study.</p>\n<ul>\n<li><em>Repository (PT):</em> <a href=\"https://github.com/cesarliws/DelphiMultithreadingBookCode\">github.com/cesarliws/DelphiMultithreadingBookCode</a></li>\n<li><em>Repository (EN):</em> <a href=\"https://github.com/cesarliws/DelphiMultithreadingBookCodeEnglishEdition\">github.com/cesarliws/DelphiMultithreadingBookCodeEnglishEdition</a></li>\n</ul>\n</li>\n<li>\n<p>üöÄ <strong>The Framework (Dext):</strong> Delivers the productive implementation, tested and ready for daily use, applying the book‚Äôs concepts in a modern API.</p>\n</li>\n</ul>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"conclusion\">Conclusion</h3><a class=\"sl-anchor-link\" href=\"#conclusion\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Section titled ‚ÄúConclusion‚Äù</span></a></div>\n<p>I fulfilled my promise made at CodeRage. <strong>Fluent Tasks</strong> is no longer just a PowerPoint slide; it‚Äôs real code you can use today to eliminate complexity from your project.</p>\n<p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;../../../../assets/delphi_multithreading_mockup_3d.png&#x22;,&#x22;alt&#x22;:&#x22;Delphi Multithreading Book 3D&#x22;,&#x22;index&#x22;:0}\"></p>\n<p>I invite you to download Dext, test <code dir=\"auto\">Dext.Threading.Async</code>, and if you want to master the engineering behind it, secure your copy of the book on my site.</p>\n<p>Async API Documentation: <a href=\"https://github.com/cesarliws/dext/blob/main/Docs/async-api.md\">https://github.com/cesarliws/dext/blob/main/Docs/async-api.md</a></p>\n<p>Download Dext: <a href=\"https://github.com/cesarliws/dext\">https://github.com/cesarliws/dext</a></p>\n<p>Get the Book: <a href=\"https://www.cesarromero.com.br/\">https://www.cesarromero.com.br/</a></p>\n<p>Let‚Äôs code (in parallel)! üöÄ</p>\n<p>#Delphi #Multithreading #DelphiMultithreadingBook #DextFramework #AsyncProgramming #CodeRage #SoftwareArchitecture #OpenSource</p>",{headings:309,localImagePaths:325,remoteImagePaths:326,frontmatter:327,imagePaths:328},[310,313,316,319,322],{depth:202,slug:311,text:312},"the-problem-the-debt-of-complexity","The Problem: The ‚ÄúDebt‚Äù of Complexity",{depth:202,slug:314,text:315},"the-solution-dext-fluent-async","The Solution: Dext Fluent Async",{depth:202,slug:317,text:318},"the-safety-net-cancellation-tokens","The Safety Net: Cancellation Tokens",{depth:202,slug:320,text:321},"theory-and-practice-the-power-duo","Theory and Practice: The ‚ÄúPower Duo‚Äù",{depth:202,slug:323,text:324},"conclusion","Conclusion",[301,302,303,304],[],{title:293,description:294,pubDate:288,heroImage:301},[301,302,303,304],"es/articles/delphi-async-fluent",{id:329,data:331,body:337,filePath:338,assetImports:339,digest:340,rendered:341},{title:332,description:333,editUrl:16,head:334,template:50,sidebar:335,pagefind:16,draft:37},"Delphi Multithreading Moderno: Escriba C√≥digo As√≠ncrono Limpio y sin Complicaciones","C√≥mo transform√© la \"Pyramid of Doom\" en una sinfon√≠a as√≠ncrona con Dext Framework",[],{hidden:37,attrs:336},{},"![Promesa Cumplida](../../../../assets/hero.png)\r\n\r\nEn 2025, durante mis charlas en **Embarcadero Conference**, **Luso Delphi** y **CodeRage**, termin√© mi presentaci√≥n con unas diapositivas \"misteriosas\" (Diapositivas 17 y 18).\r\n\r\nHabl√© sobre el viaje del desarrollador: salimos de la complejidad manual de `TThread`, evolucionamos a la eficiencia de la **PPL (Parallel Programming Library)**, pero a√∫n faltaba algo.\r\n\r\nQuienes usan PPL intensivamente conocen el problema. Para orquestar pipelines complejos (descargar datos -> procesar -> guardar -> actualizar UI), terminamos cayendo en la temida **\"Pyramid of Doom\"**: anidamiento excesivo de m√©todos an√≥nimos, bloques `try..except` repetitivos y llamadas manuales a `TThread.Queue` para no congelar la pantalla.\r\n\r\nEn esa diapositiva, promet√≠ una visi√≥n de futuro: Una interfaz fluida donde el c√≥digo as√≠ncrono pudiera leerse como una frase.\r\n\r\n**La espera ha terminado. La promesa se ha cumplido.**\r\n\r\nHoy, presento oficialmente `Dext.Threading.Async` ‚Äî la implementaci√≥n real de ese concepto, ahora disponible en [Dext Framework](https://github.com/cesarliws/dext).\r\n\r\n### El Problema: La \"Deuda\" de la Complejidad\r\n\r\nEn mi libro, [\"Delphi Multithreading\"](https://www.cesarromero.com.br/), dedico cap√≠tulos enteros a ense√±ar c√≥mo proteger sus hilos, evitar *Race Conditions* y garantizar que las excepciones no derriben su aplicaci√≥n silenciosamente. Esta base te√≥rica es innegociable.\r\n\r\nSin embargo, en el d√≠a a d√≠a, escribir toda esta infraestructura \"a mano\" para cada bot√≥n de su sistema es agotador. Vea el patr√≥n tradicional:\r\n\r\n```pascal\r\n// La forma est√°ndar de usar PPL\r\nTTask.Run(procedure\r\nbegin\r\n  try\r\n    var Datos := DescargarBytes;\r\n    // Anidamiento...\r\n    TThread.Synchronize(nil, procedure\r\n    begin\r\n       ActualizarUI(Datos); // ¬øY si el Form ya se cerr√≥? Access Violation.\r\n    end);\r\n  except\r\n    on E: Exception do ManejarError(E); // Boilerplate repetitivo\r\n  end;\r\nend);\r\n```\r\n\r\n### La Soluci√≥n: Dext Fluent Async\r\n\r\n![Comparative Concept](../../../../assets/concept_compartion.png)\r\n\r\nCon el nuevo motor de Dext, abstraemos la complejidad de `ITask`, `IFuture` y el manejo de excepciones en una sintaxis declarativa.\r\n\r\n¬øVamos a un ejemplo real? Imagine un Dashboard que necesita cargar 3 paneles pesados simult√°neamente al abrir la pantalla. Si lo hici√©ramos secuencialmente, el usuario esperar√≠a la suma de los tiempos. Con Dext, disparamos en paralelo y el c√≥digo permanece limpio:\r\n\r\n```pascal\r\nuses Dext.Threading.Async;\r\n\r\nprocedure TFormDashboard.LoadDashboard;\r\nbegin\r\n  // 1. Carga el Perfil del Usuario (I/O Bound)\r\n  // Dispara y olvida la complejidad. Dext gestiona el hilo.\r\n  var Task1 := TAsyncTask.Run<TUserProfile>(\r\n    function: TUserProfile\r\n    begin\r\n      // Ejecuta en Background Thread Pool\r\n      Result := UserService.GetProfile(Self.UserId); \r\n    end)\r\n    .ThenBy(procedure(User: TUserProfile)\r\n    begin\r\n      // Ejecuta procesamiento adicional en background si es necesario\r\n      LogAcceso(User);\r\n    end)\r\n    .OnComplete(procedure(User: TUserProfile)\r\n    begin\r\n      // Ejecuta AUTOM√ÅTICAMENTE en el Main Thread (seguro para VCL/FMX)\r\n      UserLabel.Caption := 'Bienvenido, ' + User.Name;\r\n      imgAvatar.Bitmap := User.Avatar;\r\n    end)\r\n    .OnException(procedure(E: Exception)\r\n    begin\r\n      // Manejo centralizado de errores en el Main Thread\r\n      ShowMessage('Error al cargar perfil: ' + E.Message);\r\n    end)\r\n    .Start; // Inicia la ejecuci√≥n\r\n\r\n  // 2. Carga Gr√°fico Financiero (CPU Bound)\r\n  // Ejecuta en PARALELO al anterior\r\n  var Task2 := TAsyncTask.Run<TFinancialData>(\r\n    function: TFinancialData\r\n    begin\r\n      // Verifica cancelaci√≥n autom√°ticamente antes de comenzar\r\n      Result := FinanceService.CalculateHeavyMetrics(CurrentYear);\r\n    end)\r\n    .OnComplete(procedure(Data: TFinancialData)\r\n    begin\r\n      ChartSales.Series[0].Add(Data.Values);\r\n    end)\r\n    .Start;\r\n    \r\n  // 3. Actualiza Notificaciones\r\n  var Task3 := TAsyncTask.Run<Integer>(\r\n    function: Integer\r\n    begin\r\n      Result := NotificationService.CountUnread;\r\n    end)\r\n    .OnComplete(procedure(Count: Integer)\r\n    begin\r\n      Badge.Text := Count.ToString;\r\n      Badge.Visible := Count > 0;\r\n    end)\r\n    .Start;\r\n\r\n  // Espera a que terminen todas las tareas\r\n  TAsyncTask.WaitForAll([Task1, Task2, Task3]);\r\nend;\r\n```\r\n\r\n**¬øQu√© ganamos aqu√≠?**\r\n\r\n1.  **Legibilidad:** Leemos el c√≥digo de arriba a abajo, como una historia.\r\n2.  **Seguridad de Hilo:** `OnComplete` y `OnException` ya garantizan la sincronizaci√≥n con el Main Thread o hilo llamador. Se acab√≥ el `TThread.Queue` disperso por el c√≥digo.\r\n3.  **Propagaci√≥n de Excepci√≥n:** Si `GetProfile` falla, el flujo salta el `ThenBy` y cae directo en `OnException`. Sin `try..except` contaminando la regla de negocio.\r\n\r\n### La Red de Seguridad: Cancellation Tokens\r\n\r\n¬øPero y si el usuario cierra el formulario mientras estas 3 tareas se est√°n ejecutando? ¬øTendremos un *Access Violation* al intentar actualizar el `UserLabel`?\r\n\r\nEs aqu√≠ donde entra la teor√≠a que ense√±o en el Cap√≠tulo 4 del libro: **Cancelaci√≥n Cooperativa**.\r\n\r\nDext implementa el patr√≥n `ICancellationToken` (inspirado en .NET) de forma transparente. Puede pasar un token a la tarea, y la cadena fluida verifica ese token antes de cada paso.\r\n\r\n```pascal\r\n// Vincula el Token al ciclo de vida del Form\r\nFTokenSource := TCancellationTokenSource.Create;\r\n\r\nTAsyncTask.Run(...)\r\n  .WithCancellation(FTokenSource.Token) // La magia sucede aqu√≠\r\n  .OnComplete(...) \r\n  .Start;\r\n\r\nprocedure TFormDashboard.FormDestroy(Sender: TObject);\r\nbegin\r\n  // Al destruir el form, cancela todo lo que est√° pendiente.\r\n  // Dext impide que el OnComplete (que accede a componentes visuales) se ejecute.\r\n  FTokenSource.Cancel; \r\nend;\r\n```\r\n\r\nEsto resuelve uno de los errores m√°s comunes y dif√≠ciles de rastrear en aplicaciones Delphi Multithread: el *callback* que intenta acceder a un objeto destruido.\r\n\r\n### Teor√≠a y Pr√°ctica: El \"Power Duo\"\r\n\r\nEl **Dext Framework** entrega la herramienta lista para producci√≥n. Pero para usar multithreading con maestr√≠a, necesita entender lo que realmente est√° sucediendo. ¬øPor qu√© el Pool de Hilos es mejor que crear Hilos manuales? ¬øQu√© es Context Switching? ¬øC√≥mo funcionan las Primitivas de Sincronizaci√≥n?\r\n\r\n![Delphi Multithreading Book](../../../../assets/delphi_multithreading_desk.png)\r\n\r\nEs por eso que digo que el Libro y el Framework forman un par perfecto:\r\n\r\n*   üìò **El Libro (Delphi Multithreading):** Ense√±a la base, la arquitectura y los \"porqu√©s\". El c√≥digo fuente de los ejemplos del libro (incluyendo la implementaci√≥n pura del CancellationToken) est√° disponible abiertamente para estudio.\r\n    *   *Repositorio (PT):* [github.com/cesarliws/DelphiMultithreadingBookCode](https://github.com/cesarliws/DelphiMultithreadingBookCode)\r\n    *   *Repositorio (EN):* [github.com/cesarliws/DelphiMultithreadingBookCodeEnglishEdition](https://github.com/cesarliws/DelphiMultithreadingBookCodeEnglishEdition)\r\n\r\n*   üöÄ **El Framework (Dext):** Entrega la implementaci√≥n productiva, probada y lista para el d√≠a a d√≠a, aplicando los conceptos del libro en una API moderna.\r\n\r\n### Conclusi√≥n\r\n\r\nCumpl√≠ mi promesa hecha en CodeRage. **Fluent Tasks** ya no es solo una diapositiva de PowerPoint; es c√≥digo real que puede usar hoy para eliminar la complejidad de su proyecto.\r\n\r\n![Delphi Multithreading Book 3D](../../../../assets/delphi_multithreading_mockup_3d.png)\r\n\r\nLo invito a descargar Dext, probar `Dext.Threading.Async` y, si quiere dominar la ingenier√≠a detr√°s de esto, asegurar su copia del libro en mi sitio.\r\n\r\nDocumentaci√≥n Async API: https://github.com/cesarliws/dext/blob/main/Docs/async-api.md\r\n\r\nDescargue Dext: https://github.com/cesarliws/dext\r\n\r\nAsegure el Libro: https://www.cesarromero.com.br/\r\n\r\n¬°Vamos a programar (en paralelo)! üöÄ\r\n\r\n#Delphi #Multithreading #DelphiMultithreadingBook #DextFramework #AsyncProgramming #CodeRage #SoftwareArchitecture #OpenSource","src/content/docs/es/articles/delphi-async-fluent.md",[301,302,303,304],"74e4e988636f8289",{html:342,metadata:343},"<p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;../../../../assets/hero.png&#x22;,&#x22;alt&#x22;:&#x22;Promesa Cumplida&#x22;,&#x22;index&#x22;:0}\"></p>\n<p>En 2025, durante mis charlas en <strong>Embarcadero Conference</strong>, <strong>Luso Delphi</strong> y <strong>CodeRage</strong>, termin√© mi presentaci√≥n con unas diapositivas ‚Äúmisteriosas‚Äù (Diapositivas 17 y 18).</p>\n<p>Habl√© sobre el viaje del desarrollador: salimos de la complejidad manual de <code dir=\"auto\">TThread</code>, evolucionamos a la eficiencia de la <strong>PPL (Parallel Programming Library)</strong>, pero a√∫n faltaba algo.</p>\n<p>Quienes usan PPL intensivamente conocen el problema. Para orquestar pipelines complejos (descargar datos -> procesar -> guardar -> actualizar UI), terminamos cayendo en la temida <strong>‚ÄúPyramid of Doom‚Äù</strong>: anidamiento excesivo de m√©todos an√≥nimos, bloques <code dir=\"auto\">try..except</code> repetitivos y llamadas manuales a <code dir=\"auto\">TThread.Queue</code> para no congelar la pantalla.</p>\n<p>En esa diapositiva, promet√≠ una visi√≥n de futuro: Una interfaz fluida donde el c√≥digo as√≠ncrono pudiera leerse como una frase.</p>\n<p><strong>La espera ha terminado. La promesa se ha cumplido.</strong></p>\n<p>Hoy, presento oficialmente <code dir=\"auto\">Dext.Threading.Async</code> ‚Äî la implementaci√≥n real de ese concepto, ahora disponible en <a href=\"https://github.com/cesarliws/dext\">Dext Framework</a>.</p>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"el-problema-la-deuda-de-la-complejidad\">El Problema: La ‚ÄúDeuda‚Äù de la Complejidad</h3><a class=\"sl-anchor-link\" href=\"#el-problema-la-deuda-de-la-complejidad\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Secci√≥n titulada ¬´El Problema: La ‚ÄúDeuda‚Äù de la Complejidad¬ª</span></a></div>\n<p>En mi libro, <a href=\"https://www.cesarromero.com.br/\">‚ÄúDelphi Multithreading‚Äù</a>, dedico cap√≠tulos enteros a ense√±ar c√≥mo proteger sus hilos, evitar <em>Race Conditions</em> y garantizar que las excepciones no derriben su aplicaci√≥n silenciosamente. Esta base te√≥rica es innegociable.</p>\n<p>Sin embargo, en el d√≠a a d√≠a, escribir toda esta infraestructura ‚Äúa mano‚Äù para cada bot√≥n de su sistema es agotador. Vea el patr√≥n tradicional:</p>\n<div class=\"expressive-code\"><link rel=\"stylesheet\" href=\"/_astro/ec.2f3rl.css\"><script type=\"module\" src=\"/_astro/ec.0vx5m.js\"></script><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#96A1C2\">// La forma est√°ndar de usar PPL</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#F8F8F2\">TTask.Run(procedure</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">try</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Datos := DescargarBytes;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#96A1C2\">// Anidamiento...</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">TThread.Synchronize(</span><span style=\"--0:#BD93F9\">nil</span><span style=\"--0:#F8F8F2\">, procedure</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">       </span></span><span style=\"--0:#F8F8F2\">ActualizarUI(Datos); </span><span style=\"--0:#96A1C2\">// ¬øY si el Form ya se cerr√≥? Access Violation.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">except</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">on</span><span style=\"--0:#F8F8F2\"> E: Exception </span><span style=\"--0:#FF79C6\">do</span><span style=\"--0:#F8F8F2\"> ManejarError(E); </span><span style=\"--0:#96A1C2\">// Boilerplate repetitivo</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">);</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copiar al portapapeles\" data-copied=\"¬°Copiado!\" data-code=\"// La forma est√°ndar de usar PPLTTask.Run(procedurebegin  try    var Datos := DescargarBytes;    // Anidamiento...    TThread.Synchronize(nil, procedure    begin       ActualizarUI(Datos); // ¬øY si el Form ya se cerr√≥? Access Violation.    end);  except    on E: Exception do ManejarError(E); // Boilerplate repetitivo  end;end);\"><div></div></button></div></figure></div>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"la-soluci√≥n-dext-fluent-async\">La Soluci√≥n: Dext Fluent Async</h3><a class=\"sl-anchor-link\" href=\"#la-soluci√≥n-dext-fluent-async\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Secci√≥n titulada ¬´La Soluci√≥n: Dext Fluent Async¬ª</span></a></div>\n<p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;../../../../assets/concept_compartion.png&#x22;,&#x22;alt&#x22;:&#x22;Comparative Concept&#x22;,&#x22;index&#x22;:0}\"></p>\n<p>Con el nuevo motor de Dext, abstraemos la complejidad de <code dir=\"auto\">ITask</code>, <code dir=\"auto\">IFuture</code> y el manejo de excepciones en una sintaxis declarativa.</p>\n<p>¬øVamos a un ejemplo real? Imagine un Dashboard que necesita cargar 3 paneles pesados simult√°neamente al abrir la pantalla. Si lo hici√©ramos secuencialmente, el usuario esperar√≠a la suma de los tiempos. Con Dext, disparamos en paralelo y el c√≥digo permanece limpio:</p>\n<div class=\"expressive-code\"><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">uses</span><span style=\"--0:#F8F8F2\"> Dext.Threading.</span><span style=\"--0:#FF79C6\">Async</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">TFormDashboard.LoadDashboard</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// 1. Carga el Perfil del Usuario (I/O Bound)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Dispara y olvida la complejidad. Dext gestiona el hilo.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Task1 := TAsyncTask.Run&#x3C;TUserProfile>(</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">function: TUserProfile</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#96A1C2\">// Ejecuta en Background Thread Pool</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#FF79C6\">Result</span><span style=\"--0:#F8F8F2\"> := UserService.GetProfile(Self.UserId);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.ThenBy(procedure(User: TUserProfile)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#96A1C2\">// Ejecuta procesamiento adicional en background si es necesario</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">LogAcceso(User);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.OnComplete(procedure(User: TUserProfile)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#96A1C2\">// Ejecuta AUTOM√ÅTICAMENTE en el Main Thread (seguro para VCL/FMX)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">UserLabel.Caption := </span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Bienvenido, </span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\"> + User.</span><span style=\"--0:#FF79C6\">Name</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">imgAvatar.Bitmap := User.Avatar;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.OnException(procedure(E: Exception)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#96A1C2\">// Manejo centralizado de errores en el Main Thread</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">ShowMessage(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Error al cargar perfil: </span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\"> + E.</span><span style=\"--0:#FF79C6\">Message</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.Start; </span><span style=\"--0:#96A1C2\">// Inicia la ejecuci√≥n</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// 2. Carga Gr√°fico Financiero (CPU Bound)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Ejecuta en PARALELO al anterior</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Task2 := TAsyncTask.Run&#x3C;TFinancialData>(</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">function: TFinancialData</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#96A1C2\">// Verifica cancelaci√≥n autom√°ticamente antes de comenzar</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#FF79C6\">Result</span><span style=\"--0:#F8F8F2\"> := FinanceService.CalculateHeavyMetrics(CurrentYear);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.OnComplete(procedure(Data: TFinancialData)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">ChartSales.Series[</span><span style=\"--0:#BD93F9\">0</span><span style=\"--0:#F8F8F2\">].</span><span style=\"--0:#FF79C6\">Add</span><span style=\"--0:#F8F8F2\">(Data.Values);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.Start;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// 3. Actualiza Notificaciones</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Task3 := TAsyncTask.Run&#x3C;</span><span style=\"--0:#FF79C6\">Integer</span><span style=\"--0:#F8F8F2\">>(</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">function: </span><span style=\"--0:#FF79C6\">Integer</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#FF79C6\">Result</span><span style=\"--0:#F8F8F2\"> := NotificationService.CountUnread;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.OnComplete(procedure(Count: </span><span style=\"--0:#FF79C6\">Integer</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">Badge.Text := Count.ToString;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">Badge.Visible := Count > </span><span style=\"--0:#BD93F9\">0</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">.Start;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Espera a que terminen todas las tareas</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">TAsyncTask.WaitForAll([Task1, Task2, Task3]);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copiar al portapapeles\" data-copied=\"¬°Copiado!\" data-code=\"uses Dext.Threading.Async;procedure TFormDashboard.LoadDashboard;begin  // 1. Carga el Perfil del Usuario (I/O Bound)  // Dispara y olvida la complejidad. Dext gestiona el hilo.  var Task1 := TAsyncTask.Run<TUserProfile>(    function: TUserProfile    begin      // Ejecuta en Background Thread Pool      Result := UserService.GetProfile(Self.UserId);    end)    .ThenBy(procedure(User: TUserProfile)    begin      // Ejecuta procesamiento adicional en background si es necesario      LogAcceso(User);    end)    .OnComplete(procedure(User: TUserProfile)    begin      // Ejecuta AUTOM√ÅTICAMENTE en el Main Thread (seguro para VCL/FMX)      UserLabel.Caption := &#x27;Bienvenido, &#x27; + User.Name;      imgAvatar.Bitmap := User.Avatar;    end)    .OnException(procedure(E: Exception)    begin      // Manejo centralizado de errores en el Main Thread      ShowMessage(&#x27;Error al cargar perfil: &#x27; + E.Message);    end)    .Start; // Inicia la ejecuci√≥n  // 2. Carga Gr√°fico Financiero (CPU Bound)  // Ejecuta en PARALELO al anterior  var Task2 := TAsyncTask.Run<TFinancialData>(    function: TFinancialData    begin      // Verifica cancelaci√≥n autom√°ticamente antes de comenzar      Result := FinanceService.CalculateHeavyMetrics(CurrentYear);    end)    .OnComplete(procedure(Data: TFinancialData)    begin      ChartSales.Series[0].Add(Data.Values);    end)    .Start;  // 3. Actualiza Notificaciones  var Task3 := TAsyncTask.Run<Integer>(    function: Integer    begin      Result := NotificationService.CountUnread;    end)    .OnComplete(procedure(Count: Integer)    begin      Badge.Text := Count.ToString;      Badge.Visible := Count > 0;    end)    .Start;  // Espera a que terminen todas las tareas  TAsyncTask.WaitForAll([Task1, Task2, Task3]);end;\"><div></div></button></div></figure></div>\n<p><strong>¬øQu√© ganamos aqu√≠?</strong></p>\n<ol>\n<li><strong>Legibilidad:</strong> Leemos el c√≥digo de arriba a abajo, como una historia.</li>\n<li><strong>Seguridad de Hilo:</strong> <code dir=\"auto\">OnComplete</code> y <code dir=\"auto\">OnException</code> ya garantizan la sincronizaci√≥n con el Main Thread o hilo llamador. Se acab√≥ el <code dir=\"auto\">TThread.Queue</code> disperso por el c√≥digo.</li>\n<li><strong>Propagaci√≥n de Excepci√≥n:</strong> Si <code dir=\"auto\">GetProfile</code> falla, el flujo salta el <code dir=\"auto\">ThenBy</code> y cae directo en <code dir=\"auto\">OnException</code>. Sin <code dir=\"auto\">try..except</code> contaminando la regla de negocio.</li>\n</ol>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"la-red-de-seguridad-cancellation-tokens\">La Red de Seguridad: Cancellation Tokens</h3><a class=\"sl-anchor-link\" href=\"#la-red-de-seguridad-cancellation-tokens\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Secci√≥n titulada ¬´La Red de Seguridad: Cancellation Tokens¬ª</span></a></div>\n<p>¬øPero y si el usuario cierra el formulario mientras estas 3 tareas se est√°n ejecutando? ¬øTendremos un <em>Access Violation</em> al intentar actualizar el <code dir=\"auto\">UserLabel</code>?</p>\n<p>Es aqu√≠ donde entra la teor√≠a que ense√±o en el Cap√≠tulo 4 del libro: <strong>Cancelaci√≥n Cooperativa</strong>.</p>\n<p>Dext implementa el patr√≥n <code dir=\"auto\">ICancellationToken</code> (inspirado en .NET) de forma transparente. Puede pasar un token a la tarea, y la cadena fluida verifica ese token antes de cada paso.</p>\n<div class=\"expressive-code\"><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#96A1C2\">// Vincula el Token al ciclo de vida del Form</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#F8F8F2\">FTokenSource := TCancellationTokenSource.Create;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#F8F8F2\">TAsyncTask.Run(...)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">.WithCancellation(FTokenSource.Token) </span><span style=\"--0:#96A1C2\">// La magia sucede aqu√≠</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">.OnComplete(...)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">.Start;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">TFormDashboard.FormDestroy</span><span style=\"--0:#F8F8F2\">(Sender: TObject);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Al destruir el form, cancela todo lo que est√° pendiente.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Dext impide que el OnComplete (que accede a componentes visuales) se ejecute.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">FTokenSource.Cancel;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copiar al portapapeles\" data-copied=\"¬°Copiado!\" data-code=\"// Vincula el Token al ciclo de vida del FormFTokenSource := TCancellationTokenSource.Create;TAsyncTask.Run(...)  .WithCancellation(FTokenSource.Token) // La magia sucede aqu√≠  .OnComplete(...)  .Start;procedure TFormDashboard.FormDestroy(Sender: TObject);begin  // Al destruir el form, cancela todo lo que est√° pendiente.  // Dext impide que el OnComplete (que accede a componentes visuales) se ejecute.  FTokenSource.Cancel;end;\"><div></div></button></div></figure></div>\n<p>Esto resuelve uno de los errores m√°s comunes y dif√≠ciles de rastrear en aplicaciones Delphi Multithread: el <em>callback</em> que intenta acceder a un objeto destruido.</p>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"teor√≠a-y-pr√°ctica-el-power-duo\">Teor√≠a y Pr√°ctica: El ‚ÄúPower Duo‚Äù</h3><a class=\"sl-anchor-link\" href=\"#teor√≠a-y-pr√°ctica-el-power-duo\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Secci√≥n titulada ¬´Teor√≠a y Pr√°ctica: El ‚ÄúPower Duo‚Äù¬ª</span></a></div>\n<p>El <strong>Dext Framework</strong> entrega la herramienta lista para producci√≥n. Pero para usar multithreading con maestr√≠a, necesita entender lo que realmente est√° sucediendo. ¬øPor qu√© el Pool de Hilos es mejor que crear Hilos manuales? ¬øQu√© es Context Switching? ¬øC√≥mo funcionan las Primitivas de Sincronizaci√≥n?</p>\n<p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;../../../../assets/delphi_multithreading_desk.png&#x22;,&#x22;alt&#x22;:&#x22;Delphi Multithreading Book&#x22;,&#x22;index&#x22;:0}\"></p>\n<p>Es por eso que digo que el Libro y el Framework forman un par perfecto:</p>\n<ul>\n<li>\n<p>üìò <strong>El Libro (Delphi Multithreading):</strong> Ense√±a la base, la arquitectura y los ‚Äúporqu√©s‚Äù. El c√≥digo fuente de los ejemplos del libro (incluyendo la implementaci√≥n pura del CancellationToken) est√° disponible abiertamente para estudio.</p>\n<ul>\n<li><em>Repositorio (PT):</em> <a href=\"https://github.com/cesarliws/DelphiMultithreadingBookCode\">github.com/cesarliws/DelphiMultithreadingBookCode</a></li>\n<li><em>Repositorio (EN):</em> <a href=\"https://github.com/cesarliws/DelphiMultithreadingBookCodeEnglishEdition\">github.com/cesarliws/DelphiMultithreadingBookCodeEnglishEdition</a></li>\n</ul>\n</li>\n<li>\n<p>üöÄ <strong>El Framework (Dext):</strong> Entrega la implementaci√≥n productiva, probada y lista para el d√≠a a d√≠a, aplicando los conceptos del libro en una API moderna.</p>\n</li>\n</ul>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"conclusi√≥n\">Conclusi√≥n</h3><a class=\"sl-anchor-link\" href=\"#conclusi√≥n\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Secci√≥n titulada ¬´Conclusi√≥n¬ª</span></a></div>\n<p>Cumpl√≠ mi promesa hecha en CodeRage. <strong>Fluent Tasks</strong> ya no es solo una diapositiva de PowerPoint; es c√≥digo real que puede usar hoy para eliminar la complejidad de su proyecto.</p>\n<p><img __ASTRO_IMAGE_=\"{&#x22;src&#x22;:&#x22;../../../../assets/delphi_multithreading_mockup_3d.png&#x22;,&#x22;alt&#x22;:&#x22;Delphi Multithreading Book 3D&#x22;,&#x22;index&#x22;:0}\"></p>\n<p>Lo invito a descargar Dext, probar <code dir=\"auto\">Dext.Threading.Async</code> y, si quiere dominar la ingenier√≠a detr√°s de esto, asegurar su copia del libro en mi sitio.</p>\n<p>Documentaci√≥n Async API: <a href=\"https://github.com/cesarliws/dext/blob/main/Docs/async-api.md\">https://github.com/cesarliws/dext/blob/main/Docs/async-api.md</a></p>\n<p>Descargue Dext: <a href=\"https://github.com/cesarliws/dext\">https://github.com/cesarliws/dext</a></p>\n<p>Asegure el Libro: <a href=\"https://www.cesarromero.com.br/\">https://www.cesarromero.com.br/</a></p>\n<p>¬°Vamos a programar (en paralelo)! üöÄ</p>\n<p>#Delphi #Multithreading #DelphiMultithreadingBook #DextFramework #AsyncProgramming #CodeRage #SoftwareArchitecture #OpenSource</p>",{headings:344,localImagePaths:360,remoteImagePaths:361,frontmatter:362,imagePaths:363},[345,348,351,354,357],{depth:202,slug:346,text:347},"el-problema-la-deuda-de-la-complejidad","El Problema: La ‚ÄúDeuda‚Äù de la Complejidad",{depth:202,slug:349,text:350},"la-soluci√≥n-dext-fluent-async","La Soluci√≥n: Dext Fluent Async",{depth:202,slug:352,text:353},"la-red-de-seguridad-cancellation-tokens","La Red de Seguridad: Cancellation Tokens",{depth:202,slug:355,text:356},"teor√≠a-y-pr√°ctica-el-power-duo","Teor√≠a y Pr√°ctica: El ‚ÄúPower Duo‚Äù",{depth:202,slug:358,text:359},"conclusi√≥n","Conclusi√≥n",[301,302,303,304],[],{title:332,description:333,pubDate:288,heroImage:301},[301,302,303,304],"articles/enterprise-patterns-delphi",{id:364,data:366,body:372,filePath:373,digest:374,rendered:375},{title:367,description:368,editUrl:16,head:369,template:50,sidebar:370,pagefind:16,draft:37},"Domain Model e CQRS: Modernizando sua Arquitetura Delphi","Enterprise Patterns com Dext: Domain Model & CQRS - Como aplicar Domain Model e CQRS para modernizar sua arquitetura Delphi e preparar seu sistema para alta escalabilidade.",[],{hidden:37,attrs:371},{},"**Enterprise Patterns com Dext: Domain Model & CQRS - Como aplicar Domain Model e CQRS para modernizar sua arquitetura Delphi e preparar seu sistema para alta escalabilidade.**\r\n\r\nNo desenvolvimento de software corporativo, frequentemente ca√≠mos na armadilha de usar uma √∫nica classe para tudo. O mesmo objeto valida regras, mapeia o banco de dados, calcula impostos e serve a tela.\r\n\r\nO resultado todos conhecemos: sistemas r√≠gidos, classes gigantes (\"God Classes\") e o medo constante de alterar qualquer coisa em produ√ß√£o.\r\n\r\nInspirado nos padr√µes de arquitetura Enterprise (comumente vistos no ecossistema .NET Core e Java), o **Dext** traz para o Delphi a capacidade de aplicar o princ√≠pio da **Segrega√ß√£o de Responsabilidades** de forma elegante e perform√°tica.\r\n\r\nHoje vou demonstrar uma arquitetura h√≠brida que separa o **Estado (Persist√™ncia)** do **Comportamento (Regras de Neg√≥cio)**.\r\n\r\n## 1. O Conceito: Entidades Leves vs. Modelos Ricos\r\n\r\nO segredo da arquitetura robusta √© aceitar que **como guardamos** o dado √© diferente de **como processamos** o dado.\r\n\r\n### A Entidade de Persist√™ncia (O Estado)\r\n\r\nEsta classe deve ser leve, um espelho fiel da tabela. O banco de dados √© a nossa \"Fonte da Verdade\": se o dado est√° gravado l√°, assumimos que ele est√° √≠ntegro.\r\n\r\nPara manter o c√≥digo limpo, utilizo o **Fluent Mapping** do Dext, eliminando a polui√ß√£o visual de atributos dentro da classe de dom√≠nio.\r\n\r\n```pascal\r\n// POCO: Puro, leve e focado apenas em dados.\r\ntype\r\n  TOrderEntity = class\r\n  private\r\n    FId: Integer;\r\n    FStatus: string;\r\n    FTotal: Currency;\r\n    FItems: IList<TOrderItemEntity>; \r\n  public\r\n    property Id: Integer read FId write FId;\r\n    property Status: string read FStatus write FStatus;\r\n    property Total: Currency read FTotal write FTotal;\r\n    property Items: IList<TOrderItemEntity> read FItems;\r\n  end;\r\n```\r\n\r\n## 2. O Modelo de Dom√≠nio Rico\r\n\r\nAqui reside a \"gravidade\" das regras de neg√≥cio. O **Model** n√£o √© um mero transportador de dados; ele √© o **Guardi√£o da Integridade**. Observe como n√£o expomos setters p√∫blicos; a √∫nica forma de alterar o estado √© atrav√©s de m√©todos que garantem as regras.\r\n\r\n```pascal\r\ntype\r\n  TOrderModel = class\r\n  private\r\n    FEntity: TOrderEntity; // O target dos dados\r\n  public\r\n    constructor Create(Entity: TOrderEntity);\r\n\r\n    // Comportamentos (A√ß√µes de Neg√≥cio)\r\n    procedure AdicionarItem(Produto: TProduct; Quantidade: Integer);\r\n    procedure SubmeterPedido;\r\n\r\n    // Acesso Read-Only (Encapsulamento Total)\r\n    property Entity: TOrderEntity read FEntity;\r\n  end;\r\n\r\nimplementation\r\n\r\nprocedure TOrderModel.SubmeterPedido;\r\nbegin\r\n  // 1. Valida√ß√£o de Estado\r\n  if FEntity.Status <> 'Rascunho' then\r\n    raise EDomainError.Create('Apenas pedidos em rascunho podem ser submetidos.');\r\n\r\n  // 2. Valida√ß√£o de Invariantes (Regras \"Duras\")\r\n  if FEntity.Total < 500.00 then\r\n    raise EDomainError.Create('O pedido m√≠nimo para faturamento √© R$ 500,00.');\r\n\r\n  // 3. Transi√ß√£o de Estado Segura\r\n  FEntity.Status := 'AguardandoAprovacao';\r\nend;\r\n\r\nprocedure TOrderModel.AdicionarItem(Produto: TProduct; Quantidade: Integer);\r\nbegin\r\n  // Fail Fast: Impede dados sujos de entrarem no sistema\r\n  if Quantidade <= 0 then raise EDomainError.Create('Quantidade inv√°lida.');\r\n\r\n  var Item := TOrderItemEntity.Create;\r\n  Item.ProductId := Produto.Id;\r\n  Item.Quantity := Quantidade;\r\n  Item.UnitPrice := Produto.PrecoVenda;\r\n  \r\n  FEntity.Items.Add(Item);\r\n  \r\n  // Atualiza o total imediatamente. A entidade nunca fica inconsistente.\r\n  FEntity.Total := FEntity.Total + (Item.UnitPrice * Quantidade);\r\nend;\r\n```\r\n\r\n## 3. Consumo Elegante com Fluent Specifications\r\n\r\nA beleza desta arquitetura se revela nos Endpoints (Controllers). Como separamos as responsabilidades, podemos usar o poder do **Specification Pattern** (estilo Ardalis) integrado ao Dext.\r\n\r\nVeja a diferen√ßa brutal entre os dois mundos convivendo em harmonia:\r\n\r\n### O Endpoint de Leitura (Query)\r\n\r\nAqui usamos a sintaxe fluente do Dext. O c√≥digo √© declarativo: dizemos *o que* queremos, n√£o *como* buscar.\r\n\r\n```pascal\r\n// GET /orders/pending\r\nApp.MapGet('/orders/pending', \r\n  function(Context: THttpContext; Repo: IOrderRepository): IResult\r\n  begin\r\n    // \"Traga pedidos onde Status √© 'Submitted' E Total > 1000, \r\n    //  incluindo os Itens, ordenados por Data\"\r\n    var Spec := Specification.Where<TOrderEntity>(\r\n                  (OrderEntity.Status = 'Submitted') and \r\n                  (OrderEntity.Total > 1000)\r\n                )\r\n                .Include('Items')\r\n                .OrderBy(OrderEntity.CreatedAt.Desc);\r\n\r\n    // O Repository apenas executa a especifica√ß√£o. Limpo.\r\n    var Orders := Repo.ToList(Spec);\r\n    \r\n    Result := Results.Ok(Orders);\r\n  end);\r\n```\r\n\r\n### O Endpoint de Escrita (Command)\r\n\r\nAqui a disciplina entra em cena. Instanciamos o **Model** para garantir que nenhuma regra seja violada antes da persist√™ncia.\r\n\r\n```pascal\r\n// POST /orders\r\nApp.MapPost('/orders', \r\n  function(Context: THttpContext; Repo: IOrderRepository; Dto: TCreateOrderDto): IResult\r\n  begin\r\n    var Entity := TOrderEntity.Create;\r\n    var Model  := TOrderModel.Create(Entity);\r\n\r\n    try\r\n      // O Model orquestra as regras \"pesadas\"\r\n      for var Item in Dto.Items do\r\n        Model.AdicionarItem(Item.ProductId, Item.Qty);\r\n        \r\n      Model.SubmeterPedido; // Valida estado e invariantes\r\n\r\n      // Persiste apenas se o Model aprovou tudo\r\n      Repo.Add(Model.Entity);\r\n      \r\n      Result := Results.Created(Model.Entity.Id, Model.Entity);\r\n    except\r\n      on E: EDomainError do\r\n        Result := Results.BadRequest(E.Message);\r\n    end;\r\n  end);\r\n```\r\n\r\n## 4. O Cheque-Mate: Testabilidade Unit√°ria\r\n\r\nAo adotar este padr√£o, ganhamos um benef√≠cio que vale ouro em projetos grandes: a capacidade de testar regras de neg√≥cio isoladamente.\r\n\r\nNo modelo antigo (\"God Class\" acoplada ao componente de banco), para testar se o \"Pedido M√≠nimo de R$ 500,00\" funciona, voc√™ precisaria subir um banco de dados, inserir registros e rodar o sistema. Lento e fr√°gil.\r\n\r\nNesta arquitetura h√≠brida, o `TOrderModel` √© agn√≥stico ao banco. Voc√™ pode escrever um Teste Unit√°rio (DUnit/DUnitX) que instancia a entidade em mem√≥ria, passa para o Model e verifica o comportamento em milissegundos.\r\n\r\n```pascal\r\nprocedure TTestOrderModel.TestarValidacaoDeMinimo;\r\nvar\r\n  Entidade: TOrderEntity;\r\n  Model: TOrderModel;\r\nbegin\r\n  // Arrange: Entidade em mem√≥ria, sem banco de dados!\r\n  Entidade := TOrderEntity.Create;\r\n  Entidade.Total := 100.00; \r\n  Model := TOrderModel.Create(Entidade);\r\n  \r\n  // Act & Assert\r\n  Assert.WillRaise(procedure begin \r\n      Model.SubmeterPedido \r\n    end, \r\n    EDomainError, \r\n    'Deve bloquear pedidos abaixo de 500 reais'\r\n  );\r\nend;\r\n```\r\n\r\nIsso garante a qualidade do software muito antes dele chegar em produ√ß√£o.\r\n\r\n## Conclus√£o\r\n\r\nAdotar Enterprise Patterns com Dext transforma a engenharia do seu projeto Delphi. Ao separar **Estado** de **Comportamento**, atingimos o equil√≠brio perfeito:\r\n\r\n1. **Leitura:** Expressiva e perform√°tica com Fluent Specifications.\r\n2. **Escrita:** Segura e blindada com Domain Models.\r\n3. **Qualidade:** Testabilidade real fora do banco de dados.\r\n\r\nO Dext fornece a funda√ß√£o (ORM, Fluent Mapping, Specifications) para que voc√™ pare de brigar com o c√≥digo e comece a desenhar arquiteturas robustas.\r\n\r\nEste √© apenas o primeiro passo. Uma vez que seu dom√≠nio est√° rico e isolado, novas possibilidades se abrem: Event Sourcing, filas de mensageria e APIs de alt√≠ssima performance. Mas essa √© uma conversa para o nosso pr√≥ximo artigo.\r\n\r\nVeja o reposit√≥rio do Dext no GitHub: [https://github.com/cesarliws/dext](https://github.com/cesarliws/dext)","src/content/docs/articles/enterprise-patterns-delphi.md","8190d23702bf3c5e",{html:376,metadata:377},"<p><strong>Enterprise Patterns com Dext: Domain Model &#x26; CQRS - Como aplicar Domain Model e CQRS para modernizar sua arquitetura Delphi e preparar seu sistema para alta escalabilidade.</strong></p>\n<p>No desenvolvimento de software corporativo, frequentemente ca√≠mos na armadilha de usar uma √∫nica classe para tudo. O mesmo objeto valida regras, mapeia o banco de dados, calcula impostos e serve a tela.</p>\n<p>O resultado todos conhecemos: sistemas r√≠gidos, classes gigantes (‚ÄúGod Classes‚Äù) e o medo constante de alterar qualquer coisa em produ√ß√£o.</p>\n<p>Inspirado nos padr√µes de arquitetura Enterprise (comumente vistos no ecossistema .NET Core e Java), o <strong>Dext</strong> traz para o Delphi a capacidade de aplicar o princ√≠pio da <strong>Segrega√ß√£o de Responsabilidades</strong> de forma elegante e perform√°tica.</p>\n<p>Hoje vou demonstrar uma arquitetura h√≠brida que separa o <strong>Estado (Persist√™ncia)</strong> do <strong>Comportamento (Regras de Neg√≥cio)</strong>.</p>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"1-o-conceito-entidades-leves-vs-modelos-ricos\">1. O Conceito: Entidades Leves vs. Modelos Ricos</h2><a class=\"sl-anchor-link\" href=\"#1-o-conceito-entidades-leves-vs-modelos-ricos\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚Äú1. O Conceito: Entidades Leves vs. Modelos Ricos‚Äù</span></a></div>\n<p>O segredo da arquitetura robusta √© aceitar que <strong>como guardamos</strong> o dado √© diferente de <strong>como processamos</strong> o dado.</p>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"a-entidade-de-persist√™ncia-o-estado\">A Entidade de Persist√™ncia (O Estado)</h3><a class=\"sl-anchor-link\" href=\"#a-entidade-de-persist√™ncia-o-estado\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúA Entidade de Persist√™ncia (O Estado)‚Äù</span></a></div>\n<p>Esta classe deve ser leve, um espelho fiel da tabela. O banco de dados √© a nossa ‚ÄúFonte da Verdade‚Äù: se o dado est√° gravado l√°, assumimos que ele est√° √≠ntegro.</p>\n<p>Para manter o c√≥digo limpo, utilizo o <strong>Fluent Mapping</strong> do Dext, eliminando a polui√ß√£o visual de atributos dentro da classe de dom√≠nio.</p>\n<div class=\"expressive-code\"><link rel=\"stylesheet\" href=\"/_astro/ec.2f3rl.css\"><script type=\"module\" src=\"/_astro/ec.0vx5m.js\"></script><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#96A1C2\">// POCO: Puro, leve e focado apenas em dados.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">type</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">TOrderEntity = </span><span style=\"--0:#FF79C6\">class</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">private</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">FId: </span><span style=\"--0:#FF79C6\">Integer</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">FStatus: </span><span style=\"--0:#FF79C6\">string</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">FTotal: </span><span style=\"--0:#FF79C6\">Currency</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">FItems: IList&#x3C;TOrderItemEntity>;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">public</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">property</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">Id</span><span style=\"--0:#F8F8F2\">: </span><span style=\"--0:#FF79C6\">Integer</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">read</span><span style=\"--0:#F8F8F2\"> FId </span><span style=\"--0:#FF79C6\">write</span><span style=\"--0:#F8F8F2\"> FId;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">property</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">Status</span><span style=\"--0:#F8F8F2\">: </span><span style=\"--0:#FF79C6\">string</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">read</span><span style=\"--0:#F8F8F2\"> FStatus </span><span style=\"--0:#FF79C6\">write</span><span style=\"--0:#F8F8F2\"> FStatus;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">property</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">Total</span><span style=\"--0:#F8F8F2\">: </span><span style=\"--0:#FF79C6\">Currency</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">read</span><span style=\"--0:#F8F8F2\"> FTotal </span><span style=\"--0:#FF79C6\">write</span><span style=\"--0:#F8F8F2\"> FTotal;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">property</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">Items</span><span style=\"--0:#F8F8F2\">: IList&#x3C;TOrderItemEntity> </span><span style=\"--0:#FF79C6\">read</span><span style=\"--0:#F8F8F2\"> FItems;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"// POCO: Puro, leve e focado apenas em dados.type  TOrderEntity = class  private    FId: Integer;    FStatus: string;    FTotal: Currency;    FItems: IList<TOrderItemEntity>;  public    property Id: Integer read FId write FId;    property Status: string read FStatus write FStatus;    property Total: Currency read FTotal write FTotal;    property Items: IList<TOrderItemEntity> read FItems;  end;\"><div></div></button></div></figure></div>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"2-o-modelo-de-dom√≠nio-rico\">2. O Modelo de Dom√≠nio Rico</h2><a class=\"sl-anchor-link\" href=\"#2-o-modelo-de-dom√≠nio-rico\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚Äú2. O Modelo de Dom√≠nio Rico‚Äù</span></a></div>\n<p>Aqui reside a ‚Äúgravidade‚Äù das regras de neg√≥cio. O <strong>Model</strong> n√£o √© um mero transportador de dados; ele √© o <strong>Guardi√£o da Integridade</strong>. Observe como n√£o expomos setters p√∫blicos; a √∫nica forma de alterar o estado √© atrav√©s de m√©todos que garantem as regras.</p>\n<div class=\"expressive-code\"><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">type</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">TOrderModel = </span><span style=\"--0:#FF79C6\">class</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">private</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">FEntity: TOrderEntity; </span><span style=\"--0:#96A1C2\">// O target dos dados</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">public</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">constructor</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">Create</span><span style=\"--0:#F8F8F2\">(Entity: TOrderEntity);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#96A1C2\">// Comportamentos (A√ß√µes de Neg√≥cio)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">AdicionarItem</span><span style=\"--0:#F8F8F2\">(Produto: TProduct; Quantidade: </span><span style=\"--0:#FF79C6\">Integer</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">SubmeterPedido</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#96A1C2\">// Acesso Read-Only (Encapsulamento Total)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">property</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">Entity</span><span style=\"--0:#F8F8F2\">: TOrderEntity </span><span style=\"--0:#FF79C6\">read</span><span style=\"--0:#F8F8F2\"> FEntity;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">implementation</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">TOrderModel.SubmeterPedido</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// 1. Valida√ß√£o de Estado</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">if</span><span style=\"--0:#F8F8F2\"> FEntity.Status &#x3C;> </span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Rascunho</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">then</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">raise</span><span style=\"--0:#F8F8F2\"> EDomainError.Create(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Apenas pedidos em rascunho podem ser submetidos.</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// 2. Valida√ß√£o de Invariantes (Regras \"Duras\")</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">if</span><span style=\"--0:#F8F8F2\"> FEntity.Total &#x3C; </span><span style=\"--0:#BD93F9\">500.00</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">then</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">raise</span><span style=\"--0:#F8F8F2\"> EDomainError.Create(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">O pedido m√≠nimo para faturamento √© R$ 500,00.</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// 3. Transi√ß√£o de Estado Segura</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">FEntity.Status := </span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">AguardandoAprovacao</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">TOrderModel.AdicionarItem</span><span style=\"--0:#F8F8F2\">(Produto: TProduct; Quantidade: </span><span style=\"--0:#FF79C6\">Integer</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Fail Fast: Impede dados sujos de entrarem no sistema</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">if</span><span style=\"--0:#F8F8F2\"> Quantidade &#x3C;= </span><span style=\"--0:#BD93F9\">0</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">then</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">raise</span><span style=\"--0:#F8F8F2\"> EDomainError.Create(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Quantidade inv√°lida.</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Item := TOrderItemEntity.Create;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Item.ProductId := Produto.Id;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Item.Quantity := Quantidade;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Item.UnitPrice := Produto.PrecoVenda;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">FEntity.Items.</span><span style=\"--0:#FF79C6\">Add</span><span style=\"--0:#F8F8F2\">(Item);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Atualiza o total imediatamente. A entidade nunca fica inconsistente.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">FEntity.Total := FEntity.Total + (Item.UnitPrice * Quantidade);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"type  TOrderModel = class  private    FEntity: TOrderEntity; // O target dos dados  public    constructor Create(Entity: TOrderEntity);    // Comportamentos (A√ß√µes de Neg√≥cio)    procedure AdicionarItem(Produto: TProduct; Quantidade: Integer);    procedure SubmeterPedido;    // Acesso Read-Only (Encapsulamento Total)    property Entity: TOrderEntity read FEntity;  end;implementationprocedure TOrderModel.SubmeterPedido;begin  // 1. Valida√ß√£o de Estado  if FEntity.Status <> &#x27;Rascunho&#x27; then    raise EDomainError.Create(&#x27;Apenas pedidos em rascunho podem ser submetidos.&#x27;);  // 2. Valida√ß√£o de Invariantes (Regras &#x22;Duras&#x22;)  if FEntity.Total < 500.00 then    raise EDomainError.Create(&#x27;O pedido m√≠nimo para faturamento √© R$ 500,00.&#x27;);  // 3. Transi√ß√£o de Estado Segura  FEntity.Status := &#x27;AguardandoAprovacao&#x27;;end;procedure TOrderModel.AdicionarItem(Produto: TProduct; Quantidade: Integer);begin  // Fail Fast: Impede dados sujos de entrarem no sistema  if Quantidade <= 0 then raise EDomainError.Create(&#x27;Quantidade inv√°lida.&#x27;);  var Item := TOrderItemEntity.Create;  Item.ProductId := Produto.Id;  Item.Quantity := Quantidade;  Item.UnitPrice := Produto.PrecoVenda;  FEntity.Items.Add(Item);  // Atualiza o total imediatamente. A entidade nunca fica inconsistente.  FEntity.Total := FEntity.Total + (Item.UnitPrice * Quantidade);end;\"><div></div></button></div></figure></div>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"3-consumo-elegante-com-fluent-specifications\">3. Consumo Elegante com Fluent Specifications</h2><a class=\"sl-anchor-link\" href=\"#3-consumo-elegante-com-fluent-specifications\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚Äú3. Consumo Elegante com Fluent Specifications‚Äù</span></a></div>\n<p>A beleza desta arquitetura se revela nos Endpoints (Controllers). Como separamos as responsabilidades, podemos usar o poder do <strong>Specification Pattern</strong> (estilo Ardalis) integrado ao Dext.</p>\n<p>Veja a diferen√ßa brutal entre os dois mundos convivendo em harmonia:</p>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"o-endpoint-de-leitura-query\">O Endpoint de Leitura (Query)</h3><a class=\"sl-anchor-link\" href=\"#o-endpoint-de-leitura-query\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúO Endpoint de Leitura (Query)‚Äù</span></a></div>\n<p>Aqui usamos a sintaxe fluente do Dext. O c√≥digo √© declarativo: dizemos <em>o que</em> queremos, n√£o <em>como</em> buscar.</p>\n<div class=\"expressive-code\"><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#96A1C2\">// GET /orders/pending</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#F8F8F2\">App.MapGet(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">/orders/pending</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">,</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">function(Context: THttpContext; Repo: IOrderRepository): IResult</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#96A1C2\">// \"Traga pedidos onde Status √© 'Submitted' E Total > 1000,</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#96A1C2\">//  incluindo os Itens, ordenados por Data\"</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Spec := Specification.</span><span style=\"--0:#FF79C6\">Where</span><span style=\"--0:#F8F8F2\">&#x3C;TOrderEntity>(</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">                  </span></span><span style=\"--0:#F8F8F2\">(OrderEntity.Status = </span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Submitted</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">) </span><span style=\"--0:#FF79C6\">and</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">                  </span></span><span style=\"--0:#F8F8F2\">(OrderEntity.Total > </span><span style=\"--0:#BD93F9\">1000</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">                </span></span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">                </span></span><span style=\"--0:#F8F8F2\">.Include(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Items</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">                </span></span><span style=\"--0:#F8F8F2\">.OrderBy(OrderEntity.CreatedAt.</span><span style=\"--0:#FF79C6\">Desc</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#96A1C2\">// O Repository apenas executa a especifica√ß√£o. Limpo.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Orders := Repo.ToList(Spec);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">Result</span><span style=\"--0:#F8F8F2\"> := Results.Ok(Orders);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">);</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"// GET /orders/pendingApp.MapGet(&#x27;/orders/pending&#x27;,  function(Context: THttpContext; Repo: IOrderRepository): IResult  begin    // &#x22;Traga pedidos onde Status √© &#x27;Submitted&#x27; E Total > 1000,    //  incluindo os Itens, ordenados por Data&#x22;    var Spec := Specification.Where<TOrderEntity>(                  (OrderEntity.Status = &#x27;Submitted&#x27;) and                  (OrderEntity.Total > 1000)                )                .Include(&#x27;Items&#x27;)                .OrderBy(OrderEntity.CreatedAt.Desc);    // O Repository apenas executa a especifica√ß√£o. Limpo.    var Orders := Repo.ToList(Spec);    Result := Results.Ok(Orders);  end);\"><div></div></button></div></figure></div>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"o-endpoint-de-escrita-command\">O Endpoint de Escrita (Command)</h3><a class=\"sl-anchor-link\" href=\"#o-endpoint-de-escrita-command\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúO Endpoint de Escrita (Command)‚Äù</span></a></div>\n<p>Aqui a disciplina entra em cena. Instanciamos o <strong>Model</strong> para garantir que nenhuma regra seja violada antes da persist√™ncia.</p>\n<div class=\"expressive-code\"><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#96A1C2\">// POST /orders</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#F8F8F2\">App.MapPost(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">/orders</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">,</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">function(Context: THttpContext; Repo: IOrderRepository; Dto: TCreateOrderDto): IResult</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Entity := TOrderEntity.Create;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Model  := TOrderModel.Create(Entity);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">try</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#96A1C2\">// O Model orquestra as regras \"pesadas\"</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#FF79C6\">for</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Item </span><span style=\"--0:#FF79C6\">in</span><span style=\"--0:#F8F8F2\"> Dto.Items </span><span style=\"--0:#FF79C6\">do</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">        </span></span><span style=\"--0:#F8F8F2\">Model.AdicionarItem(Item.ProductId, Item.Qty);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">Model.SubmeterPedido; </span><span style=\"--0:#96A1C2\">// Valida estado e invariantes</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#96A1C2\">// Persiste apenas se o Model aprovou tudo</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">Repo.</span><span style=\"--0:#FF79C6\">Add</span><span style=\"--0:#F8F8F2\">(Model.Entity);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#FF79C6\">Result</span><span style=\"--0:#F8F8F2\"> := Results.Created(Model.Entity.Id, Model.Entity);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">except</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#FF79C6\">on</span><span style=\"--0:#F8F8F2\"> E: EDomainError </span><span style=\"--0:#FF79C6\">do</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#FF79C6\">Result</span><span style=\"--0:#F8F8F2\"> := Results.BadRequest(E.</span><span style=\"--0:#FF79C6\">Message</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">);</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"// POST /ordersApp.MapPost(&#x27;/orders&#x27;,  function(Context: THttpContext; Repo: IOrderRepository; Dto: TCreateOrderDto): IResult  begin    var Entity := TOrderEntity.Create;    var Model  := TOrderModel.Create(Entity);    try      // O Model orquestra as regras &#x22;pesadas&#x22;      for var Item in Dto.Items do        Model.AdicionarItem(Item.ProductId, Item.Qty);      Model.SubmeterPedido; // Valida estado e invariantes      // Persiste apenas se o Model aprovou tudo      Repo.Add(Model.Entity);      Result := Results.Created(Model.Entity.Id, Model.Entity);    except      on E: EDomainError do        Result := Results.BadRequest(E.Message);    end;  end);\"><div></div></button></div></figure></div>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"4-o-cheque-mate-testabilidade-unit√°ria\">4. O Cheque-Mate: Testabilidade Unit√°ria</h2><a class=\"sl-anchor-link\" href=\"#4-o-cheque-mate-testabilidade-unit√°ria\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚Äú4. O Cheque-Mate: Testabilidade Unit√°ria‚Äù</span></a></div>\n<p>Ao adotar este padr√£o, ganhamos um benef√≠cio que vale ouro em projetos grandes: a capacidade de testar regras de neg√≥cio isoladamente.</p>\n<p>No modelo antigo (‚ÄúGod Class‚Äù acoplada ao componente de banco), para testar se o ‚ÄúPedido M√≠nimo de R$ 500,00‚Äù funciona, voc√™ precisaria subir um banco de dados, inserir registros e rodar o sistema. Lento e fr√°gil.</p>\n<p>Nesta arquitetura h√≠brida, o <code dir=\"auto\">TOrderModel</code> √© agn√≥stico ao banco. Voc√™ pode escrever um Teste Unit√°rio (DUnit/DUnitX) que instancia a entidade em mem√≥ria, passa para o Model e verifica o comportamento em milissegundos.</p>\n<div class=\"expressive-code\"><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">TTestOrderModel.TestarValidacaoDeMinimo</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">var</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Entidade: TOrderEntity;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Model: TOrderModel;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Arrange: Entidade em mem√≥ria, sem banco de dados!</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Entidade := TOrderEntity.Create;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Entidade.Total := </span><span style=\"--0:#BD93F9\">100.00</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Model := TOrderModel.Create(Entidade);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Act &#x26; Assert</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">Assert</span><span style=\"--0:#F8F8F2\">.WillRaise(</span><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">Model.SubmeterPedido</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">,</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">EDomainError,</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Deve bloquear pedidos abaixo de 500 reais</span><span style=\"--0:#E9F284\">'</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"procedure TTestOrderModel.TestarValidacaoDeMinimo;var  Entidade: TOrderEntity;  Model: TOrderModel;begin  // Arrange: Entidade em mem√≥ria, sem banco de dados!  Entidade := TOrderEntity.Create;  Entidade.Total := 100.00;  Model := TOrderModel.Create(Entidade);  // Act &#x26; Assert  Assert.WillRaise(procedure begin      Model.SubmeterPedido    end,    EDomainError,    &#x27;Deve bloquear pedidos abaixo de 500 reais&#x27;  );end;\"><div></div></button></div></figure></div>\n<p>Isso garante a qualidade do software muito antes dele chegar em produ√ß√£o.</p>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"conclus√£o\">Conclus√£o</h2><a class=\"sl-anchor-link\" href=\"#conclus√£o\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Se√ß√£o intitulada ‚ÄúConclus√£o‚Äù</span></a></div>\n<p>Adotar Enterprise Patterns com Dext transforma a engenharia do seu projeto Delphi. Ao separar <strong>Estado</strong> de <strong>Comportamento</strong>, atingimos o equil√≠brio perfeito:</p>\n<ol>\n<li><strong>Leitura:</strong> Expressiva e perform√°tica com Fluent Specifications.</li>\n<li><strong>Escrita:</strong> Segura e blindada com Domain Models.</li>\n<li><strong>Qualidade:</strong> Testabilidade real fora do banco de dados.</li>\n</ol>\n<p>O Dext fornece a funda√ß√£o (ORM, Fluent Mapping, Specifications) para que voc√™ pare de brigar com o c√≥digo e comece a desenhar arquiteturas robustas.</p>\n<p>Este √© apenas o primeiro passo. Uma vez que seu dom√≠nio est√° rico e isolado, novas possibilidades se abrem: Event Sourcing, filas de mensageria e APIs de alt√≠ssima performance. Mas essa √© uma conversa para o nosso pr√≥ximo artigo.</p>\n<p>Veja o reposit√≥rio do Dext no GitHub: <a href=\"https://github.com/cesarliws/dext\">https://github.com/cesarliws/dext</a></p>",{headings:378,localImagePaths:401,remoteImagePaths:402,frontmatter:403,imagePaths:407},[379,382,385,388,391,394,397,400],{depth:66,slug:380,text:381},"1-o-conceito-entidades-leves-vs-modelos-ricos","1. O Conceito: Entidades Leves vs. Modelos Ricos",{depth:202,slug:383,text:384},"a-entidade-de-persist√™ncia-o-estado","A Entidade de Persist√™ncia (O Estado)",{depth:66,slug:386,text:387},"2-o-modelo-de-dom√≠nio-rico","2. O Modelo de Dom√≠nio Rico",{depth:66,slug:389,text:390},"3-consumo-elegante-com-fluent-specifications","3. Consumo Elegante com Fluent Specifications",{depth:202,slug:392,text:393},"o-endpoint-de-leitura-query","O Endpoint de Leitura (Query)",{depth:202,slug:395,text:396},"o-endpoint-de-escrita-command","O Endpoint de Escrita (Command)",{depth:66,slug:398,text:399},"4-o-cheque-mate-testabilidade-unit√°ria","4. O Cheque-Mate: Testabilidade Unit√°ria",{depth:66,slug:241,text:242},[],[],{title:367,description:368,date:404,tags:405},["Date","2025-01-15T00:00:00.000Z"],[406,95,96],"Arquitetura",[],"blog/enterprise-patterns-delphi",{id:408,data:410,body:372,filePath:414,digest:374,rendered:415},{title:367,description:368,editUrl:16,head:411,template:50,sidebar:412,pagefind:16,draft:37},[],{hidden:37,attrs:413},{},"src/content/docs/blog/enterprise-patterns-delphi.md",{html:376,metadata:416},{headings:417,localImagePaths:426,remoteImagePaths:427,frontmatter:428,imagePaths:431},[418,419,420,421,422,423,424,425],{depth:66,slug:380,text:381},{depth:202,slug:383,text:384},{depth:66,slug:386,text:387},{depth:66,slug:389,text:390},{depth:202,slug:392,text:393},{depth:202,slug:395,text:396},{depth:66,slug:398,text:399},{depth:66,slug:241,text:242},[],[],{title:367,description:368,date:429,tags:430},["Date","2025-01-15T00:00:00.000Z"],[406,95,96],[],"en/articles/enterprise-patterns-delphi",{id:432,data:434,body:440,filePath:441,digest:442,rendered:443},{title:435,description:436,editUrl:16,head:437,template:50,sidebar:438,pagefind:16,draft:37},"Domain Model & CQRS: Modernizing your Delphi Architecture","Enterprise Patterns with Dext: Domain Model & CQRS - How to apply Domain Model and CQRS to modernize your Delphi architecture and prepare your system for high scalability.",[],{hidden:37,attrs:439},{},"**Enterprise Patterns with Dext: Domain Model & CQRS - How to apply Domain Model and CQRS to modernize your Delphi architecture and prepare your system for high scalability.**\r\n\r\nIn corporate software development, we often fall into the trap of using a single class for everything. The same object validates rules, maps to the database, calculates taxes, and serves the UI.\r\n\r\nThe result is familiar to all of us: rigid systems, \"God Classes\", and the constant fear of changing anything in production.\r\n\r\nInspired by Enterprise architecture patterns (commonly seen in the .NET Core and Java ecosystems), **Dext** brings to Delphi the ability to apply the **Separation of Concerns** principle in an elegant and performant way.\r\n\r\nToday I will demonstrate a hybrid architecture that separates **State (Persistence)** from **Behavior (Business Rules)**.\r\n\r\n## 1. The Concept: Lightweight Entities vs. Rich Models\r\n\r\nThe secret to robust architecture is accepting that **how we store** data is different from **how we process** data.\r\n\r\n### The Persistence Entity (The State)\r\n\r\nThis class should be lightweight, a faithful mirror of the table. The database is our \"Source of Truth\": if the data is stored there, we assume it is integral.\r\n\r\nTo keep the code clean, I use Dext's **Fluent Mapping**, eliminating the visual pollution of attributes inside the domain class.\r\n\r\n```pascal\r\n// POCO: Pure, lightweight, and focused only on data.\r\ntype\r\n  TOrderEntity = class\r\n  private\r\n    FId: Integer;\r\n    FStatus: string;\r\n    FTotal: Currency;\r\n    FItems: IList<TOrderItemEntity>; \r\n  public\r\n    property Id: Integer read FId write FId;\r\n    property Status: string read FStatus write FStatus;\r\n    property Total: Currency read FTotal write FTotal;\r\n    property Items: IList<TOrderItemEntity> read FItems;\r\n  end;\r\n```\r\n\r\n## 2. The Rich Domain Model\r\n\r\nHere lies the \"gravity\" of business rules. The **Model** is not a mere data carrier; it is the **Guardian of Integrity**. Notice how we don't expose public setters; the only way to change the state is through methods that enforce the rules.\r\n\r\n```pascal\r\ntype\r\n  TOrderModel = class\r\n  private\r\n    FEntity: TOrderEntity; // The data target\r\n  public\r\n    constructor Create(Entity: TOrderEntity);\r\n\r\n    // Behaviors (Business Actions)\r\n    procedure AddItem(Product: TProduct; Quantity: Integer);\r\n    procedure SubmitOrder;\r\n\r\n    // Read-Only Access (Total Encapsulation)\r\n    property Entity: TOrderEntity read FEntity;\r\n  end;\r\n\r\nimplementation\r\n\r\nprocedure TOrderModel.SubmitOrder;\r\nbegin\r\n  // 1. State Validation\r\n  if FEntity.Status <> 'Draft' then\r\n    raise EDomainError.Create('Only draft orders can be submitted.');\r\n\r\n  // 2. Invariant Validation (\"Hard\" Rules)\r\n  if FEntity.Total < 500.00 then\r\n    raise EDomainError.Create('Minimum order for billing is $ 500.00.');\r\n\r\n  // 3. Safe State Transition\r\n  FEntity.Status := 'AwaitingApproval';\r\nend;\r\n\r\nprocedure TOrderModel.AddItem(Product: TProduct; Quantity: Integer);\r\nbegin\r\n  // Fail Fast: Prevents dirty data from entering the system\r\n  if Quantity <= 0 then raise EDomainError.Create('Invalid quantity.');\r\n\r\n  var Item := TOrderItemEntity.Create;\r\n  Item.ProductId := Product.Id;\r\n  Item.Quantity := Quantity;\r\n  Item.UnitPrice := Product.SalePrice;\r\n  \r\n  FEntity.Items.Add(Item);\r\n  \r\n  // Updates total immediately. The entity never becomes inconsistent.\r\n  FEntity.Total := FEntity.Total + (Item.UnitPrice * Quantity);\r\nend;\r\n```\r\n\r\n## 3. Elegant Consumption with Fluent Specifications\r\n\r\nThe beauty of this architecture is revealed in the Endpoints (Controllers). Since we separated responsibilities, we can use the power of the **Specification Pattern** (Dext/Ardalis style) integrated into Dext.\r\n\r\nSee the brutal difference between the two worlds living in harmony:\r\n\r\n### The Read Endpoint (Query)\r\n\r\nHere we use Dext's fluent syntax. The code is declarative: we say *what* we want, not *how* to fetch it.\r\n\r\n```pascal\r\n// GET /orders/pending\r\nApp.MapGet('/orders/pending', \r\n  function(Context: THttpContext; Repo: IOrderRepository): IResult\r\n  begin\r\n    // \"Fetch orders where Status is 'Submitted' AND Total > 1000, \r\n    //  including Items, ordered by Date\"\r\n    var Spec := Specification.Where<TOrderEntity>(\r\n                  (OrderEntity.Status = 'Submitted') and \r\n                  (OrderEntity.Total > 1000)\r\n                )\r\n                .Include('Items')\r\n                .OrderBy(OrderEntity.CreatedAt.Desc);\r\n\r\n    // The Repository only executes the specification. Clean.\r\n    var Orders := Repo.ToList(Spec);\r\n    \r\n    Result := Results.Ok(Orders);\r\n  end);\r\n```\r\n\r\n### The Write Endpoint (Command)\r\n\r\nHere discipline comes into play. We instantiate the **Model** to ensure no rules are violated before persistence.\r\n\r\n```pascal\r\n// POST /orders\r\nApp.MapPost('/orders', \r\n  function(Context: THttpContext; Repo: IOrderRepository; Dto: TCreateOrderDto): IResult\r\n  begin\r\n    var Entity := TOrderEntity.Create;\r\n    var Model  := TOrderModel.Create(Entity);\r\n\r\n    try\r\n      // The Model orchestrates the \"heavy\" rules\r\n      for var Item in Dto.Items do\r\n        Model.AddItem(Item.ProductId, Item.Qty);\r\n        \r\n      Model.SubmitOrder; // Validates state and invariants\r\n\r\n      // Persists only if the Model approved everything\r\n      Repo.Add(Model.Entity);\r\n      \r\n      Result := Results.Created(Model.Entity.Id, Model.Entity);\r\n    except\r\n      on E: EDomainError do\r\n        Result := Results.BadRequest(E.Message);\r\n    end;\r\n  end);\r\n```\r\n\r\n## 4. Checkmate: Unit Testability\r\n\r\nBy adopting this pattern, we gain a benefit worth gold in large projects: the ability to test business rules in isolation.\r\n\r\nIn the old model (\"God Class\" coupled to the database component), to test if the \"Minimum Order of $ 500.00\" works, you would need to spin up a database, insert records, and run the system. Slow and fragile.\r\n\r\nIn this hybrid architecture, `TOrderModel` is database-agnostic. You can write a Unit Test (DUnit/DUnitX) that instantiates the entity in memory, passes it to the Model, and verifies the behavior in milliseconds.\r\n\r\n```pascal\r\nprocedure TTestOrderModel.TestMinimumValidation;\r\nvar\r\n  Entity: TOrderEntity;\r\n  Model: TOrderModel;\r\nbegin\r\n  // Arrange: In-memory Entity, no database!\r\n  Entity := TOrderEntity.Create;\r\n  Entity.Total := 100.00; \r\n  Model := TOrderModel.Create(Entity);\r\n  \r\n  // Act & Assert\r\n  Assert.WillRaise(procedure begin \r\n      Model.SubmitOrder \r\n    end, \r\n    EDomainError, \r\n    'Should block orders below 500 dollars'\r\n  );\r\nend;\r\n```\r\n\r\nThis ensures software quality long before it reaches production.\r\n\r\n## Conclusion\r\n\r\nAdopting Enterprise Patterns with Dext transforms your Delphi project engineering. By separating **State** from **Behavior**, we achieve the perfect balance:\r\n\r\n1. **Read:** Expressive and performant with Fluent Specifications.\r\n2. **Write:** Safe and armored with Domain Models.\r\n3. **Quality:** Real testability outside the database.\r\n\r\nDext provides the foundation (ORM, Fluent Mapping, Specifications) so you can stop fighting the code and start designing robust architectures.\r\n\r\nThis is just the first step. Once your domain is rich and isolated, new possibilities open up: Event Sourcing, message queues, and high-performance APIs. But that's a conversation for our next article.\r\n\r\nCheck out the Dext repository on GitHub: [https://github.com/cesarliws/dext](https://github.com/cesarliws/dext)","src/content/docs/en/articles/enterprise-patterns-delphi.md","b90e39c2671ae19c",{html:444,metadata:445},"<p><strong>Enterprise Patterns with Dext: Domain Model &#x26; CQRS - How to apply Domain Model and CQRS to modernize your Delphi architecture and prepare your system for high scalability.</strong></p>\n<p>In corporate software development, we often fall into the trap of using a single class for everything. The same object validates rules, maps to the database, calculates taxes, and serves the UI.</p>\n<p>The result is familiar to all of us: rigid systems, ‚ÄúGod Classes‚Äù, and the constant fear of changing anything in production.</p>\n<p>Inspired by Enterprise architecture patterns (commonly seen in the .NET Core and Java ecosystems), <strong>Dext</strong> brings to Delphi the ability to apply the <strong>Separation of Concerns</strong> principle in an elegant and performant way.</p>\n<p>Today I will demonstrate a hybrid architecture that separates <strong>State (Persistence)</strong> from <strong>Behavior (Business Rules)</strong>.</p>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"1-the-concept-lightweight-entities-vs-rich-models\">1. The Concept: Lightweight Entities vs. Rich Models</h2><a class=\"sl-anchor-link\" href=\"#1-the-concept-lightweight-entities-vs-rich-models\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Section titled ‚Äú1. The Concept: Lightweight Entities vs. Rich Models‚Äù</span></a></div>\n<p>The secret to robust architecture is accepting that <strong>how we store</strong> data is different from <strong>how we process</strong> data.</p>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"the-persistence-entity-the-state\">The Persistence Entity (The State)</h3><a class=\"sl-anchor-link\" href=\"#the-persistence-entity-the-state\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Section titled ‚ÄúThe Persistence Entity (The State)‚Äù</span></a></div>\n<p>This class should be lightweight, a faithful mirror of the table. The database is our ‚ÄúSource of Truth‚Äù: if the data is stored there, we assume it is integral.</p>\n<p>To keep the code clean, I use Dext‚Äôs <strong>Fluent Mapping</strong>, eliminating the visual pollution of attributes inside the domain class.</p>\n<div class=\"expressive-code\"><link rel=\"stylesheet\" href=\"/_astro/ec.2f3rl.css\"><script type=\"module\" src=\"/_astro/ec.0vx5m.js\"></script><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#96A1C2\">// POCO: Pure, lightweight, and focused only on data.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">type</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">TOrderEntity = </span><span style=\"--0:#FF79C6\">class</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">private</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">FId: </span><span style=\"--0:#FF79C6\">Integer</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">FStatus: </span><span style=\"--0:#FF79C6\">string</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">FTotal: </span><span style=\"--0:#FF79C6\">Currency</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">FItems: IList&#x3C;TOrderItemEntity>;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">public</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">property</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">Id</span><span style=\"--0:#F8F8F2\">: </span><span style=\"--0:#FF79C6\">Integer</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">read</span><span style=\"--0:#F8F8F2\"> FId </span><span style=\"--0:#FF79C6\">write</span><span style=\"--0:#F8F8F2\"> FId;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">property</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">Status</span><span style=\"--0:#F8F8F2\">: </span><span style=\"--0:#FF79C6\">string</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">read</span><span style=\"--0:#F8F8F2\"> FStatus </span><span style=\"--0:#FF79C6\">write</span><span style=\"--0:#F8F8F2\"> FStatus;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">property</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">Total</span><span style=\"--0:#F8F8F2\">: </span><span style=\"--0:#FF79C6\">Currency</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">read</span><span style=\"--0:#F8F8F2\"> FTotal </span><span style=\"--0:#FF79C6\">write</span><span style=\"--0:#F8F8F2\"> FTotal;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">property</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">Items</span><span style=\"--0:#F8F8F2\">: IList&#x3C;TOrderItemEntity> </span><span style=\"--0:#FF79C6\">read</span><span style=\"--0:#F8F8F2\"> FItems;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"// POCO: Pure, lightweight, and focused only on data.type  TOrderEntity = class  private    FId: Integer;    FStatus: string;    FTotal: Currency;    FItems: IList<TOrderItemEntity>;  public    property Id: Integer read FId write FId;    property Status: string read FStatus write FStatus;    property Total: Currency read FTotal write FTotal;    property Items: IList<TOrderItemEntity> read FItems;  end;\"><div></div></button></div></figure></div>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"2-the-rich-domain-model\">2. The Rich Domain Model</h2><a class=\"sl-anchor-link\" href=\"#2-the-rich-domain-model\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Section titled ‚Äú2. The Rich Domain Model‚Äù</span></a></div>\n<p>Here lies the ‚Äúgravity‚Äù of business rules. The <strong>Model</strong> is not a mere data carrier; it is the <strong>Guardian of Integrity</strong>. Notice how we don‚Äôt expose public setters; the only way to change the state is through methods that enforce the rules.</p>\n<div class=\"expressive-code\"><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">type</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">TOrderModel = </span><span style=\"--0:#FF79C6\">class</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">private</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">FEntity: TOrderEntity; </span><span style=\"--0:#96A1C2\">// The data target</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">public</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">constructor</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">Create</span><span style=\"--0:#F8F8F2\">(Entity: TOrderEntity);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#96A1C2\">// Behaviors (Business Actions)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">AddItem</span><span style=\"--0:#F8F8F2\">(Product: TProduct; Quantity: </span><span style=\"--0:#FF79C6\">Integer</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">SubmitOrder</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#96A1C2\">// Read-Only Access (Total Encapsulation)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">property</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">Entity</span><span style=\"--0:#F8F8F2\">: TOrderEntity </span><span style=\"--0:#FF79C6\">read</span><span style=\"--0:#F8F8F2\"> FEntity;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">implementation</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">TOrderModel.SubmitOrder</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// 1. State Validation</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">if</span><span style=\"--0:#F8F8F2\"> FEntity.Status &#x3C;> </span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Draft</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">then</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">raise</span><span style=\"--0:#F8F8F2\"> EDomainError.Create(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Only draft orders can be submitted.</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// 2. Invariant Validation (\"Hard\" Rules)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">if</span><span style=\"--0:#F8F8F2\"> FEntity.Total &#x3C; </span><span style=\"--0:#BD93F9\">500.00</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">then</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">raise</span><span style=\"--0:#F8F8F2\"> EDomainError.Create(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Minimum order for billing is $ 500.00.</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// 3. Safe State Transition</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">FEntity.Status := </span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">AwaitingApproval</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">TOrderModel.AddItem</span><span style=\"--0:#F8F8F2\">(Product: TProduct; Quantity: </span><span style=\"--0:#FF79C6\">Integer</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Fail Fast: Prevents dirty data from entering the system</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">if</span><span style=\"--0:#F8F8F2\"> Quantity &#x3C;= </span><span style=\"--0:#BD93F9\">0</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">then</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">raise</span><span style=\"--0:#F8F8F2\"> EDomainError.Create(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Invalid quantity.</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Item := TOrderItemEntity.Create;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Item.ProductId := Product.Id;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Item.Quantity := Quantity;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Item.UnitPrice := Product.SalePrice;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">FEntity.Items.</span><span style=\"--0:#FF79C6\">Add</span><span style=\"--0:#F8F8F2\">(Item);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Updates total immediately. The entity never becomes inconsistent.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">FEntity.Total := FEntity.Total + (Item.UnitPrice * Quantity);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"type  TOrderModel = class  private    FEntity: TOrderEntity; // The data target  public    constructor Create(Entity: TOrderEntity);    // Behaviors (Business Actions)    procedure AddItem(Product: TProduct; Quantity: Integer);    procedure SubmitOrder;    // Read-Only Access (Total Encapsulation)    property Entity: TOrderEntity read FEntity;  end;implementationprocedure TOrderModel.SubmitOrder;begin  // 1. State Validation  if FEntity.Status <> &#x27;Draft&#x27; then    raise EDomainError.Create(&#x27;Only draft orders can be submitted.&#x27;);  // 2. Invariant Validation (&#x22;Hard&#x22; Rules)  if FEntity.Total < 500.00 then    raise EDomainError.Create(&#x27;Minimum order for billing is $ 500.00.&#x27;);  // 3. Safe State Transition  FEntity.Status := &#x27;AwaitingApproval&#x27;;end;procedure TOrderModel.AddItem(Product: TProduct; Quantity: Integer);begin  // Fail Fast: Prevents dirty data from entering the system  if Quantity <= 0 then raise EDomainError.Create(&#x27;Invalid quantity.&#x27;);  var Item := TOrderItemEntity.Create;  Item.ProductId := Product.Id;  Item.Quantity := Quantity;  Item.UnitPrice := Product.SalePrice;  FEntity.Items.Add(Item);  // Updates total immediately. The entity never becomes inconsistent.  FEntity.Total := FEntity.Total + (Item.UnitPrice * Quantity);end;\"><div></div></button></div></figure></div>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"3-elegant-consumption-with-fluent-specifications\">3. Elegant Consumption with Fluent Specifications</h2><a class=\"sl-anchor-link\" href=\"#3-elegant-consumption-with-fluent-specifications\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Section titled ‚Äú3. Elegant Consumption with Fluent Specifications‚Äù</span></a></div>\n<p>The beauty of this architecture is revealed in the Endpoints (Controllers). Since we separated responsibilities, we can use the power of the <strong>Specification Pattern</strong> (Dext/Ardalis style) integrated into Dext.</p>\n<p>See the brutal difference between the two worlds living in harmony:</p>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"the-read-endpoint-query\">The Read Endpoint (Query)</h3><a class=\"sl-anchor-link\" href=\"#the-read-endpoint-query\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Section titled ‚ÄúThe Read Endpoint (Query)‚Äù</span></a></div>\n<p>Here we use Dext‚Äôs fluent syntax. The code is declarative: we say <em>what</em> we want, not <em>how</em> to fetch it.</p>\n<div class=\"expressive-code\"><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#96A1C2\">// GET /orders/pending</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#F8F8F2\">App.MapGet(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">/orders/pending</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">,</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">function(Context: THttpContext; Repo: IOrderRepository): IResult</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#96A1C2\">// \"Fetch orders where Status is 'Submitted' AND Total > 1000,</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#96A1C2\">//  including Items, ordered by Date\"</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Spec := Specification.</span><span style=\"--0:#FF79C6\">Where</span><span style=\"--0:#F8F8F2\">&#x3C;TOrderEntity>(</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">                  </span></span><span style=\"--0:#F8F8F2\">(OrderEntity.Status = </span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Submitted</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">) </span><span style=\"--0:#FF79C6\">and</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">                  </span></span><span style=\"--0:#F8F8F2\">(OrderEntity.Total > </span><span style=\"--0:#BD93F9\">1000</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">                </span></span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">                </span></span><span style=\"--0:#F8F8F2\">.Include(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Items</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">                </span></span><span style=\"--0:#F8F8F2\">.OrderBy(OrderEntity.CreatedAt.</span><span style=\"--0:#FF79C6\">Desc</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#96A1C2\">// The Repository only executes the specification. Clean.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Orders := Repo.ToList(Spec);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">Result</span><span style=\"--0:#F8F8F2\"> := Results.Ok(Orders);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">);</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"// GET /orders/pendingApp.MapGet(&#x27;/orders/pending&#x27;,  function(Context: THttpContext; Repo: IOrderRepository): IResult  begin    // &#x22;Fetch orders where Status is &#x27;Submitted&#x27; AND Total > 1000,    //  including Items, ordered by Date&#x22;    var Spec := Specification.Where<TOrderEntity>(                  (OrderEntity.Status = &#x27;Submitted&#x27;) and                  (OrderEntity.Total > 1000)                )                .Include(&#x27;Items&#x27;)                .OrderBy(OrderEntity.CreatedAt.Desc);    // The Repository only executes the specification. Clean.    var Orders := Repo.ToList(Spec);    Result := Results.Ok(Orders);  end);\"><div></div></button></div></figure></div>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"the-write-endpoint-command\">The Write Endpoint (Command)</h3><a class=\"sl-anchor-link\" href=\"#the-write-endpoint-command\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Section titled ‚ÄúThe Write Endpoint (Command)‚Äù</span></a></div>\n<p>Here discipline comes into play. We instantiate the <strong>Model</strong> to ensure no rules are violated before persistence.</p>\n<div class=\"expressive-code\"><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#96A1C2\">// POST /orders</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#F8F8F2\">App.MapPost(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">/orders</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">,</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">function(Context: THttpContext; Repo: IOrderRepository; Dto: TCreateOrderDto): IResult</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Entity := TOrderEntity.Create;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Model  := TOrderModel.Create(Entity);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">try</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#96A1C2\">// The Model orchestrates the \"heavy\" rules</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#FF79C6\">for</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Item </span><span style=\"--0:#FF79C6\">in</span><span style=\"--0:#F8F8F2\"> Dto.Items </span><span style=\"--0:#FF79C6\">do</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">        </span></span><span style=\"--0:#F8F8F2\">Model.AddItem(Item.ProductId, Item.Qty);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">Model.SubmitOrder; </span><span style=\"--0:#96A1C2\">// Validates state and invariants</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#96A1C2\">// Persists only if the Model approved everything</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">Repo.</span><span style=\"--0:#FF79C6\">Add</span><span style=\"--0:#F8F8F2\">(Model.Entity);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#FF79C6\">Result</span><span style=\"--0:#F8F8F2\"> := Results.Created(Model.Entity.Id, Model.Entity);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">except</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#FF79C6\">on</span><span style=\"--0:#F8F8F2\"> E: EDomainError </span><span style=\"--0:#FF79C6\">do</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#FF79C6\">Result</span><span style=\"--0:#F8F8F2\"> := Results.BadRequest(E.</span><span style=\"--0:#FF79C6\">Message</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">);</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"// POST /ordersApp.MapPost(&#x27;/orders&#x27;,  function(Context: THttpContext; Repo: IOrderRepository; Dto: TCreateOrderDto): IResult  begin    var Entity := TOrderEntity.Create;    var Model  := TOrderModel.Create(Entity);    try      // The Model orchestrates the &#x22;heavy&#x22; rules      for var Item in Dto.Items do        Model.AddItem(Item.ProductId, Item.Qty);      Model.SubmitOrder; // Validates state and invariants      // Persists only if the Model approved everything      Repo.Add(Model.Entity);      Result := Results.Created(Model.Entity.Id, Model.Entity);    except      on E: EDomainError do        Result := Results.BadRequest(E.Message);    end;  end);\"><div></div></button></div></figure></div>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"4-checkmate-unit-testability\">4. Checkmate: Unit Testability</h2><a class=\"sl-anchor-link\" href=\"#4-checkmate-unit-testability\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Section titled ‚Äú4. Checkmate: Unit Testability‚Äù</span></a></div>\n<p>By adopting this pattern, we gain a benefit worth gold in large projects: the ability to test business rules in isolation.</p>\n<p>In the old model (‚ÄúGod Class‚Äù coupled to the database component), to test if the ‚ÄúMinimum Order of $ 500.00‚Äù works, you would need to spin up a database, insert records, and run the system. Slow and fragile.</p>\n<p>In this hybrid architecture, <code dir=\"auto\">TOrderModel</code> is database-agnostic. You can write a Unit Test (DUnit/DUnitX) that instantiates the entity in memory, passes it to the Model, and verifies the behavior in milliseconds.</p>\n<div class=\"expressive-code\"><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">TTestOrderModel.TestMinimumValidation</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">var</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Entity: TOrderEntity;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Model: TOrderModel;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Arrange: In-memory Entity, no database!</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Entity := TOrderEntity.Create;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Entity.Total := </span><span style=\"--0:#BD93F9\">100.00</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Model := TOrderModel.Create(Entity);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Act &#x26; Assert</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">Assert</span><span style=\"--0:#F8F8F2\">.WillRaise(</span><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">Model.SubmitOrder</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">,</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">EDomainError,</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Should block orders below 500 dollars</span><span style=\"--0:#E9F284\">'</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"procedure TTestOrderModel.TestMinimumValidation;var  Entity: TOrderEntity;  Model: TOrderModel;begin  // Arrange: In-memory Entity, no database!  Entity := TOrderEntity.Create;  Entity.Total := 100.00;  Model := TOrderModel.Create(Entity);  // Act &#x26; Assert  Assert.WillRaise(procedure begin      Model.SubmitOrder    end,    EDomainError,    &#x27;Should block orders below 500 dollars&#x27;  );end;\"><div></div></button></div></figure></div>\n<p>This ensures software quality long before it reaches production.</p>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"conclusion\">Conclusion</h2><a class=\"sl-anchor-link\" href=\"#conclusion\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Section titled ‚ÄúConclusion‚Äù</span></a></div>\n<p>Adopting Enterprise Patterns with Dext transforms your Delphi project engineering. By separating <strong>State</strong> from <strong>Behavior</strong>, we achieve the perfect balance:</p>\n<ol>\n<li><strong>Read:</strong> Expressive and performant with Fluent Specifications.</li>\n<li><strong>Write:</strong> Safe and armored with Domain Models.</li>\n<li><strong>Quality:</strong> Real testability outside the database.</li>\n</ol>\n<p>Dext provides the foundation (ORM, Fluent Mapping, Specifications) so you can stop fighting the code and start designing robust architectures.</p>\n<p>This is just the first step. Once your domain is rich and isolated, new possibilities open up: Event Sourcing, message queues, and high-performance APIs. But that‚Äôs a conversation for our next article.</p>\n<p>Check out the Dext repository on GitHub: <a href=\"https://github.com/cesarliws/dext\">https://github.com/cesarliws/dext</a></p>",{headings:446,localImagePaths:469,remoteImagePaths:470,frontmatter:471,imagePaths:475},[447,450,453,456,459,462,465,468],{depth:66,slug:448,text:449},"1-the-concept-lightweight-entities-vs-rich-models","1. The Concept: Lightweight Entities vs. Rich Models",{depth:202,slug:451,text:452},"the-persistence-entity-the-state","The Persistence Entity (The State)",{depth:66,slug:454,text:455},"2-the-rich-domain-model","2. The Rich Domain Model",{depth:66,slug:457,text:458},"3-elegant-consumption-with-fluent-specifications","3. Elegant Consumption with Fluent Specifications",{depth:202,slug:460,text:461},"the-read-endpoint-query","The Read Endpoint (Query)",{depth:202,slug:463,text:464},"the-write-endpoint-command","The Write Endpoint (Command)",{depth:66,slug:466,text:467},"4-checkmate-unit-testability","4. Checkmate: Unit Testability",{depth:66,slug:323,text:324},[],[],{title:435,description:436,date:472,tags:473},["Date","2025-01-15T00:00:00.000Z"],[474,95,96],"Architecture",[],"es/articles/enterprise-patterns-delphi",{id:476,data:478,body:484,filePath:485,digest:486,rendered:487},{title:479,description:480,editUrl:16,head:481,template:50,sidebar:482,pagefind:16,draft:37},"Domain Model y CQRS: Modernizando su Arquitectura Delphi","Enterprise Patterns con Dext: Domain Model & CQRS - C√≥mo aplicar Domain Model y CQRS para modernizar su arquitectura Delphi y preparar su sistema para alta escalabilidad.",[],{hidden:37,attrs:483},{},"**Enterprise Patterns con Dext: Domain Model & CQRS - C√≥mo aplicar Domain Model y CQRS para modernizar su arquitectura Delphi y preparar su sistema para alta escalabilidad.**\r\n\r\nEn el desarrollo de software corporativo, a menudo caemos en la trampa de usar una sola clase para todo. El mismo objeto valida reglas, mapea a la base de datos, calcula impuestos y sirve a la interfaz de usuario.\r\n\r\nEl resultado es familiar para todos nosotros: sistemas r√≠gidos, \"God Classes\" (Clases Dios) y el miedo constante de cambiar cualquier cosa en producci√≥n.\r\n\r\nInspirado en los patrones de arquitectura Enterprise (com√∫nmente vistos en los ecosistemas .NET Core y Java), **Dext** trae a Delphi la capacidad de aplicar el principio de **Separaci√≥n de Responsabilidades** de una manera elegante y performante.\r\n\r\nHoy demostrar√© una arquitectura h√≠brida que separa el **Estado (Persistencia)** del **Comportamiento (Reglas de Negocio)**.\r\n\r\n## 1. El Concepto: Entidades Ligeras vs. Modelos Ricos\r\n\r\nEl secreto de una arquitectura robusta es aceptar que **c√≥mo guardamos** los datos es diferente de **c√≥mo procesamos** los datos.\r\n\r\n### La Entidad de Persistencia (El Estado)\r\n\r\nEsta clase debe ser ligera, un espejo fiel de la tabla. La base de datos es nuestra \"Fuente de la Verdad\": si el dato est√° grabado all√≠, asumimos que es √≠ntegro.\r\n\r\nPara mantener el c√≥digo limpio, utilizo el **Fluent Mapping** de Dext, eliminando la contaminaci√≥n visual de atributos dentro de la clase de dominio.\r\n\r\n```pascal\r\n// POCO: Puro, ligero y enfocado solo en datos.\r\ntype\r\n  TOrderEntity = class\r\n  private\r\n    FId: Integer;\r\n    FStatus: string;\r\n    FTotal: Currency;\r\n    FItems: IList<TOrderItemEntity>; \r\n  public\r\n    property Id: Integer read FId write FId;\r\n    property Status: string read FStatus write FStatus;\r\n    property Total: Currency read FTotal write FTotal;\r\n    property Items: IList<TOrderItemEntity> read FItems;\r\n  end;\r\n```\r\n\r\n## 2. El Modelo de Dominio Rico\r\n\r\nAqu√≠ reside la \"gravedad\" de las reglas de negocio. El **Model** no es un mero transportador de datos; es el **Guardi√°n de la Integridad**. Observe c√≥mo no exponemos setters p√∫blicos; la √∫nica forma de alterar el estado es a trav√©s de m√©todos que garantizan las reglas.\r\n\r\n```pascal\r\ntype\r\n  TOrderModel = class\r\n  private\r\n    FEntity: TOrderEntity; // El target de los datos\r\n  public\r\n    constructor Create(Entity: TOrderEntity);\r\n\r\n    // Comportamientos (Acciones de Negocio)\r\n    procedure AgregarItem(Producto: TProduct; Cantidad: Integer);\r\n    procedure EnviarPedido;\r\n\r\n    // Acceso Read-Only (Encapsulamiento Total)\r\n    property Entity: TOrderEntity read FEntity;\r\n  end;\r\n\r\nimplementation\r\n\r\nprocedure TOrderModel.EnviarPedido;\r\nbegin\r\n  // 1. Validaci√≥n de Estado\r\n  if FEntity.Status <> 'Borrador' then\r\n    raise EDomainError.Create('Solo pedidos en borrador pueden ser enviados.');\r\n\r\n  // 2. Validaci√≥n de Invariantes (Reglas \"Duras\")\r\n  if FEntity.Total < 500.00 then\r\n    raise EDomainError.Create('El pedido m√≠nimo para facturaci√≥n es $ 500.00.');\r\n\r\n  // 3. Transici√≥n de Estado Segura\r\n  FEntity.Status := 'EsperandoAprobacion';\r\nend;\r\n\r\nprocedure TOrderModel.AgregarItem(Producto: TProduct; Cantidad: Integer);\r\nbegin\r\n  // Fail Fast: Impide datos sucios de entrar en el sistema\r\n  if Cantidad <= 0 then raise EDomainError.Create('Cantidad inv√°lida.');\r\n\r\n  var Item := TOrderItemEntity.Create;\r\n  Item.ProductId := Producto.Id;\r\n  Item.Quantity := Cantidad;\r\n  Item.UnitPrice := Producto.PrecioVenta;\r\n  \r\n  FEntity.Items.Add(Item);\r\n  \r\n  // Actualiza el total inmediatamente. La entidad nunca queda inconsistente.\r\n  FEntity.Total := FEntity.Total + (Item.UnitPrice * Cantidad);\r\nend;\r\n```\r\n\r\n## 3. Consumo Elegante con Fluent Specifications\r\n\r\nLa belleza de esta arquitectura se revela en los Endpoints (Controladores). Como separamos las responsabilidades, podemos usar el poder del **Specification Pattern** (estilo Ardalis) integrado en Dext.\r\n\r\nVea la diferencia brutal entre los dos mundos conviviendo en armon√≠a:\r\n\r\n### El Endpoint de Lectura (Query)\r\n\r\nAqu√≠ usamos la sintaxis fluida de Dext. El c√≥digo es declarativo: decimos *qu√©* queremos, no *c√≥mo* buscar.\r\n\r\n```pascal\r\n// GET /orders/pending\r\nApp.MapGet('/orders/pending', \r\n  function(Context: THttpContext; Repo: IOrderRepository): IResult\r\n  begin\r\n    // \"Traiga pedidos donde Status es 'Submitted' Y Total > 1000, \r\n    //  incluyendo los Items, ordenados por Fecha\"\r\n    var Spec := Specification.Where<TOrderEntity>(\r\n                  (OrderEntity.Status = 'Submitted') and \r\n                  (OrderEntity.Total > 1000)\r\n                )\r\n                .Include('Items')\r\n                .OrderBy(OrderEntity.CreatedAt.Desc);\r\n\r\n    // El Repository solo ejecuta la especificaci√≥n. Limpio.\r\n    var Orders := Repo.ToList(Spec);\r\n    \r\n    Result := Results.Ok(Orders);\r\n  end);\r\n```\r\n\r\n### El Endpoint de Escritura (Command)\r\n\r\nAqu√≠ la disciplina entra en escena. Instanciamos el **Model** para garantizar que ninguna regla sea violada antes de la persistencia.\r\n\r\n```pascal\r\n// POST /orders\r\nApp.MapPost('/orders', \r\n  function(Context: THttpContext; Repo: IOrderRepository; Dto: TCreateOrderDto): IResult\r\n  begin\r\n    var Entity := TOrderEntity.Create;\r\n    var Model  := TOrderModel.Create(Entity);\r\n\r\n    try\r\n      // El Model orquesta las reglas \"pesadas\"\r\n      for var Item in Dto.Items do\r\n        Model.AgregarItem(Item.ProductId, Item.Qty);\r\n        \r\n      Model.EnviarPedido; // Valida estado e invariantes\r\n\r\n      // Persiste solo si el Model aprob√≥ todo\r\n      Repo.Add(Model.Entity);\r\n      \r\n      Result := Results.Created(Model.Entity.Id, Model.Entity);\r\n    except\r\n      on E: EDomainError do\r\n        Result := Results.BadRequest(E.Message);\r\n    end;\r\n  end);\r\n```\r\n\r\n## 4. Jaque Mate: Testabilidad Unitaria\r\n\r\nAl adoptar este patr√≥n, ganamos un beneficio que vale oro en proyectos grandes: la capacidad de probar reglas de negocio aisladamente.\r\n\r\nEn el modelo antiguo (\"God Class\" acoplada al componente de base de datos), para probar si el \"Pedido M√≠nimo de $ 500.00\" funciona, usted necesitar√≠a subir una base de datos, insertar registros y correr el sistema. Lento y fr√°gil.\r\n\r\nEn esta arquitectura h√≠brida, `TOrderModel` es agn√≥stico a la base de datos. Usted puede escribir una Prueba Unitaria (DUnit/DUnitX) que instancia la entidad en memoria, la pasa al Model y verifica el comportamiento en milisegundos.\r\n\r\n```pascal\r\nprocedure TTestOrderModel.TestarValidacionDeMinimo;\r\nvar\r\n  Entidad: TOrderEntity;\r\n  Model: TOrderModel;\r\nbegin\r\n  // Arrange: Entidad en memoria, sin base de datos!\r\n  Entidad := TOrderEntity.Create;\r\n  Entidad.Total := 100.00; \r\n  Model := TOrderModel.Create(Entidad);\r\n  \r\n  // Act & Assert\r\n  Assert.WillRaise(procedure begin \r\n      Model.EnviarPedido \r\n    end, \r\n    EDomainError, \r\n    'Debe bloquear pedidos debajo de 500 d√≥lares'\r\n  );\r\nend;\r\n```\r\n\r\nEsto garantiza la calidad del software mucho antes de que llegue a producci√≥n.\r\n\r\n## Conclusi√≥n\r\n\r\nAdoptar Enterprise Patterns con Dext transforma la ingenier√≠a de su proyecto Delphi. Al separar **Estado** de **Comportamiento**, alcanzamos el equilibrio perfecto:\r\n\r\n1. **Lectura:** Expresiva y performante con Fluent Specifications.\r\n2. **Escritura:** Segura y blindada con Domain Models.\r\n3. **Calidad:** Testabilidad real fuera de la base de datos.\r\n\r\nDext provee la fundaci√≥n (ORM, Fluent Mapping, Specifications) para que usted deje de pelear con el c√≥digo y comience a dise√±ar arquitecturas robustas.\r\n\r\nEste es solo el primer paso. Una vez que su dominio est√° rico y aislado, nuevas posibilidades se abren: Event Sourcing, colas de mensajer√≠a y APIs de alt√≠simo rendimiento. Pero esa es una conversaci√≥n para nuestro pr√≥ximo art√≠culo.\r\n\r\nVea el repositorio de Dext en GitHub: [https://github.com/cesarliws/dext](https://github.com/cesarliws/dext)","src/content/docs/es/articles/enterprise-patterns-delphi.md","39c8951e62eeafab",{html:488,metadata:489},"<p><strong>Enterprise Patterns con Dext: Domain Model &#x26; CQRS - C√≥mo aplicar Domain Model y CQRS para modernizar su arquitectura Delphi y preparar su sistema para alta escalabilidad.</strong></p>\n<p>En el desarrollo de software corporativo, a menudo caemos en la trampa de usar una sola clase para todo. El mismo objeto valida reglas, mapea a la base de datos, calcula impuestos y sirve a la interfaz de usuario.</p>\n<p>El resultado es familiar para todos nosotros: sistemas r√≠gidos, ‚ÄúGod Classes‚Äù (Clases Dios) y el miedo constante de cambiar cualquier cosa en producci√≥n.</p>\n<p>Inspirado en los patrones de arquitectura Enterprise (com√∫nmente vistos en los ecosistemas .NET Core y Java), <strong>Dext</strong> trae a Delphi la capacidad de aplicar el principio de <strong>Separaci√≥n de Responsabilidades</strong> de una manera elegante y performante.</p>\n<p>Hoy demostrar√© una arquitectura h√≠brida que separa el <strong>Estado (Persistencia)</strong> del <strong>Comportamiento (Reglas de Negocio)</strong>.</p>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"1-el-concepto-entidades-ligeras-vs-modelos-ricos\">1. El Concepto: Entidades Ligeras vs. Modelos Ricos</h2><a class=\"sl-anchor-link\" href=\"#1-el-concepto-entidades-ligeras-vs-modelos-ricos\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Secci√≥n titulada ¬´1. El Concepto: Entidades Ligeras vs. Modelos Ricos¬ª</span></a></div>\n<p>El secreto de una arquitectura robusta es aceptar que <strong>c√≥mo guardamos</strong> los datos es diferente de <strong>c√≥mo procesamos</strong> los datos.</p>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"la-entidad-de-persistencia-el-estado\">La Entidad de Persistencia (El Estado)</h3><a class=\"sl-anchor-link\" href=\"#la-entidad-de-persistencia-el-estado\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Secci√≥n titulada ¬´La Entidad de Persistencia (El Estado)¬ª</span></a></div>\n<p>Esta clase debe ser ligera, un espejo fiel de la tabla. La base de datos es nuestra ‚ÄúFuente de la Verdad‚Äù: si el dato est√° grabado all√≠, asumimos que es √≠ntegro.</p>\n<p>Para mantener el c√≥digo limpio, utilizo el <strong>Fluent Mapping</strong> de Dext, eliminando la contaminaci√≥n visual de atributos dentro de la clase de dominio.</p>\n<div class=\"expressive-code\"><link rel=\"stylesheet\" href=\"/_astro/ec.2f3rl.css\"><script type=\"module\" src=\"/_astro/ec.0vx5m.js\"></script><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#96A1C2\">// POCO: Puro, ligero y enfocado solo en datos.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">type</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">TOrderEntity = </span><span style=\"--0:#FF79C6\">class</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">private</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">FId: </span><span style=\"--0:#FF79C6\">Integer</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">FStatus: </span><span style=\"--0:#FF79C6\">string</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">FTotal: </span><span style=\"--0:#FF79C6\">Currency</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">FItems: IList&#x3C;TOrderItemEntity>;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">public</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">property</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">Id</span><span style=\"--0:#F8F8F2\">: </span><span style=\"--0:#FF79C6\">Integer</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">read</span><span style=\"--0:#F8F8F2\"> FId </span><span style=\"--0:#FF79C6\">write</span><span style=\"--0:#F8F8F2\"> FId;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">property</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">Status</span><span style=\"--0:#F8F8F2\">: </span><span style=\"--0:#FF79C6\">string</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">read</span><span style=\"--0:#F8F8F2\"> FStatus </span><span style=\"--0:#FF79C6\">write</span><span style=\"--0:#F8F8F2\"> FStatus;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">property</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">Total</span><span style=\"--0:#F8F8F2\">: </span><span style=\"--0:#FF79C6\">Currency</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">read</span><span style=\"--0:#F8F8F2\"> FTotal </span><span style=\"--0:#FF79C6\">write</span><span style=\"--0:#F8F8F2\"> FTotal;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">property</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">Items</span><span style=\"--0:#F8F8F2\">: IList&#x3C;TOrderItemEntity> </span><span style=\"--0:#FF79C6\">read</span><span style=\"--0:#F8F8F2\"> FItems;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copiar al portapapeles\" data-copied=\"¬°Copiado!\" data-code=\"// POCO: Puro, ligero y enfocado solo en datos.type  TOrderEntity = class  private    FId: Integer;    FStatus: string;    FTotal: Currency;    FItems: IList<TOrderItemEntity>;  public    property Id: Integer read FId write FId;    property Status: string read FStatus write FStatus;    property Total: Currency read FTotal write FTotal;    property Items: IList<TOrderItemEntity> read FItems;  end;\"><div></div></button></div></figure></div>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"2-el-modelo-de-dominio-rico\">2. El Modelo de Dominio Rico</h2><a class=\"sl-anchor-link\" href=\"#2-el-modelo-de-dominio-rico\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Secci√≥n titulada ¬´2. El Modelo de Dominio Rico¬ª</span></a></div>\n<p>Aqu√≠ reside la ‚Äúgravedad‚Äù de las reglas de negocio. El <strong>Model</strong> no es un mero transportador de datos; es el <strong>Guardi√°n de la Integridad</strong>. Observe c√≥mo no exponemos setters p√∫blicos; la √∫nica forma de alterar el estado es a trav√©s de m√©todos que garantizan las reglas.</p>\n<div class=\"expressive-code\"><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">type</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">TOrderModel = </span><span style=\"--0:#FF79C6\">class</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">private</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">FEntity: TOrderEntity; </span><span style=\"--0:#96A1C2\">// El target de los datos</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">public</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">constructor</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">Create</span><span style=\"--0:#F8F8F2\">(Entity: TOrderEntity);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#96A1C2\">// Comportamientos (Acciones de Negocio)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">AgregarItem</span><span style=\"--0:#F8F8F2\">(Producto: TProduct; Cantidad: </span><span style=\"--0:#FF79C6\">Integer</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">EnviarPedido</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#96A1C2\">// Acceso Read-Only (Encapsulamiento Total)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">property</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">Entity</span><span style=\"--0:#F8F8F2\">: TOrderEntity </span><span style=\"--0:#FF79C6\">read</span><span style=\"--0:#F8F8F2\"> FEntity;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">implementation</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">TOrderModel.EnviarPedido</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// 1. Validaci√≥n de Estado</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">if</span><span style=\"--0:#F8F8F2\"> FEntity.Status &#x3C;> </span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Borrador</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">then</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">raise</span><span style=\"--0:#F8F8F2\"> EDomainError.Create(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Solo pedidos en borrador pueden ser enviados.</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// 2. Validaci√≥n de Invariantes (Reglas \"Duras\")</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">if</span><span style=\"--0:#F8F8F2\"> FEntity.Total &#x3C; </span><span style=\"--0:#BD93F9\">500.00</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">then</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">raise</span><span style=\"--0:#F8F8F2\"> EDomainError.Create(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">El pedido m√≠nimo para facturaci√≥n es $ 500.00.</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// 3. Transici√≥n de Estado Segura</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">FEntity.Status := </span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">EsperandoAprobacion</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">TOrderModel.AgregarItem</span><span style=\"--0:#F8F8F2\">(Producto: TProduct; Cantidad: </span><span style=\"--0:#FF79C6\">Integer</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Fail Fast: Impide datos sucios de entrar en el sistema</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">if</span><span style=\"--0:#F8F8F2\"> Cantidad &#x3C;= </span><span style=\"--0:#BD93F9\">0</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">then</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">raise</span><span style=\"--0:#F8F8F2\"> EDomainError.Create(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Cantidad inv√°lida.</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Item := TOrderItemEntity.Create;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Item.ProductId := Producto.Id;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Item.Quantity := Cantidad;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Item.UnitPrice := Producto.PrecioVenta;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">FEntity.Items.</span><span style=\"--0:#FF79C6\">Add</span><span style=\"--0:#F8F8F2\">(Item);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Actualiza el total inmediatamente. La entidad nunca queda inconsistente.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">FEntity.Total := FEntity.Total + (Item.UnitPrice * Cantidad);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copiar al portapapeles\" data-copied=\"¬°Copiado!\" data-code=\"type  TOrderModel = class  private    FEntity: TOrderEntity; // El target de los datos  public    constructor Create(Entity: TOrderEntity);    // Comportamientos (Acciones de Negocio)    procedure AgregarItem(Producto: TProduct; Cantidad: Integer);    procedure EnviarPedido;    // Acceso Read-Only (Encapsulamiento Total)    property Entity: TOrderEntity read FEntity;  end;implementationprocedure TOrderModel.EnviarPedido;begin  // 1. Validaci√≥n de Estado  if FEntity.Status <> &#x27;Borrador&#x27; then    raise EDomainError.Create(&#x27;Solo pedidos en borrador pueden ser enviados.&#x27;);  // 2. Validaci√≥n de Invariantes (Reglas &#x22;Duras&#x22;)  if FEntity.Total < 500.00 then    raise EDomainError.Create(&#x27;El pedido m√≠nimo para facturaci√≥n es $ 500.00.&#x27;);  // 3. Transici√≥n de Estado Segura  FEntity.Status := &#x27;EsperandoAprobacion&#x27;;end;procedure TOrderModel.AgregarItem(Producto: TProduct; Cantidad: Integer);begin  // Fail Fast: Impide datos sucios de entrar en el sistema  if Cantidad <= 0 then raise EDomainError.Create(&#x27;Cantidad inv√°lida.&#x27;);  var Item := TOrderItemEntity.Create;  Item.ProductId := Producto.Id;  Item.Quantity := Cantidad;  Item.UnitPrice := Producto.PrecioVenta;  FEntity.Items.Add(Item);  // Actualiza el total inmediatamente. La entidad nunca queda inconsistente.  FEntity.Total := FEntity.Total + (Item.UnitPrice * Cantidad);end;\"><div></div></button></div></figure></div>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"3-consumo-elegante-con-fluent-specifications\">3. Consumo Elegante con Fluent Specifications</h2><a class=\"sl-anchor-link\" href=\"#3-consumo-elegante-con-fluent-specifications\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Secci√≥n titulada ¬´3. Consumo Elegante con Fluent Specifications¬ª</span></a></div>\n<p>La belleza de esta arquitectura se revela en los Endpoints (Controladores). Como separamos las responsabilidades, podemos usar el poder del <strong>Specification Pattern</strong> (estilo Ardalis) integrado en Dext.</p>\n<p>Vea la diferencia brutal entre los dos mundos conviviendo en armon√≠a:</p>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"el-endpoint-de-lectura-query\">El Endpoint de Lectura (Query)</h3><a class=\"sl-anchor-link\" href=\"#el-endpoint-de-lectura-query\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Secci√≥n titulada ¬´El Endpoint de Lectura (Query)¬ª</span></a></div>\n<p>Aqu√≠ usamos la sintaxis fluida de Dext. El c√≥digo es declarativo: decimos <em>qu√©</em> queremos, no <em>c√≥mo</em> buscar.</p>\n<div class=\"expressive-code\"><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#96A1C2\">// GET /orders/pending</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#F8F8F2\">App.MapGet(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">/orders/pending</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">,</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">function(Context: THttpContext; Repo: IOrderRepository): IResult</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#96A1C2\">// \"Traiga pedidos donde Status es 'Submitted' Y Total > 1000,</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#96A1C2\">//  incluyendo los Items, ordenados por Fecha\"</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Spec := Specification.</span><span style=\"--0:#FF79C6\">Where</span><span style=\"--0:#F8F8F2\">&#x3C;TOrderEntity>(</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">                  </span></span><span style=\"--0:#F8F8F2\">(OrderEntity.Status = </span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Submitted</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">) </span><span style=\"--0:#FF79C6\">and</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">                  </span></span><span style=\"--0:#F8F8F2\">(OrderEntity.Total > </span><span style=\"--0:#BD93F9\">1000</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">                </span></span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">                </span></span><span style=\"--0:#F8F8F2\">.Include(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Items</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">)</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">                </span></span><span style=\"--0:#F8F8F2\">.OrderBy(OrderEntity.CreatedAt.</span><span style=\"--0:#FF79C6\">Desc</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#96A1C2\">// El Repository solo ejecuta la especificaci√≥n. Limpio.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Orders := Repo.ToList(Spec);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">Result</span><span style=\"--0:#F8F8F2\"> := Results.Ok(Orders);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">);</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copiar al portapapeles\" data-copied=\"¬°Copiado!\" data-code=\"// GET /orders/pendingApp.MapGet(&#x27;/orders/pending&#x27;,  function(Context: THttpContext; Repo: IOrderRepository): IResult  begin    // &#x22;Traiga pedidos donde Status es &#x27;Submitted&#x27; Y Total > 1000,    //  incluyendo los Items, ordenados por Fecha&#x22;    var Spec := Specification.Where<TOrderEntity>(                  (OrderEntity.Status = &#x27;Submitted&#x27;) and                  (OrderEntity.Total > 1000)                )                .Include(&#x27;Items&#x27;)                .OrderBy(OrderEntity.CreatedAt.Desc);    // El Repository solo ejecuta la especificaci√≥n. Limpio.    var Orders := Repo.ToList(Spec);    Result := Results.Ok(Orders);  end);\"><div></div></button></div></figure></div>\n<div class=\"sl-heading-wrapper level-h3\"><h3 id=\"el-endpoint-de-escritura-command\">El Endpoint de Escritura (Command)</h3><a class=\"sl-anchor-link\" href=\"#el-endpoint-de-escritura-command\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Secci√≥n titulada ¬´El Endpoint de Escritura (Command)¬ª</span></a></div>\n<p>Aqu√≠ la disciplina entra en escena. Instanciamos el <strong>Model</strong> para garantizar que ninguna regla sea violada antes de la persistencia.</p>\n<div class=\"expressive-code\"><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#96A1C2\">// POST /orders</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#F8F8F2\">App.MapPost(</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">/orders</span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F8F8F2\">,</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">function(Context: THttpContext; Repo: IOrderRepository; Dto: TCreateOrderDto): IResult</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Entity := TOrderEntity.Create;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Model  := TOrderModel.Create(Entity);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">try</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#96A1C2\">// El Model orquesta las reglas \"pesadas\"</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#FF79C6\">for</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#FF79C6\">var</span><span style=\"--0:#F8F8F2\"> Item </span><span style=\"--0:#FF79C6\">in</span><span style=\"--0:#F8F8F2\"> Dto.Items </span><span style=\"--0:#FF79C6\">do</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">        </span></span><span style=\"--0:#F8F8F2\">Model.AgregarItem(Item.ProductId, Item.Qty);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">Model.EnviarPedido; </span><span style=\"--0:#96A1C2\">// Valida estado e invariantes</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#96A1C2\">// Persiste solo si el Model aprob√≥ todo</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">Repo.</span><span style=\"--0:#FF79C6\">Add</span><span style=\"--0:#F8F8F2\">(Model.Entity);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#FF79C6\">Result</span><span style=\"--0:#F8F8F2\"> := Results.Created(Model.Entity.Id, Model.Entity);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">except</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">      </span><span style=\"--0:#FF79C6\">on</span><span style=\"--0:#F8F8F2\"> E: EDomainError </span><span style=\"--0:#FF79C6\">do</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">        </span><span style=\"--0:#FF79C6\">Result</span><span style=\"--0:#F8F8F2\"> := Results.BadRequest(E.</span><span style=\"--0:#FF79C6\">Message</span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">);</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copiar al portapapeles\" data-copied=\"¬°Copiado!\" data-code=\"// POST /ordersApp.MapPost(&#x27;/orders&#x27;,  function(Context: THttpContext; Repo: IOrderRepository; Dto: TCreateOrderDto): IResult  begin    var Entity := TOrderEntity.Create;    var Model  := TOrderModel.Create(Entity);    try      // El Model orquesta las reglas &#x22;pesadas&#x22;      for var Item in Dto.Items do        Model.AgregarItem(Item.ProductId, Item.Qty);      Model.EnviarPedido; // Valida estado e invariantes      // Persiste solo si el Model aprob√≥ todo      Repo.Add(Model.Entity);      Result := Results.Created(Model.Entity.Id, Model.Entity);    except      on E: EDomainError do        Result := Results.BadRequest(E.Message);    end;  end);\"><div></div></button></div></figure></div>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"4-jaque-mate-testabilidad-unitaria\">4. Jaque Mate: Testabilidad Unitaria</h2><a class=\"sl-anchor-link\" href=\"#4-jaque-mate-testabilidad-unitaria\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Secci√≥n titulada ¬´4. Jaque Mate: Testabilidad Unitaria¬ª</span></a></div>\n<p>Al adoptar este patr√≥n, ganamos un beneficio que vale oro en proyectos grandes: la capacidad de probar reglas de negocio aisladamente.</p>\n<p>En el modelo antiguo (‚ÄúGod Class‚Äù acoplada al componente de base de datos), para probar si el ‚ÄúPedido M√≠nimo de $ 500.00‚Äù funciona, usted necesitar√≠a subir una base de datos, insertar registros y correr el sistema. Lento y fr√°gil.</p>\n<p>En esta arquitectura h√≠brida, <code dir=\"auto\">TOrderModel</code> es agn√≥stico a la base de datos. Usted puede escribir una Prueba Unitaria (DUnit/DUnitX) que instancia la entidad en memoria, la pasa al Model y verifica el comportamiento en milisegundos.</p>\n<div class=\"expressive-code\"><figure class=\"frame not-content\"><figcaption class=\"header\"></figcaption><pre data-language=\"pascal\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">TTestOrderModel.TestarValidacionDeMinimo</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">var</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Entidad: TOrderEntity;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Model: TOrderModel;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Arrange: Entidad en memoria, sin base de datos!</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Entidad := TOrderEntity.Create;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Entidad.Total := </span><span style=\"--0:#BD93F9\">100.00</span><span style=\"--0:#F8F8F2\">;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">Model := TOrderModel.Create(Entidad);</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#96A1C2\">// Act &#x26; Assert</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">  </span><span style=\"--0:#FF79C6\">Assert</span><span style=\"--0:#F8F8F2\">.WillRaise(</span><span style=\"--0:#FF79C6\">procedure</span><span style=\"--0:#F8F8F2\"> </span><span style=\"--0:#50FA7B\">begin</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">      </span></span><span style=\"--0:#F8F8F2\">Model.EnviarPedido</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">,</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">    </span></span><span style=\"--0:#F8F8F2\">EDomainError,</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\">    </span><span style=\"--0:#E9F284\">'</span><span style=\"--0:#F1FA8C\">Debe bloquear pedidos debajo de 500 d√≥lares</span><span style=\"--0:#E9F284\">'</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#F8F8F2\">  </span></span><span style=\"--0:#F8F8F2\">);</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#FF79C6\">end</span><span style=\"--0:#F8F8F2\">;</span></div></div></code></pre><div class=\"copy\"><div aria-live=\"polite\"></div><button title=\"Copiar al portapapeles\" data-copied=\"¬°Copiado!\" data-code=\"procedure TTestOrderModel.TestarValidacionDeMinimo;var  Entidad: TOrderEntity;  Model: TOrderModel;begin  // Arrange: Entidad en memoria, sin base de datos!  Entidad := TOrderEntity.Create;  Entidad.Total := 100.00;  Model := TOrderModel.Create(Entidad);  // Act &#x26; Assert  Assert.WillRaise(procedure begin      Model.EnviarPedido    end,    EDomainError,    &#x27;Debe bloquear pedidos debajo de 500 d√≥lares&#x27;  );end;\"><div></div></button></div></figure></div>\n<p>Esto garantiza la calidad del software mucho antes de que llegue a producci√≥n.</p>\n<div class=\"sl-heading-wrapper level-h2\"><h2 id=\"conclusi√≥n\">Conclusi√≥n</h2><a class=\"sl-anchor-link\" href=\"#conclusi√≥n\"><span aria-hidden=\"true\" class=\"sl-anchor-icon\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"><path fill=\"currentcolor\" d=\"m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\"></path></svg></span><span class=\"sr-only\">Secci√≥n titulada ¬´Conclusi√≥n¬ª</span></a></div>\n<p>Adoptar Enterprise Patterns con Dext transforma la ingenier√≠a de su proyecto Delphi. Al separar <strong>Estado</strong> de <strong>Comportamiento</strong>, alcanzamos el equilibrio perfecto:</p>\n<ol>\n<li><strong>Lectura:</strong> Expresiva y performante con Fluent Specifications.</li>\n<li><strong>Escritura:</strong> Segura y blindada con Domain Models.</li>\n<li><strong>Calidad:</strong> Testabilidad real fuera de la base de datos.</li>\n</ol>\n<p>Dext provee la fundaci√≥n (ORM, Fluent Mapping, Specifications) para que usted deje de pelear con el c√≥digo y comience a dise√±ar arquitecturas robustas.</p>\n<p>Este es solo el primer paso. Una vez que su dominio est√° rico y aislado, nuevas posibilidades se abren: Event Sourcing, colas de mensajer√≠a y APIs de alt√≠simo rendimiento. Pero esa es una conversaci√≥n para nuestro pr√≥ximo art√≠culo.</p>\n<p>Vea el repositorio de Dext en GitHub: <a href=\"https://github.com/cesarliws/dext\">https://github.com/cesarliws/dext</a></p>",{headings:490,localImagePaths:513,remoteImagePaths:514,frontmatter:515,imagePaths:519},[491,494,497,500,503,506,509,512],{depth:66,slug:492,text:493},"1-el-concepto-entidades-ligeras-vs-modelos-ricos","1. El Concepto: Entidades Ligeras vs. Modelos Ricos",{depth:202,slug:495,text:496},"la-entidad-de-persistencia-el-estado","La Entidad de Persistencia (El Estado)",{depth:66,slug:498,text:499},"2-el-modelo-de-dominio-rico","2. El Modelo de Dominio Rico",{depth:66,slug:501,text:502},"3-consumo-elegante-con-fluent-specifications","3. Consumo Elegante con Fluent Specifications",{depth:202,slug:504,text:505},"el-endpoint-de-lectura-query","El Endpoint de Lectura (Query)",{depth:202,slug:507,text:508},"el-endpoint-de-escritura-command","El Endpoint de Escritura (Command)",{depth:66,slug:510,text:511},"4-jaque-mate-testabilidad-unitaria","4. Jaque Mate: Testabilidad Unitaria",{depth:66,slug:358,text:359},[],[],{title:479,description:480,date:516,tags:517},["Date","2025-01-15T00:00:00.000Z"],[518,95,96],"Arquitectura",[]];

export { _astro_dataLayerContent as default };
